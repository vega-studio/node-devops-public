// @bun
import F from"fs";import A from"path";var z={cyan:(...$)=>`\x1B[36m${$.join(" ")}\x1B[0m`,red:(...$)=>`\x1B[31m${$.join(" ")}\x1B[0m`,yellow:(...$)=>`\x1B[33m${$.join(" ")}\x1B[0m`,green:(...$)=>`\x1B[32m${$.join(" ")}\x1B[0m`,blue:(...$)=>`\x1B[34m${$.join(" ")}\x1B[0m`,magenta:(...$)=>`\x1B[35m${$.join(" ")}\x1B[0m`,cyanBright:(...$)=>`\x1B[96m${$.join(" ")}\x1B[0m`,redBright:(...$)=>`\x1B[91m${$.join(" ")}\x1B[0m`,yellowBright:(...$)=>`\x1B[93m${$.join(" ")}\x1B[0m`,greenBright:(...$)=>`\x1B[92m${$.join(" ")}\x1B[0m`,blueBright:(...$)=>`\x1B[94m${$.join(" ")}\x1B[0m`,magentaBright:(...$)=>`\x1B[95m${$.join(" ")}\x1B[0m`,whiteBright:(...$)=>`\x1B[97m${$.join(" ")}\x1B[0m`,gray:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,grey:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,white:(...$)=>`\x1B[37m${$.join(" ")}\x1B[0m`,black:(...$)=>`\x1B[30m${$.join(" ")}\x1B[0m`,blackBright:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,bgCyan:(...$)=>`\x1B[46m${$.join(" ")}\x1B[0m`,bgRed:(...$)=>`\x1B[41m${$.join(" ")}\x1B[0m`,bgYellow:(...$)=>`\x1B[43m${$.join(" ")}\x1B[0m`,bgGreen:(...$)=>`\x1B[42m${$.join(" ")}\x1B[0m`,bgBlue:(...$)=>`\x1B[44m${$.join(" ")}\x1B[0m`,bgMagenta:(...$)=>`\x1B[45m${$.join(" ")}\x1B[0m`,bgCyanBright:(...$)=>`\x1B[106m${$.join(" ")}\x1B[0m`,bgRedBright:(...$)=>`\x1B[101m${$.join(" ")}\x1B[0m`,bgYellowBright:(...$)=>`\x1B[103m${$.join(" ")}\x1B[0m`,bgGreenBright:(...$)=>`\x1B[102m${$.join(" ")}\x1B[0m`,bgBlueBright:(...$)=>`\x1B[104m${$.join(" ")}\x1B[0m`,bgMagentaBright:(...$)=>`\x1B[105m${$.join(" ")}\x1B[0m`,cyanBrightBold:(...$)=>`\x1B[96m\x1B[1m${$.join(" ")}\x1B[0m`,redBrightBold:(...$)=>`\x1B[91m\x1B[1m${$.join(" ")}\x1B[0m`,yellowBrightBold:(...$)=>`\x1B[93m\x1B[1m${$.join(" ")}\x1B[0m`,greenBrightBold:(...$)=>`\x1B[92m\x1B[1m${$.join(" ")}\x1B[0m`,blueBrightBold:(...$)=>`\x1B[94m\x1B[1m${$.join(" ")}\x1B[0m`,magentaBrightBold:(...$)=>`\x1B[95m\x1B[1m${$.join(" ")}\x1B[0m`,whiteBrightBold:(...$)=>`\x1B[97m\x1B[1m${$.join(" ")}\x1B[0m`,grayBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`,greyBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`,whiteBold:(...$)=>`\x1B[37m\x1B[1m${$.join(" ")}\x1B[0m`,blackBold:(...$)=>`\x1B[30m\x1B[1m${$.join(" ")}\x1B[0m`,blackBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`};var J=function($,b,_,q){if(b<0){if(b=$.length+b,b<0)b=0}return $.slice(0,b)+(q||"")+$.slice(b+_)},K=function($){let b=!1,_=!1;const q=[];let w={start:-1,stop:-1},y={start:-1,stop:-1};for(let B=0,H=$.length;B<H;++B){const I=$[B],D=$[B+1];switch(I){case"/":switch(D){case"*":if(!_&&!b)w.start=B,b=!0,B++;break;case"/":if(!b&&!_)y.start=B,_=!0,B++;break}break;case"*":if(D==="/"){if(b)w.stop=B+2,q.push(w),w={start:-1,stop:-1},b=!1,B++}break;case"\n":case"\r":if(_)y.stop=B,q.push(y),y={start:-1,stop:-1},_=!1;break}}return q.reverse(),q.forEach((B)=>{$=J($,B.start,B.stop-B.start)}),$},N=function($){return $=$.replace(/\t/g," "),$=$.replace(/  +/gm," "),$=$.replace(/ (\n|\r)+/gm,"\n"),$=$.replace(/(\n|\r)(\n|\r)+/gm,"\n"),$=$.replace(/(\n|\r) +/gm,"\n"),$.trim()},O=function($){const b=K($),_=N(b);return G(_)},G=function($){const b=JSON.stringify($).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\$\{/gm,"$\\{");return`export default \`${b.slice(1,b.length-1)}\`;`};function V(){return{name:"vite-devops-shader-compression-plugin",enforce:"pre",load($){const b=A.resolve($),_=[".vs",".fs"];if(F.existsSync(b)&&_.includes(A.extname(b))&&!b.includes("node_modules")&&!b.includes("\0")){const q=F.readFileSync(b,{encoding:"utf-8"});return console.warn("Not compressing shader:",z.cyanBrightBold(A.basename(b))),G(q)}}}}export{V as viteDevopsShaderCompressionPlugin};
