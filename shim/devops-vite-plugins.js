// @bun
import*as R from"@vitejs/plugin-react";import M from"vite-plugin-css-injected-by-js";import C from"path";import S from"vite-plugin-checker";import j from"fs";import W from"path";function X(){return{name:"vite-base64-inline-assets-plugin",enforce:"pre",load($){const _=W.resolve($);let b;switch(W.extname(_)){case".woff":b="font/woff";break;case".woff2":b="font/woff2";break;case".ttf":b="font/ttf";break;case".png":b="image/png";break;case".jpg":case".jpeg":b="image/jpeg";break;case".gif":b="image/gif";break;case".svg":b="image/svg+xml";break}if(b){const z=j.readFileSync(_).toString("base64");return`export default "data:${b};base64,${z}"`}}}}import G from"fs-extra";import H from"path";var J={cyan:(...$)=>`\x1B[36m${$.join(" ")}\x1B[0m`,red:(...$)=>`\x1B[31m${$.join(" ")}\x1B[0m`,yellow:(...$)=>`\x1B[33m${$.join(" ")}\x1B[0m`,green:(...$)=>`\x1B[32m${$.join(" ")}\x1B[0m`,blue:(...$)=>`\x1B[34m${$.join(" ")}\x1B[0m`,magenta:(...$)=>`\x1B[35m${$.join(" ")}\x1B[0m`,cyanBright:(...$)=>`\x1B[96m${$.join(" ")}\x1B[0m`,redBright:(...$)=>`\x1B[91m${$.join(" ")}\x1B[0m`,yellowBright:(...$)=>`\x1B[93m${$.join(" ")}\x1B[0m`,greenBright:(...$)=>`\x1B[92m${$.join(" ")}\x1B[0m`,blueBright:(...$)=>`\x1B[94m${$.join(" ")}\x1B[0m`,magentaBright:(...$)=>`\x1B[95m${$.join(" ")}\x1B[0m`,whiteBright:(...$)=>`\x1B[97m${$.join(" ")}\x1B[0m`,gray:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,grey:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,white:(...$)=>`\x1B[37m${$.join(" ")}\x1B[0m`,black:(...$)=>`\x1B[30m${$.join(" ")}\x1B[0m`,blackBright:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,bgCyan:(...$)=>`\x1B[46m${$.join(" ")}\x1B[0m`,bgRed:(...$)=>`\x1B[41m${$.join(" ")}\x1B[0m`,bgYellow:(...$)=>`\x1B[43m${$.join(" ")}\x1B[0m`,bgGreen:(...$)=>`\x1B[42m${$.join(" ")}\x1B[0m`,bgBlue:(...$)=>`\x1B[44m${$.join(" ")}\x1B[0m`,bgMagenta:(...$)=>`\x1B[45m${$.join(" ")}\x1B[0m`,bgCyanBright:(...$)=>`\x1B[106m${$.join(" ")}\x1B[0m`,bgRedBright:(...$)=>`\x1B[101m${$.join(" ")}\x1B[0m`,bgYellowBright:(...$)=>`\x1B[103m${$.join(" ")}\x1B[0m`,bgGreenBright:(...$)=>`\x1B[102m${$.join(" ")}\x1B[0m`,bgBlueBright:(...$)=>`\x1B[104m${$.join(" ")}\x1B[0m`,bgMagentaBright:(...$)=>`\x1B[105m${$.join(" ")}\x1B[0m`,cyanBrightBold:(...$)=>`\x1B[96m\x1B[1m${$.join(" ")}\x1B[0m`,redBrightBold:(...$)=>`\x1B[91m\x1B[1m${$.join(" ")}\x1B[0m`,yellowBrightBold:(...$)=>`\x1B[93m\x1B[1m${$.join(" ")}\x1B[0m`,greenBrightBold:(...$)=>`\x1B[92m\x1B[1m${$.join(" ")}\x1B[0m`,blueBrightBold:(...$)=>`\x1B[94m\x1B[1m${$.join(" ")}\x1B[0m`,magentaBrightBold:(...$)=>`\x1B[95m\x1B[1m${$.join(" ")}\x1B[0m`,whiteBrightBold:(...$)=>`\x1B[97m\x1B[1m${$.join(" ")}\x1B[0m`,grayBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`,greyBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`,whiteBold:(...$)=>`\x1B[37m\x1B[1m${$.join(" ")}\x1B[0m`,blackBold:(...$)=>`\x1B[30m\x1B[1m${$.join(" ")}\x1B[0m`,blackBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`};import Y from"fs";import Z from"path";function A($){return{name:"vite-devops-string-replace-plugin",enforce:"pre",load(_){const b=Z.resolve(_),q=[".ts",".js",".tsx",".jsx"];if(Y.existsSync(b)&&q.includes(Z.extname(b))&&!b.includes("node_modules")&&!b.includes("\0")){let z=Y.readFileSync(b,{encoding:"utf-8"});return $.forEach((I)=>{z=z.replace(I.from,I.to)}),z}}}}function D($){const _=process.env.PROJECT_ROOT||".",b=H.resolve(_,"app/config");if(!G.existsSync(b)){console.warn(`viteDevopsAppConfigPlugin: ${J.cyanBrightBold("No app/config folder found.")}`);return}try{const q=G.readdirSync(b).filter((B)=>{return G.statSync(H.join(b,B)).isDirectory()}),z=q.map((B)=>H.join(b,B)),w=q.map((B,K)=>{if(!$)if(G.existsSync(H.join(z[K],`${B}.local`))||G.existsSync(H.join(z[K],`${B}.local.js`))||G.existsSync(H.join(z[K],`${B}.local.ts`))||G.existsSync(H.join(z[K],`${B}.local.tsx`))||G.existsSync(H.join(z[K],`${B}.local.jsx`)))return[{from:`"config/${B}/${B}"`,to:`"config/${B}/${B}.local"`},{from:`"config/${B}/${B}.js"`,to:`"config/${B}/${B}.local.js"`},{from:`"config/${B}/${B}.ts"`,to:`"config/${B}/${B}.local.ts"`}];else return[];return[{from:`"config/${B}/${B}"`,to:`"config/${B}/${B}.${$}"`},{from:`"config/${B}/${B}.js"`,to:`"config/${B}/${B}.${$}.js"`},{from:`"config/${B}/${B}.ts"`,to:`"config/${B}/${B}.${$}.ts"`}]}).reduce((B,K)=>B.concat(K),[]),N=[...!$&&(G.existsSync(H.join(b,"env.local"))||G.existsSync(H.join(b,"env.local.js"))||G.existsSync(H.join(b,"env.local.ts"))||G.existsSync(H.join(b,"env.local.tsx"))||G.existsSync(H.join(b,"env.local.jsx")))?[{from:'"config/env"',to:'"config/env.local"'},{from:'"config/env.js"',to:'"config/env.local.js"'},{from:'"config/env.ts"',to:'"config/env.local.ts"'}]:$?[{from:'"config/env"',to:`"config/env.${$}"`},{from:'"config/env.js"',to:`"config/env.${$}.js"`},{from:'"config/env.ts"',to:`"config/env.${$}.ts"`}]:[],...w];if(N.length>0)console.warn(`

  ${J.yellowBrightBold("Using the following mappings for app config:")}

  \t${J.cyanBrightBold(N.map((B)=>`\n  ${B.from} => ${B.to}`).join("\n\t"))}

      `);return A(N)}catch(q){console.error(q),console.error(J.redBrightBold(`
      App config plugin failed to load. The default config paths will be used
      and any specific environment requested will be ignored.
    `))}}import E from"fs";import Q from"path";var T=function($,_,b,q){if(_<0){if(_=$.length+_,_<0)_=0}return $.slice(0,_)+(q||"")+$.slice(_+b)},k=function($){let _=!1,b=!1;const q=[];let z={start:-1,stop:-1},I={start:-1,stop:-1};for(let w=0,U=$.length;w<U;++w){const V=$[w],N=$[w+1];switch(V){case"/":switch(N){case"*":if(!b&&!_)z.start=w,_=!0,w++;break;case"/":if(!_&&!b)I.start=w,b=!0,w++;break}break;case"*":if(N==="/"){if(_)z.stop=w+2,q.push(z),z={start:-1,stop:-1},_=!1,w++}break;case"\n":case"\r":if(b)I.stop=w,q.push(I),I={start:-1,stop:-1},b=!1;break}}return q.reverse(),q.forEach((w)=>{$=T($,w.start,w.stop-w.start)}),$},y=function($){return $=$.replace(/\t/g," "),$=$.replace(/  +/gm," "),$=$.replace(/ (\n|\r)+/gm,"\n"),$=$.replace(/(\n|\r)(\n|\r)+/gm,"\n"),$=$.replace(/(\n|\r) +/gm,"\n"),$.trim()},L=function($){const _=k($),b=y(_);return F(b)},F=function($){const _=JSON.stringify($).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\$\{/gm,"$\\{");return`export default \`${_.slice(1,_.length-1)}\`;`};function O(){return{name:"vite-devops-shader-compression-plugin",enforce:"pre",load($){const _=Q.resolve($),b=[".vs",".fs"];if(E.existsSync(_)&&b.includes(Q.extname(_))&&!_.includes("node_modules")&&!_.includes("\0")){const q=E.readFileSync(_,{encoding:"utf-8"});return console.warn("Not compressing shader:",J.cyanBrightBold(Q.basename(_))),F(q)}}}}async function B1($){const _={babel:{parserOpts:{plugins:["decorators-legacy","classProperties"]}}},b=process.env.ENV_MODE;return[O(),D(b),(R?.default||R?.default?.default)?.($?.react?$?.react(_):_),X(),M(),S({typescript:{root:C.resolve(".")}})].filter(Boolean)}export{B1 as useDevopsPlugins};
