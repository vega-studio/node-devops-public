#!/usr/bin/env bun
// @bun
import{createRequire as f9} from"node:module";var k9=Object.create;var{defineProperty:u1,getPrototypeOf:P9,getOwnPropertyNames:y9}=Object;var v9=Object.prototype.hasOwnProperty;var m9=($,Y,K)=>{K=$!=null?k9(P9($)):{};const Z=Y||!$||!$.__esModule?u1(K,"default",{value:$,enumerable:!0}):K;for(let G of y9($))if(!v9.call(Z,G))u1(Z,G,{get:()=>$[G],enumerable:!0});return Z};var F1=($,Y)=>()=>(Y||$((Y={exports:{}}).exports,Y),Y.exports);var C=($,Y)=>{for(var K in Y)u1($,K,{get:Y[K],enumerable:!0,configurable:!0,set:(Z)=>Y[K]=()=>Z})};var L=($,Y)=>()=>($&&(Y=$($=0)),Y);var k=f9(import.meta.url);var z;var O=L(()=>{z={cyan:(...$)=>`\x1B[36m${$.join(" ")}\x1B[0m`,red:(...$)=>`\x1B[31m${$.join(" ")}\x1B[0m`,yellow:(...$)=>`\x1B[33m${$.join(" ")}\x1B[0m`,green:(...$)=>`\x1B[32m${$.join(" ")}\x1B[0m`,blue:(...$)=>`\x1B[34m${$.join(" ")}\x1B[0m`,magenta:(...$)=>`\x1B[35m${$.join(" ")}\x1B[0m`,cyanBright:(...$)=>`\x1B[96m${$.join(" ")}\x1B[0m`,redBright:(...$)=>`\x1B[91m${$.join(" ")}\x1B[0m`,yellowBright:(...$)=>`\x1B[93m${$.join(" ")}\x1B[0m`,greenBright:(...$)=>`\x1B[92m${$.join(" ")}\x1B[0m`,blueBright:(...$)=>`\x1B[94m${$.join(" ")}\x1B[0m`,magentaBright:(...$)=>`\x1B[95m${$.join(" ")}\x1B[0m`,whiteBright:(...$)=>`\x1B[97m${$.join(" ")}\x1B[0m`,gray:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,grey:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,white:(...$)=>`\x1B[37m${$.join(" ")}\x1B[0m`,black:(...$)=>`\x1B[30m${$.join(" ")}\x1B[0m`,blackBright:(...$)=>`\x1B[90m${$.join(" ")}\x1B[0m`,bgCyan:(...$)=>`\x1B[46m${$.join(" ")}\x1B[0m`,bgRed:(...$)=>`\x1B[41m${$.join(" ")}\x1B[0m`,bgYellow:(...$)=>`\x1B[43m${$.join(" ")}\x1B[0m`,bgGreen:(...$)=>`\x1B[42m${$.join(" ")}\x1B[0m`,bgBlue:(...$)=>`\x1B[44m${$.join(" ")}\x1B[0m`,bgMagenta:(...$)=>`\x1B[45m${$.join(" ")}\x1B[0m`,bgCyanBright:(...$)=>`\x1B[106m${$.join(" ")}\x1B[0m`,bgRedBright:(...$)=>`\x1B[101m${$.join(" ")}\x1B[0m`,bgYellowBright:(...$)=>`\x1B[103m${$.join(" ")}\x1B[0m`,bgGreenBright:(...$)=>`\x1B[102m${$.join(" ")}\x1B[0m`,bgBlueBright:(...$)=>`\x1B[104m${$.join(" ")}\x1B[0m`,bgMagentaBright:(...$)=>`\x1B[105m${$.join(" ")}\x1B[0m`,cyanBrightBold:(...$)=>`\x1B[96m\x1B[1m${$.join(" ")}\x1B[0m`,redBrightBold:(...$)=>`\x1B[91m\x1B[1m${$.join(" ")}\x1B[0m`,yellowBrightBold:(...$)=>`\x1B[93m\x1B[1m${$.join(" ")}\x1B[0m`,greenBrightBold:(...$)=>`\x1B[92m\x1B[1m${$.join(" ")}\x1B[0m`,blueBrightBold:(...$)=>`\x1B[94m\x1B[1m${$.join(" ")}\x1B[0m`,magentaBrightBold:(...$)=>`\x1B[95m\x1B[1m${$.join(" ")}\x1B[0m`,whiteBrightBold:(...$)=>`\x1B[97m\x1B[1m${$.join(" ")}\x1B[0m`,grayBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`,greyBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`,whiteBold:(...$)=>`\x1B[37m\x1B[1m${$.join(" ")}\x1B[0m`,blackBold:(...$)=>`\x1B[30m\x1B[1m${$.join(" ")}\x1B[0m`,blackBrightBold:(...$)=>`\x1B[90m\x1B[1m${$.join(" ")}\x1B[0m`}});import{stripIndent as g9} from"common-tags";function b($,...Y){return`${g9($,...Y)}\n\n`}var n=L(()=>{});function w0($){return $&&$.charCodeAt!==void 0}function f($){return $!==void 0&&$!==null}var G1=L(()=>{});import u9 from"inquirer";import{stripIndent as d9} from"common-tags";async function P($,Y,K){const{result:Z}=await u9.prompt([{type:"confirm",name:"result",message:d9`${$}`,default:Y}]);if(Z)K?.();return Z}var J1=L(()=>{});function L1($){return h1($)&&h1($.status)&&h1($.stderr)}var h1;var l1=L(()=>{h1=function($){return $!==void 0&&$!==null}});async function M1($,Y=[]){try{const K=Bun.spawnSync([$,...Y.filter(f)],{stdio:["inherit","inherit","inherit"],env:process.env});if(K.exitCode!==0){if(!M1.silent)console.error(`Error: ${$} ${Y.join(" ")} failed with code: ${K.exitCode}`),console.error(new Error().stack);return!1}}catch(K){if(!M1.silent){if(L1(K))console.error(`Error: ${$} ${Y.join(" ")} failed with code: ${K.status}`);else if(K instanceof Error)console.error(K.message);console.error(new Error().stack)}return!1}return!0}var M;var T=L(()=>{l1();G1();M1.silent=!1;M=M1});async function R(){if(Q1)return Q1;if(await M("bun",["--version"]))Q1=["bun","bunx"];else Q1=["npm","npx"];return Q1}var Q1;var s=L(()=>{T();Q1=null});async function E($){await new Promise((Y)=>setTimeout(Y,$))}var a=L(()=>{});import a9 from"fs-extra";import h from"path";async function t(){console.warn("Building Vite config using base:",z.yellowBrightBold(h.resolve("vite.config.ts")));let $=await(await import(h.resolve("vite.config.ts"))).default();const Y=await a9.readJSONSync(h.resolve("tsconfig.json"));return $={...$,logLevel:"info",mode:"development",root:h.resolve("app/client"),clearScreen:!0,build:{...$.build,cssCodeSplit:!0,outDir:h.resolve("build/client"),sourcemap:!0,rollupOptions:{output:{manualChunks:void 0}},watch:{...$.build?.watch,include:[...(Array.isArray($.build?.watch?.include)?$.build?.watch?.include:[$.build?.watch?.include])||[],...Y?.include?.map((K)=>h.resolve(K))||[],"tsconfig.json"].filter(Boolean)},emptyOutDir:!0},resolve:{alias:{config:h.resolve("app/config")}}},$}var b1=L(()=>{O()});import t9 from"deepmerge";import r9 from"fs-extra";import e9 from"path";async function u(){const $=r9.readJSONSync(e9.resolve("package.json"));return t9($.dependencies||{},$.peerDependencies||{})}var _1=L(()=>{});import $3 from"fs-extra";import Y3 from"path";async function U(){return $3.readJSONSync(Y3.resolve("package.json")).version||""}var y=L(()=>{});import*as P0 from"vite";import K3 from"fs-extra";import c1 from"path";async function z1(){if(process.env.VITE_RELEASE_VERSION=process.env.VITE_RELEASE_VERSION||await U(),console.warn(z.yellowBrightBold("Starting Vite client build...")),!K3.existsSync(c1.resolve("app/client/index.ts"))){console.warn("Tried to start development process for the app client, but no entry file was found.");return}const $=await t();$.root=c1.resolve("app/client"),$.build.outDir=c1.resolve("build/client"),$.build.rollupOptions.external=Object.keys(await u()),await P0.build($),console.warn(z.yellowBrightBold("Vite client build process started..."))}var p1=L(()=>{b1();O();_1();y()});function y0($){const Y=(K)=>(Z)=>{if($(K,Z),Z)process.exit(1);else process.exit(0)};process.on("exit",Y("exit")),process.on("SIGINT",Y("SIGINT")),process.on("SIGUSR1",Y("SIGUSR1")),process.on("SIGUSR2",Y("SIGUSR2")),process.on("SIGTERM",Y("SIGTERM")),process.on("uncaughtException",Y("uncaughtException"))}var v0=L(()=>{});function n1(...$){i1.push($),Z3()}var Z3,i1,m0;var f0=L(()=>{Z3=function(){if(m0!==null)return;m0=setInterval(()=>{while(i1.length>0){const $=i1.shift();if($)console.log(...$)}},400)};i1=[],m0=null});import G3 from"child_process";import s1 from"path";import J3 from"readline";async function X1($){console.warn("\nRunning the App server at: ",z.yellowBrightBold(s1.resolve("app/server")),"\n"),process.env.VITE_RELEASE_VERSION=process.env.VITE_RELEASE_VERSION||await U(),process.env.RESOURCE_PATH=process.env.RESOURCE_PATH||s1.resolve("build/client");const Y=await R();if(Y[0]!=="bun")console.error("Currently only an environment with bun installed is supported for this command.");const K=G3.spawn(Y[0],["--watch",s1.resolve("app/server/index.ts")]);process.stdin.setRawMode?.(!0),process.stdin.resume(),process.stdin.setEncoding("utf8"),J3.emitKeypressEvents(process.stdin);let Z=!1;if(process.stdin.on("keypress",async(G,J)=>{if(J&&J.ctrl&&J.name==="c")K.kill(),process.exit(0);else if(J&&J.ctrl&&J.name==="d")K.kill(),process.exit(0);else if(G.toString()==="b"||G.toString()==="B"){if(Z)return;Z=!0,await z1(),Z=!1}else if(G.toString()==="q"||G.toString()==="Q")if(K.kill(),J.shift)process.exit(123);else process.exit(0)}),process.stdin.pipe(K.stdin),$)$(K);else K.stdout.on("data",function(G){n1(`${G.toString().slice(0,-1)}`)}),K.stderr.on("data",function(G){n1(`${G.toString().slice(0,-1)}`)});y0(async(G,J)=>{if(K.kill(),console.warn("EXIT BUILD SERVER"),console.warn(z.redBrightBold(G)),J&&J instanceof Error)console.warn(z.redBrightBold(J.stack||J.message));process.exit(0)})}var o1=L(()=>{p1();O();s();v0();f0();y()});var u0={};C(u0,{default:()=>{{return g0}}});async function g0(){process.env.NODE_ENV="development",z1(),console.warn(z.yellowBrightBold("Starting dev server...")),process.env.VITE_RELEASE_VERSION=await U(),await X1()}var d0=L(()=>{p1();o1();O();y()});import q1 from"path";import Q3 from"url";async function h0(){if(q1.basename(q1.resolve(a1,".."))==="dist")return q1.resolve(a1,"../../");return q1.resolve(a1,"../../../")}var a1;var l0=L(()=>{a1=Q3.fileURLToPath(new URL(".",import.meta.url))});async function l($,Y=[]){const K=await R();return M(K[0],["run",$,Y.length>0&&Y[0]!=="--"?"--":void 0,...Y])}var N1=L(()=>{T();s()});var r1={};C(r1,{default:()=>{{return c0}}});import t1 from"path";async function c0($,Y,...K){const Z=t1.resolve(".");process.env.PROJECT_ROOT=Z,process.env.VITE_RELEASE_VERSION=await U();const G=t1.resolve(".storybook"),J=await h0();if(process.chdir(J),Y&&Y.length>0)process.env.NODE_MODULES_STORIES=Y.join(",");if($==="build"){if(!l("storybook",["build","-c",G,"-o",`"${t1.resolve(Z,"storybook-static")}"`]))console.error(z.redBrightBold("Failed to build storybook"))}else if(!l("storybook",["dev","--no-version-updates","-p",process.env.PORT||"6006","-c",`"${G}"`]))console.error(z.redBrightBold("Failed to run storybook"))}var e1=L(()=>{O();l0();N1();y()});var Y0=F1((W5,i0)=>{var z3=function(){try{return p0.statSync("/.dockerenv"),!0}catch($){return!1}},X3=function(){try{return p0.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch($){return!1}},p0=import.meta.require("fs"),$0;i0.exports=()=>{if($0===void 0)$0=z3()||X3();return $0}});var o0=F1((B5,K0)=>{var W3=import.meta.require("os"),B3=import.meta.require("fs"),n0=Y0(),s0=()=>{if(process.platform!=="linux")return!1;if(W3.release().toLowerCase().includes("microsoft")){if(n0())return!1;return!0}try{return B3.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!n0():!1}catch($){return!1}};if(process.env.__IS_WSL_TEST__)K0.exports=s0;else K0.exports=s0()});var t0=F1((H5,a0)=>{a0.exports=($,Y,K)=>{const Z=(G)=>Object.defineProperty($,Y,{value:G,enumerable:!0,writable:!0});return Object.defineProperty($,Y,{configurable:!0,enumerable:!0,get(){const G=K();return Z(G),G},set(G){Z(G)}}),$}});var G$=F1((F5,Z$)=>{var b3=function(){if(Z0===void 0)Z0=M3()||L3();return Z0},Y$=function($){if(typeof $==="string"||Array.isArray($))return $;const{[e0]:Y}=$;if(!Y)throw new Error(`${e0} is not supported`);return Y},Q0=function({[r]:$},{wsl:Y}){if(Y&&D1)return Y$(Y);if(!$)throw new Error(`${r} is not supported`);return Y$($)},__dirname="/Users/diniden/Desktop/VoidRay/dev-ops/node-devops/node_modules/open",H3=import.meta.require("path"),F3=import.meta.require("child_process"),{promises:A1,constants:K$}=import.meta.require("fs"),D1=o0(),L3=Y0(),G0=t0(),r0=H3.join(__dirname,"xdg-open"),{platform:r,arch:e0}=process,M3=()=>{try{return A1.statSync("/run/.containerenv"),!0}catch{return!1}},Z0,_3=(()=>{let Y;return async function(){if(Y)return Y;const K="/etc/wsl.conf";let Z=!1;try{await A1.access(K,K$.F_OK),Z=!0}catch{}if(!Z)return"/mnt/";const G=await A1.readFile(K,{encoding:"utf8"}),J=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(G);if(!J)return"/mnt/";return Y=J.groups.mountPoint.trim(),Y=Y.endsWith("/")?Y:`${Y}/`,Y}})(),$$=async($,Y)=>{let K;for(let Z of $)try{return await Y(Z)}catch(G){K=G}throw K},O1=async($)=>{if($={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...$},Array.isArray($.app))return $$($.app,(X)=>O1({...$,app:X}));let{name:Y,arguments:K=[]}=$.app||{};if(K=[...K],Array.isArray(Y))return $$(Y,(X)=>O1({...$,app:{name:X,arguments:K}}));let Z;const G=[],J={};if(r==="darwin"){if(Z="open",$.wait)G.push("--wait-apps");if($.background)G.push("--background");if($.newInstance)G.push("--new");if(Y)G.push("-a",Y)}else if(r==="win32"||D1&&!b3()&&!Y){const X=await _3();if(Z=D1?`${X}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,G.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),!D1)J.windowsVerbatimArguments=!0;const W=["Start"];if($.wait)W.push("-Wait");if(Y){if(W.push(`"\`"${Y}\`""`,"-ArgumentList"),$.target)K.unshift($.target)}else if($.target)W.push(`"${$.target}"`);if(K.length>0)K=K.map((F)=>`"\`"${F}\`""`),W.push(K.join(","));$.target=Buffer.from(W.join(" "),"utf16le").toString("base64")}else{if(Y)Z=Y;else{const X=!__dirname||__dirname==="/";let W=!1;try{await A1.access(r0,K$.X_OK),W=!0}catch{}Z=process.versions.electron||r==="android"||X||!W?"xdg-open":r0}if(K.length>0)G.push(...K);if(!$.wait)J.stdio="ignore",J.detached=!0}if($.target)G.push($.target);if(r==="darwin"&&K.length>0)G.push("--args",...K);const Q=F3.spawn(Z,G,J);if($.wait)return new Promise((X,W)=>{Q.once("error",W),Q.once("close",(F)=>{if(!$.allowNonzeroExitCode&&F>0){W(new Error(`Exited with code ${F}`));return}X(Q)})});return Q.unref(),Q},J0=($,Y)=>{if(typeof $!=="string")throw new TypeError("Expected a `target`");return O1({...Y,target:$})},q3=($,Y)=>{if(typeof $!=="string")throw new TypeError("Expected a `name`");const{arguments:K=[]}=Y||{};if(K!==void 0&&K!==null&&!Array.isArray(K))throw new TypeError("Expected `appArguments` as Array type");return O1({...Y,app:{name:$,arguments:K}})},I1={};G0(I1,"chrome",()=>Q0({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}));G0(I1,"firefox",()=>Q0({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}));G0(I1,"edge",()=>Q0({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}));J0.apps=I1;J0.openApp=q3;Z$.exports=J0});async function A($,Y=[]){try{const K=Bun.spawnSync([$,...Y.filter(f)],{stdio:["inherit","pipe","pipe"],env:process.env});if(K.exitCode!==0)return console.error(`Error: ${$} ${Y.join(" ")} failed with code: ${K.exitCode}`),console.error(new Error().stack),null;return(K.stdout||"").toString()}catch(K){if(L1(K))console.error(`Error: ${$} ${Y.join(" ")} failed with code: ${K.status}`);else if(K instanceof Error)console.error(K.message);return console.error(new Error().stack),null}}var c=L(()=>{l1();G1()});function J$({template:$,options:Y,required:K,doubleCurlyBrackets:Z,onError:G,onToken:J}){const Q=new Map,X=new Map,W=new Map,F=new Map;let B=/\$\{([^\}]*)\}/g;if(Z)B=/\$\{\{([^\}]*)\}\}/g;const N=$.replace(B,(q,H)=>{let x="";if(F.set(H,(F.get(H)||0)+1),H in Y){Q.set(H,(Q.get(H)||0)+1);const I0=Y[H];if(I0!==void 0)x=I0}else X.set(H,(X.get(H)||0)+1);if(J){if(x=J(H,x),x!==H)Q.set(H,(Q.get(H)||0)+1),X.delete(H)}return x});Object.keys(Y).forEach((q)=>{if(!Q.get(q))W.set(q,(W.get(q)||0)+1)});const D={resolvedtemplateOptions:Q,template:N,templateProvidedOptions:F,unresolvedProvidedOptions:W,unresolvedTemplateOptions:X};if(K)K.values.forEach((q)=>{if(D.unresolvedProvidedOptions.get(q)){const H=`${K.name}: Could not resolve all the required inputs. Input: ${q}`;if(G)G(H);else console.error(H)}else if(D.unresolvedTemplateOptions.get(q)){const H=`${K.name}: A required option was not provided in the options parameter. Option: ${q}`;if(G)G(H);else console.error(H)}else if(!D.resolvedtemplateOptions.get(q)){const H=`${K.name}: A required option was not provided in the options parameter. Option: ${q}`;if(G)G(H);else console.error(H)}});return D}var Q$=L(()=>{});var M$={};C(M$,{default:()=>{{return L$}}});import x1 from"fs-extra";import z$ from"hostile";import F$ from"path";import X$ from"valid-url";async function D3(){const Y=x1.readJSONSync(F$.resolve("package.json")).hosts;if(!Y)return;const K=Object.keys(Y);let Z=await W$(z$,"get",!1);const G=[];console.warn(z.yellow("Updating hosts file..."));for(let Q of K)try{if(!Z.find((X)=>X[0]===Q&&X[1]===Y[Q]))G.push([Q,Y[Q]])}catch(X){if(X instanceof Error)console.warn(z.red(X.message))}if(G.length>0){console.warn(z.yellow("Adding hosts (You may be prompted for administrator password):\n\t",G.map((X)=>`${X[0]} => ${X[1]}`).join("\n\t"))),await M("sudo",["echo","Granted sudo access to update hosts file."]);const Q=await A("stat",["-f","%p","/etc/hosts"]).toString();await M("sudo",["chmod","666","/etc/hosts"]);for(let X of G)x1.appendFileSync("/etc/hosts",`${X[0]} ${X[1]}`);x1.appendFileSync("/etc/hosts","\n"),await M("sudo",["chmod",Q.substring(Q.length-4).trim(),"/etc/hosts"])}await E(500),console.warn(z.yellow("Verifying hosts file...")),Z=await W$(z$,"get",!1);let J=!1;if(G.forEach(([Q,X])=>{if(!Z.find((W)=>W[0]===Q&&W[1]===Y[Q]))J=!0,console.warn(z.redBright(`Failed to add host: ${z.yellowBright(Q)} => ${z.yellowBright(X)}`))}),J)console.warn(z.red(b`
        *************************************************************************
        * Some hosts specified in the package.json were not able to be written  *
        * to the hosts file for the system. You can amend this by editing the   *
        * file yourself, or by trying to run this script again as an admin.     *
        *************************************************************************
      `))}async function L$($,Y){const Z=x1.readJSONSync(F$.resolve("package.json"))?.url||{},G=Y?.reduce((Q,X,W)=>{return Q[`${W+1}`]=X,Q},{})||{};if(!$||$.length<=0){console.warn(b`
      Available URLs:
        ${z.cyanBrightBold(Object.keys(Z).join("\n        "))}
    `);return}await D3();const J={...process.env,...G};if(Array.isArray($))$.forEach((Q)=>{B$(Z,Q,J)});else B$(Z,$,J)}var H$,N3,W$,B$;var b$=L(()=>{H$=m9(G$(),1);O();n();T();c();Q$();a();N3=function($){return $&&typeof $==="function"},W$=function($,Y,...K){return new Promise((Z,G)=>{const J=$[Y];if(!N3(J)){G(new Error(`${String(Y)} is not a function`));return}J(...K,(Q,X)=>{if(Q)console.warn(Q),G(Q),process.exit(1);else Z(X||void 0)})})};B$=function($,Y,K){let Z=Y;if(X$.isWebUri(Y))Z=Y;else if($[Y])Z=$[Y];const G=J$({options:K,template:Z});if(G.unresolvedTemplateOptions.size>0)throw console.warn(z.red(b`
          You must specify these env variables for this URL to work:
          ${Array.from(G.unresolvedTemplateOptions.keys()).join("\n\t")}
        `)),new Error("Missing env configuration for URL");if(Z=G.template,X$.isWebUri(Z))console.warn("Navigating to:",z.cyanBrightBold(Z)),H$.default(Z);else console.warn("Can not open invalid URL:",z.redBrightBold(Z))}});import A3 from"child_process";async function e(){try{A3.execSync("git status --porcelain=v1 2>/dev/null | wc -l | grep 0",{env:process.env})}catch($){return!0}return!1}var U1=L(()=>{});async function V1($){if($){if(!await P(`
      Would you like to return back to development?
      Runs the following:
        git fetch
        git checkout dev
        git reset --hard origin/dev
    `))return}if(await e())return console.error("Can not return to dev branch as changes are present on the current branch."),!1;let Y=!1;if(!await M("git",["fetch"]))Y=!0;if(!await M("git",["checkout","dev"]))Y=!0;if(!await M("git",["reset","--hard","origin/dev"]))Y=!0;if(Y)return console.error("Could not return to dev branch."),!1;return!0}var z0=L(()=>{T();U1();J1()});import I from"fs-extra";import O3 from"ignore";import _ from"path";async function I3(){const $=await u();console.warn("Building full distribution...");let Y=await Bun.build({entrypoints:[_.resolve("./bin/main.ts")],target:"bun",external:Object.keys($),minify:!0,sourcemap:"inline"});for(let K of Y.outputs)console.warn("Writing bin bundle resource:",z.cyanBrightBold(K.path)),await Bun.write(_.resolve("./dist/bin",K.path),K);console.warn("Building gimped distribution..."),Y=await Bun.build({entrypoints:[_.resolve("./bin/main-gimp.ts")],target:"node",external:Object.keys($),minify:!0,sourcemap:"inline"});for(let K of Y.outputs)console.warn("Writing bin bundle resource:",z.cyanBrightBold(K.path)),await Bun.write(_.resolve("./dist/bin",K.path),K);console.warn("Copying entry cross-platform distribution..."),I.copyFileSync(_.resolve("./bin/main-entry.cjs"),_.resolve("./dist/bin/main-entry.cjs"))}async function x3(){if(!I.existsSync(_.resolve("./bin/shim")))console.error("No shim distribution files found to be built");if(I.existsSync(_.resolve("./shim")))I.removeSync(_.resolve("./shim"));const $=await u();console.warn("Building shim distribution...");const Y=await Bun.build({entrypoints:[_.resolve("./bin/shim/index.ts")],target:"node",external:Object.keys($),minify:!0});for(let Z of Y.outputs)console.warn("Writing shim bundle resource:",z.cyanBrightBold(Z.path)),await Bun.write(_.resolve("./shim/src/bin/shim",Z.path),Z);I.writeFileSync(_.resolve("./shim/index.js"),'export * from "./src/bin/shim/index.js";\n',{encoding:"utf-8"}),I.writeFileSync(_.resolve("./shim/index.d.ts"),'export * from "./src/bin/shim/index.d.ts";\n',{encoding:"utf-8"});const K=I.readJSONSync(_.resolve("tsconfig.json"));if(K.exclude=K.exclude||[],K.exclude.push("./bin/lib/**"),K.include=["./bin/shim"],I.writeJSONSync(_.resolve("tsconfig.temp.json"),K),await E(500),!M("tsc",["-d","--emitDeclarationOnly","--pretty","--outDir",_.resolve("./shim/src/bin"),"--project",_.resolve("tsconfig.temp.json")]))console.warn("Failed to compile type declarations for the shim files."),I.removeSync(_.resolve("tsconfig.temp.json")),process.exit(1);I.removeSync(_.resolve("tsconfig.temp.json"))}async function U3(){console.warn(z.yellowBright("Copying template files for bin distribution"));const $=_.resolve(__dirname,"../../template"),Y=_.resolve("./dist/bin/template");I.copySync($,Y);const K=I.readdirSync(Y).map((J)=>_.resolve(Y,J,"index.ts")).filter((J)=>{if(I.existsSync(J))return!0}),Z=await u();let G=!1;for(let J of K){const Q=await Bun.build({entrypoints:[J],target:"bun",external:Object.keys(Z),minify:!0});if(!Q.success){console.error(z.redBrightBold("Build failed for template:"),z.cyanBrightBold(_.relative(Y,_.dirname(J))));for(let X of Q.logs)console.error(X);G=!0}for(let X of Q.outputs)console.warn("Writing template entry file:",z.cyanBrightBold(_.relative(Y,_.resolve(_.dirname(J),X.path)))),await Bun.write(_.resolve(_.dirname(J),X.path),X)}if(G)console.error(z.redBrightBold("Some templates have errors (see above), stopping the build process.")),process.exit(1)}async function V3(){console.warn(z.yellowBright("Copying entry shell script for bin distribution")),I.copySync(_.resolve("./bin/main-entry.sh"),_.resolve("./dist/bin/main-entry.sh")),I.copySync(_.resolve("./bin/main-entry.ps1"),_.resolve("./dist/bin/main-entry.ps1"))}async function q$(){if(console.warn(z.cyanBright("Building bin commands for the distribution.")),!I.existsSync(_.resolve("./bin/main.ts"))||!I.existsSync(_.resolve("./bin/main-entry.sh"))||X0.ignores("bin")){console.warn(`Tried to make a release for the bin commands, but no bin/main.ts or bin/main.sh entry file was found. (or was gitignored):\n\t${_.resolve("./bin/main.ts")}\n\t${_.resolve("./bin/main.sh")}`);return}I.ensureDirSync(_.resolve("./dist")),I.ensureDirSync(_.resolve("./dist/bin/template")),await I3(),await x3(),await U3(),await V3()}var __dirname,_$,X0;var N$=L(()=>{O();T();_1();a();__dirname="/Users/diniden/Desktop/VoidRay/dev-ops/node-devops/bin/lib/build/bin",_$=_.resolve(".gitignore"),X0=O3.default();if(I.existsSync(_$))X0=X0.add(I.readFileSync(_$).toString())});import D$ from"fs";import A$ from"path";function O$($){return{name:"vite-devops-string-replace-plugin",enforce:"pre",load(Y){const K=A$.resolve(Y),Z=[".ts",".js",".tsx",".jsx"];if(D$.existsSync(K)&&Z.includes(A$.extname(K))&&!K.includes("node_modules")&&!K.includes("\0")){let G=D$.readFileSync(K,{encoding:"utf-8"});return $.forEach((J)=>{G=G.replace(J.from,J.to)}),G}}}}var I$=L(()=>{});import S from"fs-extra";import j from"path";function x$($){const Y=process.env.PROJECT_ROOT||".",K=j.resolve(Y,"app/config");if(!S.existsSync(K)){console.warn(`viteDevopsAppConfigPlugin: ${z.cyanBrightBold("No app/config folder found.")}`);return}try{const Z=S.readdirSync(K).filter((B)=>{return S.statSync(j.join(K,B)).isDirectory()}),G=Z.map((B)=>j.join(K,B)),Q=Z.map((B,N)=>{if(!$)if(S.existsSync(j.join(G[N],`${B}.local`))||S.existsSync(j.join(G[N],`${B}.local.js`))||S.existsSync(j.join(G[N],`${B}.local.ts`))||S.existsSync(j.join(G[N],`${B}.local.tsx`))||S.existsSync(j.join(G[N],`${B}.local.jsx`)))return[{from:`"config/${B}/${B}"`,to:`"config/${B}/${B}.local"`},{from:`"config/${B}/${B}.js"`,to:`"config/${B}/${B}.local.js"`},{from:`"config/${B}/${B}.ts"`,to:`"config/${B}/${B}.local.ts"`}];else return[];return[{from:`"config/${B}/${B}"`,to:`"config/${B}/${B}.${$}"`},{from:`"config/${B}/${B}.js"`,to:`"config/${B}/${B}.${$}.js"`},{from:`"config/${B}/${B}.ts"`,to:`"config/${B}/${B}.${$}.ts"`}]}).reduce((B,N)=>B.concat(N),[]),F=[...!$&&(S.existsSync(j.join(K,"env.local"))||S.existsSync(j.join(K,"env.local.js"))||S.existsSync(j.join(K,"env.local.ts"))||S.existsSync(j.join(K,"env.local.tsx"))||S.existsSync(j.join(K,"env.local.jsx")))?[{from:'"config/env"',to:'"config/env.local"'},{from:'"config/env.js"',to:'"config/env.local.js"'},{from:'"config/env.ts"',to:'"config/env.local.ts"'}]:$?[{from:'"config/env"',to:`"config/env.${$}"`},{from:'"config/env.js"',to:`"config/env.${$}.js"`},{from:'"config/env.ts"',to:`"config/env.${$}.ts"`}]:[],...Q];if(F.length>0)console.warn(`

  ${z.yellowBrightBold("Using the following mappings for app config:")}

  \t${z.cyanBrightBold(F.map((B)=>`\n  ${B.from} => ${B.to}`).join("\n\t"))}

      `);return O$(F)}catch(Z){console.error(Z),console.error(z.redBrightBold(`
      App config plugin failed to load. The default config paths will be used
      and any specific environment requested will be ignored.
    `))}}var U$=L(()=>{O();I$()});import*as T$ from"vite";import T1 from"fs-extra";import T3 from"ignore";import $1 from"path";async function w$($){if(console.warn(z.cyanBright("Building client files for the distribution.")),process.env.VITE_RELEASE_VERSION=process.env.VITE_RELEASE_VERSION||await U(),process.env.FORCE_BUILD!=="true"){if(!T1.existsSync($1.resolve("app/client"))||W0.ignores("app/client")){console.error(`Tried to make a release for the web app client, but no app/client entry file was found. (or was gitignored):\n\t${$1.resolve("app/client")}`);return}}const Y="development";process.env.NODE_ENV="production",console.warn(`Releasing ${z.yellowBrightBold("app/client")} for Environment:`,z.cyanBrightBold($)),process.env.BUILD_ENV=$;const K=await t();if(K.plugins=[x$($),...K.plugins||[]],K.logLevel="warn",K.mode="production",K.root=$1.resolve("app/client"),K.build.outDir=$1.resolve("dist/app/client",$),K.build.watch=void 0,K.build.rollupOptions.output={dir:K.build.outDir,entryFileNames:"index.js",chunkFileNames:"index.js",manualChunks:void 0},await T$.build(K),process.env.NODE_ENV=Y,!T1.existsSync($1.resolve(`dist/app/client/${$}/index.js`)))console.error("\n\nFailed to create Client output bundle. Exiting process...\n\n"),process.exit(1)}var V$,W0;var C$=L(()=>{b1();O();y();U$();V$=$1.resolve(".gitignore"),W0=T3.default();if(T1.existsSync(V$))W0=W0.add(T1.readFileSync(V$).toString())});async function Y1($=[]){const Y=await R();if(Y1.optimize){if(Y[1]==="bunx")return M(Y[1],["--bun",...$])}return M(Y[1],[...$])}var B0=L(()=>{T();s();Y1.optimize=!0});import w1 from"fs-extra";import W1 from"path";async function C1(){if(!w1.existsSync(W1.resolve("ui")))return;w1.ensureDir(W1.resolve("dist/types")),console.warn(z.yellowBrightBold("Generating .d.ts files...")),Y1(["tsc","--emitDeclarationOnly","--declaration","--outDir","dist/types","--project",W1.resolve("tsconfig.json")]);const $=w1.readdirSync(W1.resolve("dist/types"));for(let Y of $){if(Y==="ui"||Y==="util")continue;console.warn(z.yellowBright(`Removing types for folder: ${Y}`)),w1.removeSync(W1.resolve("dist/types",Y))}}var H0=L(()=>{O();B0()});import w3 from"fs-extra";import C3 from"path";async function S$(){return w3.readJSONSync(C3.resolve("package.json")).name||""}var j$=L(()=>{});import*as R$ from"vite";import S1 from"fs";import S3 from"ignore";import d from"path";async function k$(){if(console.warn(z.cyanBright("Copying ui files for the distribution.")),process.env.VITE_RELEASE_VERSION=process.env.VITE_RELEASE_VERSION||await U(),!process.env.FORCE_BUILD){if(!S1.existsSync(d.resolve("ui"))||F0.ignores("ui")){console.error(`"No library project found (or was gitignored) for bundling release at:\n\t${d.resolve("ui")}`);return}}if(console.warn(z.yellowBrightBold("Starting Vite client build...")),!S1.existsSync(d.resolve("ui/index.ts"))){console.error("The UI folder project has no index.ts entry point to create the library.");return}await C1(),console.warn(z.yellowBrightBold("Building library bundle..."));const $=await t();$.logLevel="warn",$.root=d.resolve("ui"),$.build.lib={entry:d.resolve("ui/index.ts"),name:(await S$()).split("@").join("").split("/").join("_"),fileName:"index"},$.mode="production",$.root=d.resolve("app/client"),$.build.outDir=d.resolve("dist/ui"),$.build.watch=void 0,$.build.rollupOptions.output={dir:$.build.outDir,entryFileNames:"index.js",chunkFileNames:"index.js",manualChunks:void 0};const Y=Object.keys(await u());console.warn("Externalized Libraries that will not be included in the bundle:",Y),$.build.rollupOptions={...$.build.rollupOptions,external:Y},await R$.build($)}var E$,F0;var P$=L(()=>{b1();O();H0();_1();j$();y();E$=d.resolve(".gitignore"),F0=S3.default();if(S1.existsSync(E$))F0=F0.add(S1.readFileSync(E$).toString())});import p from"fs-extra";import v from"path";async function y$(){process.env.VITE_RELEASE_VERSION=process.env.VITE_RELEASE_VERSION||await U(),console.warn(z.cyanBright("Copying story files for the distribution."));const $=v.resolve("dist/stories"),Y=v.resolve("ui/stories"),K=v.resolve("dist");if(!p.existsSync(Y)){console.error(`Could not find stories directory:\n\t${Y}`);return}p.ensureDirSync($),p.copySync(Y,$);const Z=v.resolve("package.json"),J={name:p.readJSONSync(Z).name||"unknown",private:!0,type:"module",main:"./ui/index.js",types:"./types/ui/index.d.ts",dependencies:{},repository:{},scripts:{},devDependencies:{}};console.warn("Writing distribution package.json:",v.resolve(K,"package.json")),p.writeJSONSync(v.resolve(K,"package.json"),J),await E(500),p.ensureDirSync(v.resolve(K,"components")),J.main="../ui/index.js",J.types="../types/ui/index.d.ts",console.warn("Writing distribution package.json:",v.resolve(K,"components/package.json")),p.writeJSONSync(v.resolve(K,"components/package.json"),J),await E(500),console.warn("Finished copying stories.")}var v$=L(()=>{O();y();a()});var m$={};C(m$,{default:()=>{{return E1}}});import j1 from"fs-extra";import K1 from"path";async function j3(){if(process.env.QUICK_BUILD==="true")return;if(await l("release",["view"]),!await P("\nShould the release continue being made?"))await V1(!0),process.exit(1)}async function E3(){console.warn("Gathering build targets from:",z.yellowBright(K1.resolve("build.conf.js")));const $=(await import(K1.resolve("build.conf.js"))).BUILD_TARGETS;if(process.env.NODE_ENV="production",console.warn("Building environments",z.redBrightBold(JSON.stringify($))),!Array.isArray($))console.error("build.conf.js must be an array of string values"),process.exit(1);for(let Y of $)await w$(Y);await k$(),await y$(),await q$()}async function R3(){try{j1.removeSync(K1.resolve("dist"))}catch($){console.warn("No dist folder to clean out.")}j1.ensureDirSync(K1.resolve("dist"))}async function k3(){try{j1.removeSync(K1.resolve("dist/test"))}catch($){console.warn("No test folder to clean out")}try{j1.removeSync(K1.resolve("dist/unit-test"))}catch($){console.warn("No unit-test folder to clean out")}}async function E1(){console.warn("Validating the release..."),await j3(),console.warn("Clear previous build..."),await R3(),console.warn("Bundling project..."),await E3(),console.warn("Final cleanup..."),await k3(),console.warn("Release Build complete!")}var L0=L(()=>{O();N1();z0();J1();N$();C$();P$();v$()});var h$={};C(h$,{default:()=>{{return k1}}});import u$ from"fs-extra";import P3 from"lodash/groupBy.js";import R1 from"path";import y3 from"lodash/uniq.js";import v3 from"lodash/upperFirst.js";import{compare as m3,inc as f3} from"semver";async function l3($){console.warn("Building release notes..."),console.warn("fetching tags...");const Y=await A("git",["tag","--list"]);if(Y===null)console.error("Could not get git tags"),process.exit(1);const K=Y.trim().split("\n").sort(m3),Z=K[(K.includes($)?K.indexOf($):K.length)-1];console.warn("fetching version hash...");const G=await A("git",["rev-list","-1",`${$}`]);if(G===null)console.error("Couldn't get current version hash"),process.exit(1);const J=G.trim();console.warn("fetching previous version hash...");let Q=await A("git",["rev-list","-1",`${Z}`]);if(Q===null){if(Q=await A("git",["rev-list","--max-parents=0","HEAD"]),Q===null)console.error("Couldn't get previous version hash"),process.exit(1)}const X=Q.trim();console.warn("fetching logs...");const W=await A("git",["log","--pretty=%B",`${X}...${J}`]);if(W===null)console.error("Couldn't get logs"),process.exit(1);const F=W.split("\n").map((D)=>{const[,q="",H=""]=D.match(/^\s*(\w+?)\s*:\s*(.*)\s*$/)||[];return{tag:d$[q.toLowerCase()],message:v3(H)}}).filter((D)=>D.tag),B=P3(F,"tag"),N=d3.filter((D)=>B[D]).map((D)=>{const q=B[D];return`## ${D.replace(/(\w)/,(H)=>H.toUpperCase())}\n\n${q.map(({tag:H,message:x})=>`- [\`${H.toUpperCase()}\`]: ${x}`).join("\n")}`}).join("\n\n");return console.warn("New release notes completed"),N}async function k1($={}){if(console.warn("Generating Release Notes..."),await A("git",["fetch","--tags"])===null)console.error("Couldn't fetch tags"),process.exit(1);const K=f$(R1.resolve("package.json")),{version:Z="0.0.1"}=K;console.warn("Current Project version:",{currentVersion:Z});const G=await l3("HEAD"),J=h3(G),Q=J&&f3(Z,J);if(!Q)console.error("Unable to determine next version",{currentVersion:Z}),process.exit(1);if($.tag){if(console.warn("Creating the new tag..."),await A("git",["tag","-a",Q,"-m",`Release ${Q}`])===null)console.error("Couldn't create tag"),process.exit(1)}if($.updatePackage){console.warn("Updating the package.json...");const W=f$(R1.resolve("package.json"));W.version=Q,g$(R1.resolve("package.json"),`${JSON.stringify(W,null,"  ")}\n`)}const X=`## ${Q}\n\n${G}`;if(!G.trim()&&$.errorOnEmpty)throw new Error("No notes were generated as no semver style messages were found");if($.file){console.warn("Writing the release notes to file:",$.file);const W=R1.resolve($.file),F=g3(W)?u3(W):"";g$(W,`${`${X}\n\n${F}`.trim()}\n`);for(let N=0;N<=100;++N){if(u$.existsSync(W))break;if(N===100)console.warn("Release notes file was not created in time for the final release commit:",z.redBrightBold(W)),process.exit(1)}if(console.warn("Adding fragments to git..."),await A("git",["add","-A"])===null)console.warn("Could not ensure all fragments are added for the next commit."),process.exit(1);if(console.warn("Committing to git..."),await A("git",["commit","-am",`Release ${Q}`])===null)console.error("Couldn't commit changes"),process.exit(1);console.warn(`\n\n${z.cyan(X)}\n\n`)}else console.warn(`\n\n${z.cyan(X)}\n\n`);process.env.VITE_RELEASE_VERSION=Q}var h3,g3,u3,f$,g$,d$,d3;var M0=L(()=>{O();c();h3=function($){const Y=$.toLowerCase().split("\n").map((K)=>(K.match(/## (\w+)/)||[])[1]).filter(Boolean);if(Y.includes("breaking"))return"major";if(Y.includes("added"))return"minor";return"patch"};({existsSync:g3,readFileSync:u3,readJSONSync:f$,writeFileSync:g$}=u$),d$={breaking:"breaking",feat:"added",feature:"added",added:"added",fix:"fixed",fixed:"fixed",hotfix:"fixed",task:"task"},d3=y3(Object.values(d$))});async function P1($){return M("git",["ls-remote",$])}var b0=L(()=>{T()});async function l$($){const Y=await A("git",["remote","-v"]);if(Y===null)console.warn("Could not list remotes for the git project."),process.exit(1);const K=Y.split(/\r?\n/g),Z=K.find((J)=>J.indexOf($)>=0);if(!Z)console.warn(b`
      You MUST have a remote named ${$} which points to the repository you
      wish to deploy to.

      ${K.join("\n")}
    `),process.exit(1);const G=Z.split(/\s+/g)[1];if(!P1(G))console.warn(`
      You do not seem to have access to the repo listed in the package json of
      this project. Please ensure you have write access to the repo:
      ${G}
      and then try to run the release again.
    `),process.exit(1)}var c$=L(()=>{n();c();b0()});async function p$(){const $=await A("git",["rev-parse","--abbrev-ref","HEAD"]);if($===null){console.error("Failed to determine current branch.");return}return $.trim()||void 0}var i$=L(()=>{c()});var n$;var s$=L(()=>{c();i$();n$=async($,Y)=>{const K=await p$();if(!K)return console.warn("Could not determine current branch."),!1;if(await A("git",["checkout",`${Y}`])===null)return console.warn(`Could not checkout branch ${Y}`),!1;if(await A("git",["reset","--hard",`${$}/${Y}`])===null){if(console.warn(`Could not reset branch ${Y}`),await A("git",["checkout",`${K}`]))console.warn(`Could not return to original branch ${K}`);return!1}if(await A("git",["checkout",`${K}`])===null)return console.warn(`Could not return to original branch ${K}`),!1;return!0}});import c3 from"fs-extra";import p3 from"path";async function o$(){return c3.readJSONSync(p3.resolve("package.json")).repository||{}}var a$=L(()=>{});var e$={};C(e$,{default:()=>{{return r$}}});import y1 from"fs-extra";import v1 from"path";async function i3(){const $=await o$(),Y=$.url;if(!$||!($.type!=="gitlab"||$.type!=="git"||$.type!=="bitbucket"||$.type!=="stash"))console.warn(`
      You MUST have a repository specified in your package json to use the
      release script. It must be of 'type: git' and have a valid ssh url to
      your git repo.

      Additionally, you MUST have a remote configured for your project of
      'origin' that matches the repo url listed in your package.json.

      Thus: "git remote -v" SHOULD output a line with
      origin <url in your package json repository field> (push)
    `),process.exit(1);const K=await A("git",["remote","-v"]);if(K===null)console.warn("Could not list remotes for the git project."),process.exit(1);const Z=K.split(/\r?\n/g);if(!Z.find((J)=>J.indexOf(i)>=0&&J.indexOf(Y)>=0))console.warn("Could not match package json repository to an origin remote in git CLI",{remoteListProcess:K,remotes:Z,ENSURE_REMOTE:i,ENSURE_REMOTE_PROJECT:Y}),process.exit(1);if(!P1(Y))console.warn(`
      You do not seem to have access to the repo listed in the package json of
      this project. Please ensure you have write access to the repo:
      ${Y}
      and then try to run the release again.
    `),process.exit(1);if(await e())console.error("You have uncommitted changes or the current state of the project can not be determined. Please commit or stash them before continuing."),process.exit(1);console.warn("Repository validation complete")}async function n3(){if(!await await M("git",["checkout","release"])){if(!await M("git",["checkout","-b","release"]))console.warn("Could not switch to the release branch. Make sure the branch exists locally."),process.exit(1)}if(!await M("git",["fetch",`${i}`]))console.warn("Could not fetch from remote servers."),process.exit(1);if(!await M("git",["reset","--hard",`${i}/dev`]))console.warn("Could not reset branch to dev"),process.exit(1);console.warn("Checked out release branch and updated to dev")}async function o3($){const Y=await U();if(!await M("git",["add","-A"]))console.warn("Could not ensure all fragments are added for the next commit."),process.exit(1);await k1({file:"RELEASE_NOTES.md",updatePackage:!0});const K=await U();if(Y===K)console.warn(`
      The release script did not detect any changes for a release. If you find
      this to be in error or you want to force a new release. Make some commits
      with proper release note formatted messages to trigger a release.
    `),process.exit(1);if($){if(s3()!=="patch")console.error(`
        Cannot create a release for an alternate branch that is not a simple
        patch. Features and breaking changes can ONLY be made on the main branch of
        development.
      `),process.exit(1)}const Z=await A("git",["log","-1","--pretty=%B"]);if(Z===null)console.warn("Could not read the last commit version information"),process.exit(1);const G=(Z.trim().toLowerCase().split("release ")[1]||"").trim();if(!G)console.warn("Could not determine release version from the last commit:\n\n",Z.toString(),"\n\n"),process.exit(1);if(y1.existsSync(v1.resolve("ui/release.json"))){try{const J=y1.readJSONSync(v1.resolve("ui/release.json"));J.version=G,y1.writeJSONSync(v1.resolve("ui/release.json"),J)}catch(J){console.warn("Could not update the release.json file with current library version."),process.exit(1)}if(!await M("git",["add","-A"]))console.warn("Could not ensure the release json was updated for the new version."),process.exit(1);if(!await M("git",["commit","--amend","--no-edit"]))console.warn("Could not amend the release commit to include the release json file."),process.exit(1)}if(G.includes('"'))console.warn("The update version generated is invalid as it contains invalid characters",{version:G}),process.exit(1);return console.warn("Updating version to",{version:G}),G}async function a3($){if(!await M("git",["tag","-a",$,"-m",`Release ${$}`]))console.warn("Could not make tag for git commit"),process.exit(1)}async function t$($,Y,K,Z,G){if(!await M("git",["push",G?"-f":void 0,$,`${K}:${Z}`]))console.warn(`Could not push release commit to ${$}`),process.exit(1);if(!await M("git",["push",$,Y]))console.warn("Could not push tag to the remote repository"),process.exit(1)}async function t3($,Y){if($&&$.length>0){if(!await P(b`
        The build and release was successful, would you like to release to the
        specified additional remotes?

        ${z.cyanBrightBold($.join("\n"))}
      `))return}if(!await M("git",["fetch",i]))console.warn("Could not fetch from remote servers."),process.exit(1);for(let K of $){const[Z,G,J,Q]=K.split(":");await l$(Z),await n$(i,G||"master"),await t$(Z,Y,G||"master",J||"master",Q==="force")}}async function r3($){process.env.NODE_ENV="production",await i3(),await n3(),await E1();const Y=await o3();if(await a3(Y),await t$(i,Y,"release","release",!0),await P("Would you like to run pr release?"))await l("pr",["release"]);await t3($,Y),await V1(!0)}async function r$($){console.warn("Executing release script"),r3($)}var s3,i;var $9=L(()=>{L0();M0();O();n();N1();T();c();b0();c$();U1();z0();s$();J1();a$();y();s3=function(){try{const Y=y1.readFileSync(v1.resolve("RELEASE_NOTES.md"),"utf8").toLowerCase().split("\n").map((K)=>(K.match(/## (\w+)/)||[])[1]).filter(Boolean);if(Y.includes("breaking"))return"major";if(Y.includes("added"))return"minor";return"patch"}catch($){console.error("Could not determine release type after release was created"),process.exit(1)}};i="origin"});var K9={};C(K9,{default:()=>{{return Y9}}});async function Y9(){await C1()}var Z9=L(()=>{H0()});var _0={};C(_0,{default:()=>{{return J9}}});import m from"fs-extra";import e3 from"ignore";import w from"path";async function $4($){const Y=m.readJSONSync(w.resolve("tsconfig.json"));if(Y.exclude=Y.exclude||[],Y.include=(Y?.include||[]).filter((Z)=>!m1.ignores(w.relative("./",Z))),m.writeJSONSync(w.resolve("tsconfig.temp.json"),Y),await E(500),$==="watch"){const Z=async()=>{console.warn("Exit TS process");try{m.removeSync(w.resolve("tsconfig.temp.json"))}catch(G){}process.exit(0)};process.on("exit",Z),process.on("SIGINT",Z),process.on("SIGUSR1",Z),process.on("SIGUSR2",Z),process.on("SIGTERM",Z),process.on("uncaughtException",Z)}if(!M("tsc",["-d",$==="watch"?"--watch":"","--incremental","--noemit","--pretty","--tsBuildInfoFile",w.resolve("node_modules/.cache/tsc/tsc.tsbuildinfo"),"--outDir",w.resolve("dist"),"--project",w.resolve("tsconfig.temp.json")]))console.warn("Failed to compile type declarations"),m.removeSync(w.resolve("tsconfig.temp.json")),process.exit(1);const K=(Y?.include||[]).filter((Z)=>!m1.ignores(w.relative("./",Z))).map((Z)=>w.resolve(Z)).filter((Z)=>m.existsSync(Z)&&!Z.includes("node_modules"));if(K.length>0){if(!M("eslint",[...K,"-c",w.resolve(".eslintrc"),"--ext",".ts","--ext",".tsx"]))console.warn("Failed eslint checks."),m.removeSync(w.resolve("tsconfig.temp.json")),process.exit(1)}m.removeSync(w.resolve("tsconfig.temp.json"))}async function J9($){await $4($)}var G9,m1;var q0=L(()=>{T();a();G9=w.resolve(".gitignore"),m1=e3.default();if(m.existsSync(G9))m1=m1.add(m.readFileSync(G9).toString())});var z9={};C(z9,{default:()=>{{return Q9}}});async function Q9(){console.warn(z.yellowBrightBold("Starting server...")),await X1()}var X9=L(()=>{o1();O()});var L9={};C(L9,{default:()=>{{return F9}}});import Y4 from"fs-extra";import N0 from"path";async function H9($){if(!Y4.existsSync($))return console.warn("Attempted to start a server but no server distribution was found at",$),!1;return await M("bun",[`${$}`]),!0}async function W9(){const $=N0.resolve("docs/index.js");return await H9($)}async function B9(){process.env.RESOURCE_PATH=N0.resolve("dist/app/client");const $=N0.resolve("dist/app/server/index.js");return await H9($)}async function F9($,Y){const{PORT:K="80"}=process.env;process.env.PORT=K;let Z=!1;switch($){case"app":Z=await B9();break;case"devops":Z=await W9();break;default:if($)console.warn("Invalid target for start script specified",$);break}if(!Z){if(Z=await B9(),Z)return;if(Z=await W9(),Z)return}}var M9=L(()=>{T()});import K4 from"fs-extra";import D0 from"path";async function b9(){const $=D0.resolve("tsconfig.json");if(!K4.existsSync($))throw new Error("Target project does not have a TSConfig");const Y=Boolean(process.env.DEBUG),K=process.env.PATTERN,Z=process.env.WATCH,G=process.env.LESS,J=D0.resolve("jest.config.js");M.silent=!0;try{if(Y)M("node",["--inspect-brk",D0.resolve("node_modules/.bin/jest"),"--runInBand",Z?"--watchAll":"","--verbose",G==="true"?"false":void 0,"--colors","--config",J,K?`--testNamePattern ${K}`:""]);else Y1(["jest",Z?"--watchAll":"","--verbose",G==="true"?"false":void 0,"--colors","--config",J,K?`--testNamePattern=${K}`:""])}catch(Q){console.warn("Tests failed. Please look at logs to see the errors discovered")}console.warn(z.cyanBright("Tests complete"))}var _9=L(()=>{O();B0();T()});var N9={};C(N9,{default:()=>{{return q9}}});async function q9(){console.warn("Running unit tests..."),await b9()}var D9=L(()=>{_9()});var U9={};C(U9,{default:()=>{{return x9}}});import A9 from"fs";import O9 from"path";import I9 from"rimraf";async function x9(){const $=O9.resolve("./node_modules/.cache/"),Y=O9.resolve("./build");if(A9.existsSync($))I9.sync($),console.warn("Cache: Clean complete");else console.warn("Cache: Already clean");if(A9.existsSync(Y))I9.sync(Y),console.warn("Build: Clean complete");else console.warn("Build: Already clean");if(await M("bun",["pm","cache","rm"]))console.warn("Bun: Clean complete");else console.warn("Bun: Already clean")}var V9=L(()=>{T()});import T9 from"path";import{createRequire as Z4} from"module";async function f1($,Y){const G=Z4(import.meta.url).resolve($).split("node_modules"),J=G[0],Q=G[1].split(T9.sep)[1];return T9.join(J,"node_modules",Q,"node_modules",".cache",Y)}var w9=L(()=>{});var S9={};C(S9,{default:()=>{{return C9}}});import G4 from"fs-extra";import Z1 from"path";import J4 from"url";async function Q4($,Y,K){const Z=await import("puppeteer"),G=await f1("puppeteer","pr-release"),J=await Z.launch({headless:!1,userDataDir:Z1.resolve(B1,G),defaultViewport:null}),Q=await J.newPage();console.warn("Opening project url..."),await Q.goto($);const X=await Q.evaluate(()=>document.body.getAttribute("data-project-id"));if(!X){console.warn("No project id found, User login required...");let F=!0;J.on("disconnected",()=>{if(!F)return;console.warn("Browser was closed or crashed. Try the command again."),process.exit(1)}),await Q.goto($),await Q.waitForFunction(()=>{const B=document?.body?.getAttribute("data-project-id");return B!==null&&B!==void 0},{timeout:0}),await Q.close(),F=!1}else await Q.close();console.warn("Project ID found:",X,"\nOpening merge request...");const W=async(F,B,N)=>{const D=await J.newPage();await D.goto(`${$}/-/merge_requests/new?${N?"utf8=%E2%9C%93&":""}merge_request%5Bsource_project_id%5D=${X}&merge_request%5Bsource_branch%5D=${encodeURIComponent(F)}&merge_request%5Btarget_project_id%5D=${X}&merge_request%5Btarget_branch%5D=${B}`),await D.waitForFunction(()=>{const q=document.querySelector("#merge_request_title");return q!==null&&q!==void 0},{timeout:0}),await D.evaluate((q)=>{let H=document.querySelector("#merge_request_title");if(H)H.value=`Release ${q}`;if(H=document.querySelector("#merge_request_description"),H)H.value=`Release ${q}`;if(H=document.querySelector("#merge_request_force_remove_source_branch"),H)H.checked=!1,H.value="0"},Y),await new Promise((q)=>{D.on("close",()=>{q(void 0),console.warn("Gitlab ticket process finished\n\n")})})};console.warn("\n\nWaiting for browser windows to be closed...\n\n"),await Promise.all([W("release","dev"),W("release",K)]),J.close()}async function A0($,Y,K,Z){const G=await import("puppeteer"),J=await f1("puppeteer","pr-release");let Q=await G.launch({headless:!Z,userDataDir:Z1.resolve(B1,J),defaultViewport:null});const X=await Q.newPage();if(Z){console.warn("User login required...");let N=!0;Q.on("disconnected",()=>{if(!N)return;console.warn("Browser was closed or crashed. Try the command again."),process.exit(1)});const D="https://github.com/login";console.warn("Opening github login page: ",D),await X.goto(D),await X.waitForFunction(()=>{const q=document?.body?.getAttribute("class")?.split(" ").find((H)=>H.startsWith("logged-in"));return q!==null&&q!==void 0},{timeout:0}),N=!1}else console.warn("Opening project url: ",$),await X.goto($);console.warn("Checking for logged-in attribute on body...");const W=await X.evaluate(()=>{return console.warn("logged-in check:",document?.body?.getAttribute("class")?.split(" ").find((N)=>N.startsWith("logged-in"))),document?.body?.getAttribute("class")?.split(" ").find((N)=>N.startsWith("logged-in"))});if(console.warn("Loggin in check:",W),!W&&Z)await Q.close(),console.error("Failed to log in the user for github."),process.exit(1);else if(!W){console.warn("Logged-in not found on body, login might be needed..."),await Q.close(),A0($,Y,K,!0);return}else Q.close();const F={headless:!1,userDataDir:Z1.resolve(B1,J),defaultViewport:null};Q=await G.launch(F);const B=async(N,D)=>{const q=await Q.newPage();await q.goto(`${$}/compare/${D}...${N}`),await q.waitForFunction(()=>{const H=document.querySelector("#repo-content-pjax-container > div > div.js-details-container.Details.js-compare-pr > div > button");return H?.click(),H!==null&&H!==void 0}),await q.evaluate(async(H)=>{let x=document.querySelector("#pull_request_title");if(x)x.value=`Release ${H}`;if(x=document.querySelector('[name="pull_request[body]"]'),x)x.value=`Release ${H}`},Y),await new Promise((H)=>{q.on("close",()=>{H(void 0),console.warn("Github ticket process finished\n\n")})})};console.warn("\n\nWaiting for browser windows to be closed...\n\n"),await Promise.all([B("release","dev"),B("release",K)]),Q.close()}async function z4($,Y,K,Z){const G=await import("puppeteer"),J=await f1("puppeteer","pr-release");let Q=await G.launch({headless:!Z,userDataDir:Z1.resolve(B1,J),defaultViewport:null});const X=await Q.newPage();if(Z){console.warn("User login required...");let N=!0;Q.on("disconnected",()=>{if(!N)return;console.warn("Browser was closed or crashed. Try the command again."),process.exit(1)});const D=$;console.warn("Opening azure repo login page: ",D),await X.goto(D),await X.waitForFunction(()=>{const q=window.sessionStorage.msameid;return q!==null&&q!==void 0},{timeout:0}),N=!1}else console.warn("Opening project url: ",$),await X.goto($);console.warn("Checking for logged-in attribute on body...");const W=await X.evaluate(()=>{return console.warn("logged-in check:",window.sessionStorage.msameid),window.sessionStorage.msameid});if(console.warn("Loggin in check:",W),!W&&Z)await Q.close(),console.error("Failed to log in the user for azure."),process.exit(1);else if(!W){console.warn("MS id not found, login might be needed..."),await Q.close(),A0($,Y,K,!0);return}else Q.close();const F={headless:!1,userDataDir:Z1.resolve(B1,J),defaultViewport:null};Q=await G.launch(F);const B=async(N,D)=>{const q=await Q.newPage();await q.goto(`${$}&sourceRef=${N}&targetRef=${D}`),await q.waitForFunction(()=>{const H=document.querySelector("button.primary");return H!==null&&H!==void 0}),await q.evaluate(async(H)=>{let x=document.querySelector('[aria-label="Enter a title"]');if(x)x.value=`Release ${H}`;if(x=document.querySelector('[aria-label="Description"]'),x)x.value=`Release ${H}`},Y),await new Promise((H)=>{q.on("close",()=>{H(void 0),console.warn("Azure project ticket process finished\n\n")})})};console.warn("\n\nWaiting for browser windows to be closed...\n\n"),await Promise.all([B("release","dev"),B("release",K)]),Q.close()}async function C9($,Y,K="master",...Z){if(!(new Set(["gitlab","git","github","azure"])).has(Y))console.error(`Unsupported repo type: ${Y}`),process.exit(1);if(await e())console.error("You have uncommitted changes or the current state of the project can not be determined. Please commit or stash them before continuing."),process.exit(1);const Q=G4.readJsonSync(Z1.resolve("package.json")).version;switch(Y){case"gitlab":await Q4($,Q,K);break;case"git":case"github":await A0($,Q,K);break;case"azure":await z4($,Q,K);break;default:console.warn("No supported repo type found")}}var B1;var j9=L(()=>{w9();U1();B1=J4.fileURLToPath(new URL(".",import.meta.url))});O();import*as X4 from"commander";import W4 from"inquirer-autocomplete-prompt";import B4 from"inquirer";import E9 from"path";import H4 from"yargs";O();n();import S0 from"fs-extra";import j0 from"path";O();import U0 from"fs";import V0 from"path";function x0($){const Y=$.split(/\r?\n/),K={};let Z=null,G=null;return Y.forEach((J)=>{if(J=J.trim(),J===""||J.startsWith("#"))return;if(J.endsWith("{")){Z=J.split(/\s+/)[0],K[Z]={};return}if(J==="}"){Z=null,G=null;return}const Q=J.match(/^([\w.]+)\s*=\s*(.*)$/);if(Q){const W=Q[1];let F=Q[2];if(!isNaN(parseFloat(F)))F=parseFloat(F);else if(F==="true")F=!0;else if(F==="false")F=!1;if(G)K[Z??"null"][G][W]=F;else if(Z)K[Z][W]=F;else K[W]=F;return}const X=J.match(/^([\w.]+)\.([\w.]+)\s*=\s*(.*)$/);if(X){const W=X[1],F=X[2],B=X[3];if(!K[W])K[W]={};if(!K[W][F])K[W][F]={};K[W][F][B]=null,Z=W,G=F;return}console.error(`Unrecognized line: ${J}`)}),K}function T0($){try{if(!U0.existsSync(V0.resolve(".env")))return;const Y=U0.readFileSync(V0.resolve($||".env"),"utf8"),K=x0(Y);Object.entries(K).forEach(([Z,G])=>{if(typeof G==="string")process.env[Z]=G;else if(typeof G==="number")process.env[Z]=G.toString();else if(typeof G==="boolean")process.env[Z]=G.toString()})}catch(Y){if(Y instanceof Error)console.error(z.red("Error reading .env file:\n",z.yellow(Y.stack||Y.message)))}}G1();J1();import h9 from"fs-extra";import l9 from"inquirer";import{stripIndent as c9} from"common-tags";async function C0($,Y,K,Z,G,J){let Q=J||!1;if(h9.existsSync($)){const{result:X}=await l9.prompt([{type:"confirm",name:"result",message:c9`${Y}`,default:J}]);if(X)K($),G?.($);Q=X}else K($),Z?.($);return Q}async function p9(){const $=(await import(j0.resolve("env.config.ts"))).default;if(!$)throw new Error("No env.config.ts file found.");if(!Array.isArray($))console.error("env.config.ts is not formatted correctly. Please follow the correct type convention.");return $}async function d1($){T0();try{const Y=await p9(),K=[],Z=[];if(Y.forEach((G)=>{if(!G)return;if(G.required){if(!process.env[G.name])K.push(b`
              Missing: ${G.name}\nDesription: ${G.description}
            `)}else if(!process.env[G.name]&&G.warn!==!1)Z.push(b`
              Missing: ${G.name}\nDesription: ${G.description}
            `)}),Z.length>0)console.warn(z.yellowBrightBold("The following environment variables are recommended but missing from your environment:\n")),console.warn(z.yellowBright(b`
          ${Z.join("\n")}
        `));if(K.length>0)console.error(z.redBrightBold("The following environment variables are required but missing from your environment:\n")),console.error(z.redBright(b`
          ${K.join("\n")}
        `));if(K.length>0){if($){if(await P(b`
          There seems to be some missing environment variables. Would you like
          to generate a .env file with the default values specified in the
          env.config file?
        `)){const J=[];for(let F of Y)J.push([F.name,w0(F.default)?F.default:f(F.default)?await F.default():void 0]);const Q=J.filter((F)=>F[1]).map((F)=>`${F[0]}=${F[1]}`).join("\n");if(!Q)console.warn(b`
              There are no defaults available for this env.config. So we can not
              generate an env file you. Please review the env.config.ts file and
              properly set the default values for the required environment
              variables.
            `);const X=j0.resolve(".env");if(!await C0(X,b`
              There appears to already be a .env file.
              Would you like to add the missing defaults to it?
            `,()=>{},()=>S0.writeFile(X,Q),()=>{S0.appendFileSync(X,`\n${Q}`)},!1))console.error("Did not write the .env file. Please correct the env and try again."),process.exit(1);return console.warn("Attempting to build the env again and continue with the command..."),d1(!1)}}process.exit(1)}}catch(Y){console.warn(b`
      No ${z.cyanBrightBold("env.config.ts")} file found. Environment will not be validated.
    `)}}n();import n9 from"fs-extra";import s9 from"inquirer";import o9 from"path";T();s();G1();async function o($,Y,K){const Z=await R(),G=$.filter(f);return await M(Z[0],["i",K?"--no-save":null,Y?`-${Y}`:null,...G])}T();import i9 from"fuzzy";var E0=($)=>async(Y,K)=>{let Z=[];if($ instanceof Set)Z=Array.from($);else Z=$;return i9.filter(K||"",Z).map((G)=>G.string)};s();async function R0($){try{return await import($),!0}catch(Y){return console.error("Requested package is not available in this current project:",$),!1}}a();async function k0($,Y){const K=$||["puppeteer"];for(let Z of K)if(console.warn("Checking on dependency availability:",Z),!await R0(Z)){let J=Y;if(!J)J=(await s9.prompt([{type:"autocomplete",name:"resolution",message:`How do you want to resolve the missing package "${Z}":`,source:E0([g.InstallOnce,g.InstallAbove,g.DoNothing])}])).resolution;switch(J){case g.Install:await o([Z],"E");break;case g.InstallOnce:o([Z],"E",!0);break;case g.InstallAbove:{const Q=process.cwd();process.chdir("..");const X=await R();if(!n9.existsSync(o9.resolve("package.json")))M(X[0],["init","-y"]);await o([Z],"E"),process.chdir(Q),await E(100);break}default:process.exit(1)}}}var g;(function(G){G["Install"]="Install to current project";G["InstallOnce"]="Install once to current project";G["InstallAbove"]="Install in parent directory (Makes package available to all peer projects)";G["DoNothing"]="Do Nothing (this will end this current process as the package is required)"})(g||(g={}));var O0=function(){return g1.debug=V.debug,g1.verbose=V.verbose,g1.pattern=V.pattern,g1};async function D4(){await d1(!0),V.parse(process.argv)}B4.registerPrompt("autocomplete",W4);var{Command:F4}=X4,V=new F4,g1={};V.version("0.0.1");V.option("-v, --verbose","Outputs more detailed information during crashes.");V.option("--debug [param]",b`
    Provides debugging contextual information various commands might use to
    aid in developing Devops.
  `);V.option("-p, --pattern [param]",b`
    Provides a pattern for certain operations to utilize. This is primarily
    used by unit tests to filter tests to specified tests.
  `);var R9=V.command("dev").description(b`
    These are the commands associated with starting up developer environments
    for various project types or portions of a project.
  `);R9.command("vite").description(b`
      Starts up a developer environment that performs incremental builds while
      developing within the lib and app folders. Uses vite and vite
      config.
    `).action(async()=>{(await Promise.resolve().then(() => (d0(),u0))).default().catch(($)=>{console.warn("dev-vite process exited unexpectedly"),console.warn($.stack||$.message),process.exit(1)})});R9.command("storybook").option("-i, --include <include...>","Additional storybook modules to load into storybook. These are the names of properly formatted dependencies installed into node_modules.").description(b`
      Starts a storybook instance for developing the UI components of the
      project. This makes the "ui/stories" folder in the project the expected
      development point.
    `).action(async({include:$})=>{(await Promise.resolve().then(() => (e1(),r1))).default("",$,E9.resolve(process.cwd()),O0()).catch((Y)=>{console.warn("storybook process exited unexpectedly"),console.warn(Y.stack||Y.message),process.exit(1)})});var L4=V.command("storybook");L4.command("run").option("-i, --include <include...>","Additional storybook modules to load into storybook. These are the names of properly formatted dependencies installed into node_modules.").description(b`
      Starts a storybook instance for developing the UI components of the
      project. This makes the "ui/stories" folder in the project the expected
      development point.
    `).action(async({include:$})=>{(await Promise.resolve().then(() => (e1(),r1))).default("",$,E9.resolve(process.cwd()),O0()).catch((Y)=>{console.warn("storybook process exited unexpectedly"),console.warn(Y.stack||Y.message),process.exit(1)})});V.command("url [uri...]").description(b`
      Simple command to open a specified URL in the browser.
    `).action(async($)=>{(await Promise.resolve().then(() => (b$(),M$))).default($).catch((Y)=>{console.warn("url process exited unexpectedly"),console.warn(Y.stack||Y.message),process.exit(1)})});var H1=V.command("release").description(b`
    These commands are used for facilitating distribution releases of
    applications. This includes tools for building th dist folder fragments,
    viewing the expected release notes, and actually performing a complete
    release cycle.
  `);H1.command("deploy [add-remote...]").description(b`
      Performs actions necessary to update the distribution of the project.
      This will automatically update release notes, tag the release, and
      commit and push to a 'release' branch which will be ready for merging
      into master and dev.

      Specify additional remotes to deploy to via the add-remote option.
      This will deploy the release to additional remotes (AFTER all other normal
      deploy operations complete). This value is the NAME of the remote as it
      appears when you perform a "git remote -v" command.

      You can specify a specific target branch via a colon: remote:branch
      Otherwise, this will use the same main branch as configured for this
      project.
    `).action(async($)=>{o([]),(await Promise.resolve().then(() => ($9(),e$))).default($).catch((Y)=>{console.warn("release-deploy process exited unexpectedly\n",Y.stack||Y.message),process.exit(1)})});H1.command("types").description(b`
      Updates JUST the types in the dist folder. These are the same types
      generated when building a release.
    `).action(async()=>{(await Promise.resolve().then(() => (Z9(),K9))).default().catch(($)=>{console.warn("release-types process exited unexpectedly\n",$.stack||$.message),process.exit(1)})});H1.command("view").description(b`
      This runs the release-view script. For this case, it will only display
      the release notes in the console. Actual generated release notes are a
      part of the release process.
    `).action(async()=>{(await Promise.resolve().then(() => (q0(),_0))).default("").then(async()=>{console.warn(z.cyanBrightBold("TS check passed, generating notes...")),(await Promise.resolve().then(() => (M0(),h$))).default().catch(($)=>{console.warn("release-notes process exited unexpectedly",$.stack||$.message),process.exit(1)})}).catch(($)=>{console.warn(z.redBrightBold(b`
              Failed TS check. Release notes will not be produced until all TS
              errors are resolved.
            `)),console.warn($.stack||$.message),process.exit(1)})});H1.command("build").description(b`
      This runs the release-build script. This generates all of the release
      fragments. This should ONLY be used for testing and experimenting. Actual
      release fragments should be properly created and deployed using the
      release deploy command.
    `).action(async()=>{(await Promise.resolve().then(() => (L0(),m$))).default().catch(($)=>{console.warn("release-deploy process exited unexpectedly\n",$.stack||$.message),process.exit(1)})});var M4=H1.command("start").description(b`
      This starts up released related processes. This includes things like
      starting up the dev server without any additional builds or auto
      configuration for development.
    `);M4.command("server").description(b`
      Starts up the app server without any additional builds etc. Use the
      environments:

        BUILD_MODE: Targets an env to run the server for.
        RESOURCE_PATH: The path to the static files to serve.
    `).action(async()=>{(await Promise.resolve().then(() => (X9(),z9))).default().catch(($)=>{console.warn("release-start-server process exited unexpectedly\n",$.stack||$.message),process.exit(1)})});V.command("start [target]").description(b`
      This fires up a server to make any static content available for being
      served.
      There are a few options for what content will be served by this script:

      - The web app
      - Devops API

      The start script will automatically pick the web app over the devops
      files, but you can specify a target if you have a devops API and a web
      app:

      - app
      - devops
    `).action(async($)=>{(await Promise.resolve().then(() => (M9(),L9))).default($,O0()).catch((Y)=>{console.warn("start process exited unexpectedly"),console.warn(Y.stack||Y.message),process.exit(1)})});var b4=V.command("test").description(b`
    These commands are used for running tests. This includes tools for
    running unit tests a single time or in a watch mode.

    Use the environment variables for modifying behavior:

    ${z.yellowBrightBold("PATTERN")} - This causes the tests to only run on
    files that match the pattern

    ${z.yellowBrightBold("LESS")} - This removes the verbose output list of
    all tests ran
  `);b4.command("run").description(b`
      Runs all unit tests in the unit-test folder once.
    `).action(async()=>{(await Promise.resolve().then(() => (D9(),N9))).default().catch(($)=>{console.warn("test-run process exited unexpectedly"),console.warn($.stack||$.message),process.exit(1)})});var _4=V.command("clean").description(b`
    Common cleaning tools for various fragments within the project.
  `);_4.command("cache").description(b`
      Cleans out build and cache files to help ensure a complete rebuild takes
      place.
    `).action(async()=>{(await Promise.resolve().then(() => (V9(),U9))).default().catch(($)=>{console.warn("clean-cache process exited unexpectedly"),console.warn($.stack||$.message),process.exit(1)})});var q4=V.command("ts").description(b`
    These commands are used for running typescript. This includes tools for
    running typescript compilation a single time or in a watch mode.
  `);q4.command("run").description(b`
      Runs typescript compilation to check for errors. Does NOT emit files, thus
      is a good mechanism for checking a build before running a release.
    `).action(async()=>{(await Promise.resolve().then(() => (q0(),_0))).default("").catch(($)=>{console.warn("ts process exited unexpectedly"),console.warn($.stack||$.message),process.exit(1)})});var N4=V.command("pr").option("--repoUrl <value>",b`
      The https URL to the repo to make the PR into
    `).option("--repoType <value>",b`
    The repository type to make the PR into. Supported types are: git, gitlab
  `).option("--masterBranch <value>",b`
    This indicates which branch is the master/main of the repository.
  `);N4.command("release").description(b`
      This creates two PRs that merges the current remote release branch into
      the remote dev and master branches.
    `).action(async()=>{const{repoUrl:$,repoType:Y,masterBranch:K}=H4(process.argv).argv;if(!$||!Y||!K)console.warn("You must specify both --repoUrl and --repoType to use this command"),process.exit(1);await k0().catch(()=>process.exit(1)),console.warn("Dependency checks passed, continuing..."),(await Promise.resolve().then(() => (j9(),S9))).default($,Y,K).catch((Z)=>{console.warn("pr-release process exited unexpectedly"),console.warn(Z.stack||Z.message),process.exit(1)})});D4();

//# debugId=798050F0C5DD08ED64756e2164756e21
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiYmluL2xpYi91dGlsL2NoYWxrLnRzIiwgImJpbi9saWIvdXRpbC9kZXNjcmlwdGlvbi50cyIsICJiaW4vbGliL3V0aWwvdHlwZXMudHMiLCAiYmluL2xpYi9wcm9tcHQvcHJvbXB0LWNvbmZpcm0udHMiLCAiYmluL2xpYi91dGlsL2lzLWNoaWxkLXByb2Nlc3MtZXJyb3IudHMiLCAiYmluL2xpYi9leGVjL2V4ZWMtc3luYy50cyIsICJiaW4vbGliL2V4ZWMvZ2V0LXBhY2thZ2UtbWFuYWdlci50cyIsICJiaW4vbGliL3V0aWwvd2FpdC50cyIsICJiaW4vbGliL2J1aWxkL2J1aWxkLXZpdGUtY29uZmlnLnRzIiwgImJpbi9saWIvdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtZGVwZW5kZW5jaWVzLnRzIiwgImJpbi9saWIvdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi50cyIsICJiaW4vbGliL2J1aWxkL3dlYi1hcHAvdml0ZS9idWlsZC1jbGllbnQudHMiLCAiYmluL2xpYi91dGlsL2hhbmRsZS1wcm9jZXNzLWV4aXQudHMiLCAiYmluL2xpYi91dGlsL2xvZy1xdWV1ZS50cyIsICJiaW4vbGliL2J1aWxkL3dlYi1hcHAvdml0ZS9ydW4tYXBwLXNlcnZlci50cyIsICJiaW4vY29tbWFuZHMvZGV2L2Rldi12aXRlLnRzIiwgImJpbi9saWIvZGV2b3BzLXByb2plY3QvZGV2b3BzLXByb2plY3QtcGF0aC50cyIsICJiaW4vbGliL2V4ZWMvZXhlYy1zY3JpcHQudHMiLCAiYmluL2NvbW1hbmRzL3N0b3J5Ym9vay50cyIsICJub2RlX21vZHVsZXMvaXMtZG9ja2VyL2luZGV4LmpzIiwgIm5vZGVfbW9kdWxlcy9pcy13c2wvaW5kZXguanMiLCAibm9kZV9tb2R1bGVzL2RlZmluZS1sYXp5LXByb3AvaW5kZXguanMiLCAibm9kZV9tb2R1bGVzL29wZW4vaW5kZXguanMiLCAiYmluL2xpYi9leGVjL2V4ZWMtc3luYy1yZXN1bHQudHMiLCAiYmluL2xpYi91dGlsL3RlbXBsYXRlLnRzIiwgImJpbi9jb21tYW5kcy91cmwudHMiLCAiYmluL2xpYi9naXQvZ2l0LWhhcy1jaGFuZ2VzLnRzIiwgImJpbi9saWIvZ2l0L2dpdC1yZXR1cm4tdG8tZGV2LnRzIiwgImJpbi9saWIvYnVpbGQvYmluL3JlbGVhc2UtYmluLnRzIiwgImJpbi9zaGltL3ZpdGUtcGx1Z2lucy92aXRlLWRldm9wcy1zdHJpbmctcmVwbGFjZS1wbHVnaW4udHMiLCAiYmluL3NoaW0vdml0ZS1wbHVnaW5zL3ZpdGUtZGV2b3BzLWFwcC1jb25maWctcGx1Z2luLnRzIiwgImJpbi9saWIvYnVpbGQvd2ViLWFwcC92aXRlL3JlbGVhc2UtY2xpZW50LnRzIiwgImJpbi9saWIvZXhlYy9leGVjLXNjcmlwdHgudHMiLCAiYmluL2xpYi9idWlsZC9saWJyYXJ5L3ZpdGUvcmVsZWFzZS1saWJyYXJ5LXR5cGVzLnRzIiwgImJpbi9saWIvdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtbmFtZS50cyIsICJiaW4vbGliL2J1aWxkL2xpYnJhcnkvdml0ZS9yZWxlYXNlLWxpYnJhcnkudHMiLCAiYmluL2xpYi9idWlsZC9saWJyYXJ5L3JlbGVhc2Utc3Rvcmllcy50cyIsICJiaW4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLWJ1aWxkLnRzIiwgImJpbi9jb21tYW5kcy9yZWxlYXNlL3JlbGVhc2Utdmlldy50cyIsICJiaW4vbGliL2dpdC9naXQtY2FuLWFjY2Vzcy1yZW1vdGUudHMiLCAiYmluL2xpYi9naXQvZ2l0LWVuc3VyZS1yZW1vdGUudHMiLCAiYmluL2xpYi9naXQvZ2l0LWN1cnJlbnQtYnJhbmNoLnRzIiwgImJpbi9saWIvZ2l0L2dpdC11cGRhdGUtYnJhbmNoLnRzIiwgImJpbi9saWIvdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtcmVwby50cyIsICJiaW4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLWRlcGxveS50cyIsICJiaW4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLXR5cGVzLnRzIiwgImJpbi9jb21tYW5kcy90cy50cyIsICJiaW4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLXN0YXJ0LXNlcnZlci50cyIsICJiaW4vY29tbWFuZHMvc3RhcnQudHMiLCAiYmluL2xpYi91bml0LXRlc3QvcnVuLXRlc3RzLnRzIiwgImJpbi9jb21tYW5kcy90ZXN0L3Rlc3QtcnVuLnRzIiwgImJpbi9jb21tYW5kcy9jbGVhbi9jbGVhbi1jYWNoZS50cyIsICJiaW4vbGliL3V0aWwvcGFja2FnZS1jYWNoZS1wYXRoLnRzIiwgImJpbi9jb21tYW5kcy9wci9wci1yZWxlYXNlLnRzIiwgImJpbi9tYWluLWdpbXAudHMiLCAiYmluL2xpYi91dGlsL2NvbmZpZy1lbnYudHMiLCAiYmluL2xpYi91dGlsL2RvdC1lbnYudHMiLCAiYmluL2xpYi91dGlsL3BhcnNlLXByb3BzLnRzIiwgImJpbi9saWIvdXRpbC9kb3QtZW52LnRzIiwgImJpbi9saWIvdXRpbC9jb25maWctZW52LnRzIiwgImJpbi9saWIvcHJvbXB0L3Byb21wdC1vdmVycmlkZS1maWxlLnRzIiwgImJpbi9saWIvdXRpbC9jb25maWctZW52LnRzIiwgImJpbi9tYWluLWdpbXAudHMiLCAiYmluL2NvbW1hbmRzL2Vuc3VyZS1kZXBlbmRlbmNpZXMudHMiLCAiYmluL2xpYi9leGVjL2V4ZWMtaW5zdGFsbC50cyIsICJiaW4vY29tbWFuZHMvZW5zdXJlLWRlcGVuZGVuY2llcy50cyIsICJiaW4vbGliL3V0aWwvZnV6enktc291cmNlLnRzIiwgImJpbi9jb21tYW5kcy9lbnN1cmUtZGVwZW5kZW5jaWVzLnRzIiwgImJpbi9saWIvdXRpbC9pcy1wYWNrYWdlLWF2YWlsYWJsZS50cyIsICJiaW4vY29tbWFuZHMvZW5zdXJlLWRlcGVuZGVuY2llcy50cyIsICJiaW4vbWFpbi1naW1wLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWwogICAgImV4cG9ydCBjb25zdCBjaGFsayA9IHtcbiAgY3lhbjogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbMzZtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgcmVkOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlszMW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICB5ZWxsb3c6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzMzbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGdyZWVuOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlszMm0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBibHVlOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlszNG0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBtYWdlbnRhOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlszNW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBjeWFuQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls5Nm0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICByZWRCcmlnaHQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzkxbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIHllbGxvd0JyaWdodDogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbOTNtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgZ3JlZW5CcmlnaHQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzkybSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJsdWVCcmlnaHQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzk0bSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIG1hZ2VudGFCcmlnaHQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzk1bSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIHdoaXRlQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls5N20ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBncmF5OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls5MG0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBncmV5OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls5MG0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICB3aGl0ZTogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbMzdtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgYmxhY2s6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzMwbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJsYWNrQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls5MG0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBiZ0N5YW46ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzQ2bSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJnUmVkOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls0MW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBiZ1llbGxvdzogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbNDNtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgYmdHcmVlbjogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbNDJtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgYmdCbHVlOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYls0NG0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBiZ01hZ2VudGE6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzQ1bSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJnQ3lhbkJyaWdodDogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbMTA2bSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJnUmVkQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlsxMDFtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgYmdZZWxsb3dCcmlnaHQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT4gYFxceDFiWzEwM20ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBiZ0dyZWVuQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlsxMDJtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgYmdCbHVlQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlsxMDRtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgYmdNYWdlbnRhQnJpZ2h0OiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlsxMDVtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgY3lhbkJyaWdodEJvbGQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT5cbiAgICBgXFx4MWJbOTZtXFx4MWJbMW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICByZWRCcmlnaHRCb2xkOiAoLi4udGV4dDogc3RyaW5nW10pID0+XG4gICAgYFxceDFiWzkxbVxceDFiWzFtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgeWVsbG93QnJpZ2h0Qm9sZDogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PlxuICAgIGBcXHgxYls5M21cXHgxYlsxbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGdyZWVuQnJpZ2h0Qm9sZDogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PlxuICAgIGBcXHgxYls5Mm1cXHgxYlsxbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJsdWVCcmlnaHRCb2xkOiAoLi4udGV4dDogc3RyaW5nW10pID0+XG4gICAgYFxceDFiWzk0bVxceDFiWzFtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgbWFnZW50YUJyaWdodEJvbGQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT5cbiAgICBgXFx4MWJbOTVtXFx4MWJbMW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICB3aGl0ZUJyaWdodEJvbGQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT5cbiAgICBgXFx4MWJbOTdtXFx4MWJbMW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBncmF5QnJpZ2h0Qm9sZDogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PlxuICAgIGBcXHgxYls5MG1cXHgxYlsxbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGdyZXlCcmlnaHRCb2xkOiAoLi4udGV4dDogc3RyaW5nW10pID0+XG4gICAgYFxceDFiWzkwbVxceDFiWzFtJHt0ZXh0LmpvaW4oXCIgXCIpfVxceDFiWzBtYCxcbiAgd2hpdGVCb2xkOiAoLi4udGV4dDogc3RyaW5nW10pID0+IGBcXHgxYlszN21cXHgxYlsxbSR7dGV4dC5qb2luKFwiIFwiKX1cXHgxYlswbWAsXG4gIGJsYWNrQm9sZDogKC4uLnRleHQ6IHN0cmluZ1tdKSA9PiBgXFx4MWJbMzBtXFx4MWJbMW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxuICBibGFja0JyaWdodEJvbGQ6ICguLi50ZXh0OiBzdHJpbmdbXSkgPT5cbiAgICBgXFx4MWJbOTBtXFx4MWJbMW0ke3RleHQuam9pbihcIiBcIil9XFx4MWJbMG1gLFxufTtcbiIsCiAgImltcG9ydCB7IHN0cmlwSW5kZW50IH0gZnJvbSBcImNvbW1vbi10YWdzXCI7XG5cbi8qKlxuICogVGFnZ2VkIHRlbXBsYXRlIGxpdGVyYWwgdGhhdCBmb3JtYXRzIGEgc3RyaW5nIHRvIGJlIHN0YW5kYXJkaXplZCBhbmRcbiAqIGFwcHJvcHJpYXRlIGZvciBjb21tYW5kZXIgZGVzY3JpcHRpb25zLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVzY3JpcHRpb24oc3RyOiBUZW1wbGF0ZVN0cmluZ3NBcnJheSwgLi4uYXJnczogYW55W10pIHtcbiAgcmV0dXJuIGAke3N0cmlwSW5kZW50KHN0ciwgLi4uYXJncyl9XFxuXFxuYDtcbn1cbiIsCiAgIi8qKlxuICogSW50ZXJmYWNlIGZvciBkZWNsYXJpbmcgYSBnZW5lcmljIEpTT04gdmFsaWQgb2JqZWN0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUpzb24ge1xuICBbeDogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IERhdGUgfCBJSnNvbiB8IElKc29uQXJyYXk7XG59XG5cbi8qKlxuICogSW50ZXJmYWNlIGZvciBkZWNsYXJpbmcgYSBnZW5lcmljIEpTT04gdmFsaWQgb2JqZWN0XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSUpzb25UeXBlIHtcbiAgW3g6IHN0cmluZ106XG4gICAgfCBzdHJpbmdcbiAgICB8IG51bWJlclxuICAgIHwgYm9vbGVhblxuICAgIHwgRGF0ZVxuICAgIHwgSUpzb25UeXBlXG4gICAgfCBJSnNvbkFycmF5XG4gICAgfCB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogUGFydCBvZiB0aGUgSUpzb24gZGVjbGFyYXRpb24gdG8gbWFrZSBhIHZhbGlkIEpTT04gdHlwZS5cbiAqL1xuZXhwb3J0IHR5cGUgSUpzb25BcnJheSA9IChcbiAgfCBzdHJpbmdcbiAgfCBudW1iZXJcbiAgfCBib29sZWFuXG4gIHwgRGF0ZVxuICB8IElKc29uXG4gIHwgSUpzb25BcnJheVxuKVtdO1xuXG4vKipcbiAqIFRoaXMgaXMgdG8gaGVscCBlc3RhYmxpc2ggYSBjdXN0b20gY2hpbGQgcGF0dGVybiBmb3IgUmVhY3QuIFRoZSBwcm9wcyBmb3IgeW91ciByZWFjdCBjb21wb25lbnQgc2ltcGx5IG5lZWRzIHRvIGV4dGVuZFxuICogdGhpcyBpbnRlcmZhY2UuXG4gKi9cbmV4cG9ydCB0eXBlIElDaGlsZHJlbjxUIGV4dGVuZHMgb2JqZWN0PiA9IFQgJiB7XG4gIGNoaWxkcmVuPzogUGFydGlhbDxUPjtcbn07XG5cbi8qKlxuICogVGhpcyBsZXRzIHlvdSBkZWZpbmUgY2hpbGRyZW4gZm9yIGEgY29tcG9uZW50IGFuZCBmb3JjZXMgdGhlIGNoaWxkcmVuIHRvIGJlIGRlY2xhcmVkIGluIHRoZSBwcm9wcyBhcyBvcHBvc2VkIHRvXG4gKiBuZXN0aW5nIHRoZSBjaGlsZHJlbi5cbiAqL1xuZXhwb3J0IHR5cGUgSVByb3BzQ2hpbGRyZW48VCBleHRlbmRzIG9iamVjdD4gPSBUICYge1xuICBjaGlsZHJlbjogbmV2ZXI7XG59O1xuXG4vKipcbiAqIFRoaXMgbGV0cyB5b3UgZGVmaW5lIGNoaWxkcmVuIGZvciBhIGNvbXBvbmVudCBhbmQgZm9yY2VzIHRoZSBjaGlsZHJlbiB0byBiZSBuZXN0ZWQgYXMgb3Bwb3NlZCB0b1xuICogYmVpbmcgZGVjbGFyZWQgaW4gdGhlIHByb3BzLlxuICovXG5leHBvcnQgdHlwZSBJTmVzdGVkQ2hpbGRyZW48VD4gPSB7XG4gIGNoaWxkcmVuPzogVDtcbn07XG5cbi8qKlxuICogQSBzbGlnaHRseSBzdHJvbmdlciB0eXBlIGZvciBmb3IgaW5kaWNhdGluZyBcIkZ1bmN0aW9uXCIuIFRoaXMgaGFzIGdyZWF0ZXJcbiAqIGZsZXhpYmlsaXR5IHRvIGZpdCBpbnRvIGdlbmVyaWMgY2FsbGJhY2tzLlxuICovXG5leHBvcnQgdHlwZSBHZW5lcmljRnVuY3Rpb248VD4gPSAoLi4uYXJnczogYW55W10pID0+IFQ7XG5cbi8qKlxuICogVGhpcyB0eXBlIGlzIGludGVuZGVkIGZvciB0aGUgYXN5bmMgb3BlcmF0aW9uIG9mIGEgXCJmbG93XCIuIEEgZmxvdyBjYW4gaGF2ZVxuICogc2V2ZXJhbCB5aWVsZCBzdGF0ZW1lbnRzLCBidXQgYXJlIE5PVCBmb3IgdGhlIGludGVudGlvbiBvZiByZXR1cm5pbmcgdmFsdWVzXG4gKiB0byB0aGUgY2FsbGVyLCBidXQgcmF0aGVyIGZvciB0aGUgaW50ZW50IG9mIHBlcmZvcm1pbmcgYSBtb2J4IGFjdGlvbiB0aGF0IGhhc1xuICogYXN5bmNocm9ub3VzIHByb3BlcnRpZXMuXG4gKi9cbmV4cG9ydCB0eXBlIEZsb3dUeXBlID0gR2VuZXJhdG9yPHVua25vd24sIHVua25vd24sIHVua25vd24+IHwgdW5kZWZpbmVkO1xuXG4vKipcbiAqIFR5cGVndWFyZCBmb3Igc3RyaW5nc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNTdHJpbmcodmFsOiBhbnkpOiB2YWwgaXMgc3RyaW5nIHtcbiAgcmV0dXJuIHZhbCAmJiB2YWwuY2hhckNvZGVBdCAhPT0gdm9pZCAwO1xufVxuXG4vKipcbiAqIFR5cGVndWFyZCBmb3IgbnVtYmVyc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNOdW1iZXIodmFsOiBhbnkpOiB2YWwgaXMgbnVtYmVyIHtcbiAgcmV0dXJuIHZhbCAhPT0gdm9pZCAwICYmIHZhbC50b0V4cG9uZW50aWFsO1xufVxuXG4vKipcbiAqIFR5cGVndWFyZCBmb3IgZnVuY3Rpb25zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbDogYW55KTogdmFsIGlzIEZ1bmN0aW9uIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWwgPT09IFwiZnVuY3Rpb25cIjtcbn1cblxuLyoqXG4gKiBUeXBlZ2F1cmQgZm9yIGVuc3VyaW5nIGFuIGVsZW1lbnQgaXMgbm9uLW51bGwgYW5kIG5vdCB1bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0RlZmluZWQ8VD4odmFsOiBUIHwgdW5kZWZpbmVkIHwgbnVsbCk6IHZhbCBpcyBUIHtcbiAgcmV0dXJuIHZhbCAhPT0gdm9pZCAwICYmIHZhbCAhPT0gbnVsbDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgaWYgaVxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNUcnV0aHk8VD4odmFsOiBUIHwgbnVsbCB8IHVuZGVmaW5lZCB8IGZhbHNlKTogdmFsIGlzIFQge1xuICByZXR1cm4gQm9vbGVhbih2YWwpO1xufVxuIiwKICAiaW1wb3J0IGlucXVpcmVyIGZyb20gXCJpbnF1aXJlclwiO1xuaW1wb3J0IHsgc3RyaXBJbmRlbnQgfSBmcm9tIFwiY29tbW9uLXRhZ3NcIjtcblxuLyoqXG4gKiBDb252ZW5pZW5jZSB3cmFwcGVyIGFyb3VuZCBjdXJyZW50IHByb21wdCBsaWJyYXJ5IG9mIGNob2ljZSB0byBwcmVzZW50IGFcbiAqIGNvbmZpcm1hdGlvbiBkaWFsb2cuXG4gKlxuICogQXBwbGllcyBzdHJpcEluZGVudCB0byB0aGUgaW5wdXQgbWVzc2FnZS5cbiAqXG4gKiBSZXR1cm5zIHRoZSB0cnVlIGZhbHNlIHZhbHVlIG9mIHRoZSBwcm9tcHQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9tcHRDb25maXJtKFxuICBtZXNzYWdlOiBzdHJpbmcsXG4gIGRlZmF1bHRWYWx1ZT86IGJvb2xlYW4sXG4gIG9uQ29uZmlybWVkPzogKCkgPT4gdm9pZFxuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IHsgcmVzdWx0IH0gPSBhd2FpdCBpbnF1aXJlci5wcm9tcHQ8e1xuICAgIHJlc3VsdDogYm9vbGVhbjtcbiAgfT4oW1xuICAgIHtcbiAgICAgIHR5cGU6IFwiY29uZmlybVwiLFxuICAgICAgbmFtZTogXCJyZXN1bHRcIixcbiAgICAgIG1lc3NhZ2U6IHN0cmlwSW5kZW50YCR7bWVzc2FnZX1gLFxuICAgICAgZGVmYXVsdDogZGVmYXVsdFZhbHVlLFxuICAgIH0sXG4gIF0pO1xuXG4gIC8vIFdoZW4geWVzL3RydWUgaXMgc2VsZWN0ZWQsIHJ1biB0aGUgb25Db25maXJtZWQgY2FsbGJhY2tcbiAgaWYgKHJlc3VsdCkgb25Db25maXJtZWQ/LigpO1xuXG4gIHJldHVybiByZXN1bHQ7XG59XG4iLAogICJpbXBvcnQgY2hpbGRfcHJvY2VzcyBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuXG5mdW5jdGlvbiBpc0RlZmluZWQ8VD4odmFsOiBhbnkpOiB2YWwgaXMgVCB7XG4gIHJldHVybiB2YWwgIT09IHZvaWQgMCAmJiB2YWwgIT09IG51bGw7XG59XG5cbi8qKlxuICogVHlwZSBndWFyZCBmb3IgZXJyb3JzIHRocm93biBmcm9tIHRoZSBjaGlsZF9wcm9jZXNzLmV4ZWNGaWxlU3luYyBtZXRob2QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0NoaWxkUHJvY2Vzc0Vycm9yKFxuICB2YWw6IGFueVxuKTogdmFsIGlzIGNoaWxkX3Byb2Nlc3MuU3Bhd25TeW5jUmV0dXJuczxCdWZmZXI+IHtcbiAgcmV0dXJuIChcbiAgICBpc0RlZmluZWQ8YW55Pih2YWwpICYmXG4gICAgaXNEZWZpbmVkPGFueT4odmFsLnN0YXR1cykgJiZcbiAgICBpc0RlZmluZWQ8YW55Pih2YWwuc3RkZXJyKVxuICApO1xufVxuIiwKICAiaW1wb3J0IHsgaXNDaGlsZFByb2Nlc3NFcnJvciB9IGZyb20gXCIuLi91dGlsL2lzLWNoaWxkLXByb2Nlc3MtZXJyb3IuanNcIjtcbmltcG9ydCB7IGlzRGVmaW5lZCB9IGZyb20gXCIuLi91dGlsL3R5cGVzLmpzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUV4ZWNTeW5jIHtcbiAgLyoqIFNldCB0byB0cnVlIHRvIHByZXZlbnQgZXJyb3IgbG9ncyAqL1xuICBzaWxlbnQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIEV4ZWN1dGVzIGEgY29tbWFuZCBvbiB0aGUgc2FtZSBzdGRpbyBhcyB0aGUgY3VycmVudCBwcm9jZXNzLiBUaGlzIGFic29yYnNcbiAqIGVycm9ycyBhbmQgYWxzbyBpZ25vcmVzIG51bGwvdW5kZWZpbmVkIGFyZ3VtZW50cy5cbiAqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGNvbW1hbmQgc3VjY2VlZGVkLlxuICovXG5hc3luYyBmdW5jdGlvbiBydW4oY29tbWFuZDogc3RyaW5nLCBhcmdzOiAoc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZClbXSA9IFtdKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gQnVuLnNwYXduU3luYyhbY29tbWFuZCwgLi4uYXJncy5maWx0ZXIoaXNEZWZpbmVkKV0sIHtcbiAgICAgIHN0ZGlvOiBbXCJpbmhlcml0XCIsIFwiaW5oZXJpdFwiLCBcImluaGVyaXRcIl0sXG4gICAgICBlbnY6IHByb2Nlc3MuZW52LFxuICAgIH0pO1xuXG4gICAgaWYgKHJlc3VsdC5leGl0Q29kZSAhPT0gMCkge1xuICAgICAgaWYgKCFydW4uc2lsZW50KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgYEVycm9yOiAke2NvbW1hbmR9ICR7YXJncy5qb2luKFwiIFwiKX0gZmFpbGVkIHdpdGggY29kZTogJHtcbiAgICAgICAgICAgIHJlc3VsdC5leGl0Q29kZVxuICAgICAgICAgIH1gXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IobmV3IEVycm9yKCkuc3RhY2spO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgaWYgKCFydW4uc2lsZW50KSB7XG4gICAgICBpZiAoaXNDaGlsZFByb2Nlc3NFcnJvcihlcnIpKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgYEVycm9yOiAke2NvbW1hbmR9ICR7YXJncy5qb2luKFwiIFwiKX0gZmFpbGVkIHdpdGggY29kZTogJHtlcnIuc3RhdHVzfWBcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIubWVzc2FnZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUuZXJyb3IobmV3IEVycm9yKCkuc3RhY2spO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG4vLyBEZWZhdWx0IHRoZSBleGVjdXRpb24gc3R5bGUuXG5ydW4uc2lsZW50ID0gZmFsc2U7XG5cbmV4cG9ydCBjb25zdCBleGVjU3luYzogdHlwZW9mIHJ1biAmIElFeGVjU3luYyA9IHJ1bjtcbiIsCiAgImltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSBcIi4vZXhlYy1zeW5jLmpzXCI7XG5cbmxldCBtZW1vaXplZDogW1wiYnVuXCIsIFwiYnVueFwiXSB8IFtcIm5wbVwiLCBcIm5weFwiXSB8IG51bGwgPSBudWxsO1xuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY29ycmVjdCBhbmQgbW9zdCBpZGVhbCBwYWNrYWdlIG1hbmFnZXIgdG8gdXNlIGZvciBhIGNvbW1hbmQuXG4gKiBGaXJzdCB2YWx1ZSB3aWxsIGJlIHRoZSBwYWNrYWdlIG1hbmFnZXIgY29tbWFuZCwgdGhlIHNlY29uZCB3aWxsIGJlIHRoZSBhdXRvXG4gKiBleGVjdXRpb24gbWFuYWdlciBvZiB0aGF0IG1hbmFnZXIgaWUgLSBbbnBtLCBucHhdXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQYWNrYWdlTWFuYWdlcigpIHtcbiAgaWYgKG1lbW9pemVkKSByZXR1cm4gbWVtb2l6ZWQ7XG5cbiAgaWYgKGF3YWl0IGV4ZWNTeW5jKFwiYnVuXCIsIFtcIi0tdmVyc2lvblwiXSkpIHtcbiAgICBtZW1vaXplZCA9IFtcImJ1blwiLCBcImJ1bnhcIl07XG4gIH0gZWxzZSB7XG4gICAgbWVtb2l6ZWQgPSBbXCJucG1cIiwgXCJucHhcIl07XG4gIH1cblxuICByZXR1cm4gbWVtb2l6ZWQ7XG59XG4iLAogICIvKipcbiAqIEEgc2ltcGxlIHdhaXQgbWV0aG9kIGZvciBhIGR1cmF0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3YWl0KHQ6IG51bWJlcikge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocikgPT4gc2V0VGltZW91dChyLCB0KSk7XG59XG4iLAogICJpbXBvcnQgKiBhcyBWaXRlIGZyb20gXCJ2aXRlXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vdXRpbC9jaGFsay5qc1wiO1xuXG4vKipcbiAqIEdlbmVyYXRlcyBhIHZpdGUgY29uZmlnIHN1aXRhYmxlIGZvciBydW5uaW5nIGEgVml0ZS5idWlsZCBvcGVyYXRpb24uIFRoZVxuICogdmFyaW91cyBhdmFpbGFibGUgdGFyZ2V0cyBtb2RpZmllcyB0aGUgYmVoYXZpb3IgdG8gdGFyZ2V0IGRpZmZlcmVudCBmb2xkZXJzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGRWaXRlQ29uZmlnKCkge1xuICBjb25zb2xlLndhcm4oXG4gICAgXCJCdWlsZGluZyBWaXRlIGNvbmZpZyB1c2luZyBiYXNlOlwiLFxuICAgIGNoYWxrLnllbGxvd0JyaWdodEJvbGQocGF0aC5yZXNvbHZlKFwidml0ZS5jb25maWcudHNcIikpXG4gICk7XG4gIC8vIFN0YXJ0IHdpdGggdGhlIHRhcmdldCBwcm9qZWN0IGRlZmluZWQgY29uZmlndXJhdGlvblxuICBsZXQgY29uZmlnOiBWaXRlLlVzZXJDb25maWcgPSBhd2FpdCAoXG4gICAgYXdhaXQgaW1wb3J0KHBhdGgucmVzb2x2ZShcInZpdGUuY29uZmlnLnRzXCIpKVxuICApLmRlZmF1bHQoKTtcblxuICAvLyBJbXBvcnQgdGhlIHRhcmdldCBwcm9qZWN0J3MgdHNjb25maWcgc28gd2UgY2FuIGluY2x1ZGUgdGhlIHNhbWUgaW5jbHVzaW9uc1xuICAvLyB0aGUgVFMgY29tcGlsZXIgd291bGQgdXNlIGZvciB0aGUgd2F0Y2ggcHJvY2Vzcy5cbiAgY29uc3QgdHNjb25maWcgPSBhd2FpdCBmcy5yZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwidHNjb25maWcuanNvblwiKSk7XG5cbiAgY29uZmlnID0ge1xuICAgIC4uLmNvbmZpZyxcbiAgICBsb2dMZXZlbDogXCJpbmZvXCIsXG4gICAgbW9kZTogXCJkZXZlbG9wbWVudFwiLFxuICAgIHJvb3Q6IHBhdGgucmVzb2x2ZShcImFwcC9jbGllbnRcIiksXG4gICAgY2xlYXJTY3JlZW46IHRydWUsXG4gICAgYnVpbGQ6IHtcbiAgICAgIC4uLmNvbmZpZy5idWlsZCxcbiAgICAgIGNzc0NvZGVTcGxpdDogdHJ1ZSxcbiAgICAgIG91dERpcjogcGF0aC5yZXNvbHZlKFwiYnVpbGQvY2xpZW50XCIpLFxuICAgICAgc291cmNlbWFwOiB0cnVlLFxuICAgICAgcm9sbHVwT3B0aW9uczoge1xuICAgICAgICBvdXRwdXQ6IHtcbiAgICAgICAgICBtYW51YWxDaHVua3M6IHVuZGVmaW5lZCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB3YXRjaDoge1xuICAgICAgICAuLi5jb25maWcuYnVpbGQ/LndhdGNoLFxuICAgICAgICBpbmNsdWRlOiBbXG4gICAgICAgICAgLi4uKChBcnJheS5pc0FycmF5KGNvbmZpZy5idWlsZD8ud2F0Y2g/LmluY2x1ZGUpXG4gICAgICAgICAgICA/IGNvbmZpZy5idWlsZD8ud2F0Y2g/LmluY2x1ZGVcbiAgICAgICAgICAgIDogW2NvbmZpZy5idWlsZD8ud2F0Y2g/LmluY2x1ZGVdKSB8fCBbXSksXG4gICAgICAgICAgLi4uKHRzY29uZmlnPy5pbmNsdWRlPy5tYXAoKGk6IHN0cmluZykgPT4gcGF0aC5yZXNvbHZlKGkpKSB8fCBbXSksXG4gICAgICAgICAgXCJ0c2NvbmZpZy5qc29uXCIsXG4gICAgICAgIF0uZmlsdGVyKEJvb2xlYW4pLFxuICAgICAgfSxcbiAgICAgIGVtcHR5T3V0RGlyOiB0cnVlLFxuICAgIH0sXG4gICAgcmVzb2x2ZToge1xuICAgICAgYWxpYXM6IHtcbiAgICAgICAgY29uZmlnOiBwYXRoLnJlc29sdmUoYGFwcC9jb25maWdgKSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfTtcblxuICByZXR1cm4gY29uZmlnO1xufVxuIiwKICAiaW1wb3J0IGRlZXBtZXJnZSBmcm9tIFwiZGVlcG1lcmdlXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGFyZ2V0UHJvamVjdERlcGVuZGVuY2llcygpIHtcbiAgY29uc3QgcGFja2FnZUpzb24gPSBmcy5yZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKTtcblxuICByZXR1cm4gZGVlcG1lcmdlPFJlY29yZDxzdHJpbmcsIHN0cmluZz4+KFxuICAgIHBhY2thZ2VKc29uLmRlcGVuZGVuY2llcyB8fCB7fSxcbiAgICBwYWNrYWdlSnNvbi5wZWVyRGVwZW5kZW5jaWVzIHx8IHt9XG4gICk7XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGFyZ2V0UHJvamVjdFZlcnNpb24oKSB7XG4gIGNvbnN0IHBhY2thZ2VKc29uID0gZnMucmVhZEpTT05TeW5jKHBhdGgucmVzb2x2ZShcInBhY2thZ2UuanNvblwiKSk7XG4gIHJldHVybiBwYWNrYWdlSnNvbi52ZXJzaW9uIHx8IFwiXCI7XG59XG4iLAogICJpbXBvcnQgKiBhcyBWaXRlIGZyb20gXCJ2aXRlXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgYnVpbGRWaXRlQ29uZmlnIH0gZnJvbSBcIi4uLy4uL2J1aWxkLXZpdGUtY29uZmlnLmpzXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuLi8uLi8uLi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyB0YXJnZXRQcm9qZWN0RGVwZW5kZW5jaWVzIH0gZnJvbSBcIi4uLy4uLy4uL3RhcmdldC1wcm9qZWN0L3RhcmdldC1wcm9qZWN0LWRlcGVuZGVuY2llcy5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdFZlcnNpb24gfSBmcm9tIFwiLi4vLi4vLi4vdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuXG4vKipcbiAqIFRoaXMgcGVyZm9ybXMgdGhlIGJ1bmRsaW5nIHByb2Nlc3MgZm9yIGRpc3RyaWJ1dGlvbi5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKCkge1xuICBwcm9jZXNzLmVudi5WSVRFX1JFTEVBU0VfVkVSU0lPTiA9XG4gICAgcHJvY2Vzcy5lbnYuVklURV9SRUxFQVNFX1ZFUlNJT04gfHwgKGF3YWl0IHRhcmdldFByb2plY3RWZXJzaW9uKCkpO1xuXG4gIGNvbnNvbGUud2FybihjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiU3RhcnRpbmcgVml0ZSBjbGllbnQgYnVpbGQuLi5cIikpO1xuICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwiYXBwL2NsaWVudC9pbmRleC50c1wiKSkpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBcIlRyaWVkIHRvIHN0YXJ0IGRldmVsb3BtZW50IHByb2Nlc3MgZm9yIHRoZSBhcHAgY2xpZW50LCBidXQgbm8gZW50cnkgZmlsZSB3YXMgZm91bmQuXCJcbiAgICApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGNvbmZpZyA9IGF3YWl0IGJ1aWxkVml0ZUNvbmZpZygpO1xuXG4gIGNvbmZpZy5yb290ID0gcGF0aC5yZXNvbHZlKFwiYXBwL2NsaWVudFwiKTtcbiAgY29uZmlnLmJ1aWxkIS5vdXREaXIgPSBwYXRoLnJlc29sdmUoXCJidWlsZC9jbGllbnRcIik7XG5cbiAgY29uZmlnLmJ1aWxkIS5yb2xsdXBPcHRpb25zIS5leHRlcm5hbCA9IE9iamVjdC5rZXlzKFxuICAgIGF3YWl0IHRhcmdldFByb2plY3REZXBlbmRlbmNpZXMoKVxuICApO1xuXG4gIGF3YWl0IFZpdGUuYnVpbGQoY29uZmlnKTtcbiAgY29uc29sZS53YXJuKGNoYWxrLnllbGxvd0JyaWdodEJvbGQoXCJWaXRlIGNsaWVudCBidWlsZCBwcm9jZXNzIHN0YXJ0ZWQuLi5cIikpO1xufVxuIiwKICAiLyoqXG4gKiBMaXN0ZW5zIGZvciBwcm9jZXNzIGV4aXQgc2lnbmFscyBvZiB2YXJpb3VzIHR5cGVzIGFuZCBmaXJlcyB0aGUgcHJvdmlkZWRcbiAqIGNhbGxiYWNrIHdoZW4gaXQgaGFwcGVucyB3aXRoIHNvbWUgZWFzeSB0byBoYW5kbGUgZGV0YWlscy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVByb2Nlc3NFeGl0KFxuICBjYjogKG1lc3NhZ2U6IHN0cmluZywgZXJyPzogRXJyb3IgfCBzdHJpbmcgfCBudW1iZXIpID0+IFByb21pc2U8dm9pZD5cbikge1xuICBjb25zdCBoYW5kbGVFeGl0ID0gKG1lc3NhZ2U6IHN0cmluZykgPT4gKGVycj86IEVycm9yIHwgc3RyaW5nIHwgbnVtYmVyKSA9PiB7XG4gICAgY2IobWVzc2FnZSwgZXJyKTtcbiAgICBpZiAoZXJyKSBwcm9jZXNzLmV4aXQoMSk7XG4gICAgZWxzZSBwcm9jZXNzLmV4aXQoMCk7XG4gIH07XG5cbiAgLy8gQ2F0Y2ggd2hlbiBhcHAgaXMgY2xvc2luZ1xuICBwcm9jZXNzLm9uKFwiZXhpdFwiLCBoYW5kbGVFeGl0KFwiZXhpdFwiKSk7XG4gIC8vIENhdGNoIGN0cmwrYyBldmVudFxuICBwcm9jZXNzLm9uKFwiU0lHSU5UXCIsIGhhbmRsZUV4aXQoXCJTSUdJTlRcIikpO1xuICAvLyBDYXRjaCBcImtpbGwgcGlkXCIgKGZvciBleGFtcGxlOiBub2RlbW9uIHJlc3RhcnQpXG4gIHByb2Nlc3Mub24oXCJTSUdVU1IxXCIsIGhhbmRsZUV4aXQoXCJTSUdVU1IxXCIpKTtcbiAgcHJvY2Vzcy5vbihcIlNJR1VTUjJcIiwgaGFuZGxlRXhpdChcIlNJR1VTUjJcIikpO1xuICBwcm9jZXNzLm9uKFwiU0lHVEVSTVwiLCBoYW5kbGVFeGl0KFwiU0lHVEVSTVwiKSk7XG4gIC8vIENhdGNoIHVuY2F1Z2h0IGV4Y2VwdGlvbnNcbiAgcHJvY2Vzcy5vbihcInVuY2F1Z2h0RXhjZXB0aW9uXCIsIGhhbmRsZUV4aXQoXCJ1bmNhdWdodEV4Y2VwdGlvblwiKSk7XG59XG4iLAogICJjb25zdCBxdWV1ZTogYW55W11bXSA9IFtdO1xubGV0IHF1ZXVlSWQ6IFRpbWVyIHwgbnVsbCA9IG51bGw7XG5cbmZ1bmN0aW9uIHN0YXJ0UXVldWUoKSB7XG4gIGlmIChxdWV1ZUlkICE9PSBudWxsKSByZXR1cm47XG5cbiAgcXVldWVJZCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgbWVzc2FnZSA9IHF1ZXVlLnNoaWZ0KCk7XG4gICAgICBpZiAobWVzc2FnZSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICBjb25zb2xlLmxvZyguLi5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIDQwMCk7XG59XG5cbi8qKlxuICogVGhpcyBpcyBhIHNpbXBsZSBxdWV1ZSBmb3IgbG9nZ2luZyBtZXNzYWdlcyBhdCBnaXZlbiBpbnRlcnZhbHMgd2hpY2ggcHJldmVudHNcbiAqIHNvbWUgbG9nZ2luZyBpbmZpZ2h0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2dRdWV1ZSguLi5tZXNzYWdlOiBhbnlbXSkge1xuICBxdWV1ZS5wdXNoKG1lc3NhZ2UpO1xuICBzdGFydFF1ZXVlKCk7XG59XG4iLAogICJpbXBvcnQgYnVpbGRDbGllbnQgZnJvbSBcIi4vYnVpbGQtY2xpZW50LmpzXCI7XG5pbXBvcnQgY2hpbGRfcHJvY2VzcyBmcm9tIFwiY2hpbGRfcHJvY2Vzc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCByZWFkbGluZSBmcm9tIFwicmVhZGxpbmVcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4uLy4uLy4uL3V0aWwvY2hhbGsuanNcIjtcbmltcG9ydCB7IGdldFBhY2thZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uLy4uLy4uL2V4ZWMvZ2V0LXBhY2thZ2UtbWFuYWdlci5qc1wiO1xuaW1wb3J0IHsgaGFuZGxlUHJvY2Vzc0V4aXQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbC9oYW5kbGUtcHJvY2Vzcy1leGl0LmpzXCI7XG5pbXBvcnQgeyBsb2dRdWV1ZSB9IGZyb20gXCIuLi8uLi8uLi91dGlsL2xvZy1xdWV1ZS5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdFZlcnNpb24gfSBmcm9tIFwiLi4vLi4vLi4vdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuXG4vKipcbiAqIEVudHJ5IG1ldGhvZCBmb3IgdGhlIGFwcCBkZXYgc2VydmVyXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIHJ1bihcbiAgbGlzdGVuZXI/OiAoY2hpbGQ6IGNoaWxkX3Byb2Nlc3MuQ2hpbGRQcm9jZXNzV2l0aG91dE51bGxTdHJlYW1zKSA9PiB2b2lkXG4pIHtcbiAgY29uc29sZS53YXJuKFxuICAgIFwiXFxuUnVubmluZyB0aGUgQXBwIHNlcnZlciBhdDogXCIsXG4gICAgY2hhbGsueWVsbG93QnJpZ2h0Qm9sZChwYXRoLnJlc29sdmUoXCJhcHAvc2VydmVyXCIpKSxcbiAgICBcIlxcblwiXG4gICk7XG5cbiAgcHJvY2Vzcy5lbnYuVklURV9SRUxFQVNFX1ZFUlNJT04gPVxuICAgIHByb2Nlc3MuZW52LlZJVEVfUkVMRUFTRV9WRVJTSU9OIHx8IChhd2FpdCB0YXJnZXRQcm9qZWN0VmVyc2lvbigpKTtcbiAgcHJvY2Vzcy5lbnYuUkVTT1VSQ0VfUEFUSCA9XG4gICAgcHJvY2Vzcy5lbnYuUkVTT1VSQ0VfUEFUSCB8fCBwYXRoLnJlc29sdmUoXCJidWlsZC9jbGllbnRcIik7XG4gIGNvbnN0IHBhY2thZ2VNYW5hZ2VyID0gYXdhaXQgZ2V0UGFja2FnZU1hbmFnZXIoKTtcblxuICBpZiAocGFja2FnZU1hbmFnZXJbMF0gIT09IFwiYnVuXCIpIHtcbiAgICBjb25zb2xlLmVycm9yKFxuICAgICAgXCJDdXJyZW50bHkgb25seSBhbiBlbnZpcm9ubWVudCB3aXRoIGJ1biBpbnN0YWxsZWQgaXMgc3VwcG9ydGVkIGZvciB0aGlzIGNvbW1hbmQuXCJcbiAgICApO1xuICB9XG5cbiAgY29uc3QgY2hpbGRQcm9jZXNzID0gY2hpbGRfcHJvY2Vzcy5zcGF3bihwYWNrYWdlTWFuYWdlclswXSwgW1xuICAgIFwiLS13YXRjaFwiLFxuICAgIHBhdGgucmVzb2x2ZShcImFwcC9zZXJ2ZXIvaW5kZXgudHNcIiksXG4gIF0pO1xuXG4gIC8vIExpc3RlbiBmb3IgdGhlIGIga2V5IHRvIGJlIHByZXNzZWQuIFRoaXMgc2hvdWxkIHRyaWdnZXIgYSBkZW1vIGJ1aWxkIG9mIHRoZVxuICAvLyBhcHAgYW5kIG91dHB1dCB0byB0aGUgYnVpbGQgZm9sZGVyLiBUaGlzIGlzIG1lYW50IGZvciB0ZXN0aW5nIHRoZSBidWlsZCBhbmRcbiAgLy8gbm90aGluZyBlbHNlLlxuICBwcm9jZXNzLnN0ZGluLnNldFJhd01vZGU/Lih0cnVlKTtcbiAgcHJvY2Vzcy5zdGRpbi5yZXN1bWUoKTtcbiAgcHJvY2Vzcy5zdGRpbi5zZXRFbmNvZGluZyhcInV0ZjhcIik7XG4gIHJlYWRsaW5lLmVtaXRLZXlwcmVzc0V2ZW50cyhwcm9jZXNzLnN0ZGluKTtcbiAgbGV0IGJ1aWxkaW5nID0gZmFsc2U7XG5cbiAgcHJvY2Vzcy5zdGRpbi5vbihcImtleXByZXNzXCIsIGFzeW5jIChjaHVuaywga2V5KSA9PiB7XG4gICAgaWYgKGtleSAmJiBrZXkuY3RybCAmJiBrZXkubmFtZSA9PT0gXCJjXCIpIHtcbiAgICAgIGNoaWxkUHJvY2Vzcy5raWxsKCk7XG4gICAgICBwcm9jZXNzLmV4aXQoMCk7XG4gICAgfSBlbHNlIGlmIChrZXkgJiYga2V5LmN0cmwgJiYga2V5Lm5hbWUgPT09IFwiZFwiKSB7XG4gICAgICBjaGlsZFByb2Nlc3Mua2lsbCgpO1xuICAgICAgcHJvY2Vzcy5leGl0KDApO1xuICAgIH0gZWxzZSBpZiAoY2h1bmsudG9TdHJpbmcoKSA9PT0gXCJiXCIgfHwgY2h1bmsudG9TdHJpbmcoKSA9PT0gXCJCXCIpIHtcbiAgICAgIGlmIChidWlsZGluZykgcmV0dXJuO1xuICAgICAgYnVpbGRpbmcgPSB0cnVlO1xuICAgICAgYXdhaXQgYnVpbGRDbGllbnQoKTtcbiAgICAgIGJ1aWxkaW5nID0gZmFsc2U7XG4gICAgfSBlbHNlIGlmIChjaHVuay50b1N0cmluZygpID09PSBcInFcIiB8fCBjaHVuay50b1N0cmluZygpID09PSBcIlFcIikge1xuICAgICAgY2hpbGRQcm9jZXNzLmtpbGwoKTtcblxuICAgICAgLy8gU3BlY2lhbCBxdWl0IGNvZGUgdG8gaW5kaWNhdGUgd2Ugd2FudCBhIHNwZWNpYWwgc2h1dGRvd24gcm91dGluZS5cbiAgICAgIGlmIChrZXkuc2hpZnQpIHtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEyMyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm9jZXNzLmV4aXQoMCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyBNYWtlIHN1cmUgdGhlIHNlcnZlciBhcHBsaWNhdGlvbiByZWNlaXZlcyBpbnB1dCBmcm9tIHRoZSB0ZXJtaW5hbFxuICBwcm9jZXNzLnN0ZGluLnBpcGUoY2hpbGRQcm9jZXNzLnN0ZGluKTtcblxuICBpZiAobGlzdGVuZXIpIHtcbiAgICBsaXN0ZW5lcihjaGlsZFByb2Nlc3MpO1xuICB9IGVsc2Uge1xuICAgIGNoaWxkUHJvY2Vzcy5zdGRvdXQub24oXCJkYXRhXCIsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICBsb2dRdWV1ZShgJHtkYXRhLnRvU3RyaW5nKCkuc2xpY2UoMCwgLTEpfWApO1xuICAgIH0pO1xuXG4gICAgY2hpbGRQcm9jZXNzLnN0ZGVyci5vbihcImRhdGFcIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgIGxvZ1F1ZXVlKGAke2RhdGEudG9TdHJpbmcoKS5zbGljZSgwLCAtMSl9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBIYW5kbGUgd2hlbiB0aGUgcHJvY2VzcyBleGlzdHMgYnkgY2xlYW5pbmcgdXAgYW55IGNoaWxkIHByb2Nlc3NlcyBldGNcbiAgaGFuZGxlUHJvY2Vzc0V4aXQoYXN5bmMgKG1lc3NhZ2U6IHN0cmluZywgZXJyPzogRXJyb3IgfCBzdHJpbmcgfCBudW1iZXIpID0+IHtcbiAgICBjaGlsZFByb2Nlc3Mua2lsbCgpO1xuICAgIGNvbnNvbGUud2FybihcIkVYSVQgQlVJTEQgU0VSVkVSXCIpO1xuICAgIGNvbnNvbGUud2FybihjaGFsay5yZWRCcmlnaHRCb2xkKG1lc3NhZ2UpKTtcbiAgICBpZiAoZXJyICYmIGVyciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oY2hhbGsucmVkQnJpZ2h0Qm9sZChlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpKTtcbiAgICB9XG4gICAgcHJvY2Vzcy5leGl0KDApO1xuICB9KTtcbn1cbiIsCiAgImltcG9ydCBidWlsZENsaWVudCBmcm9tIFwiLi4vLi4vbGliL2J1aWxkL3dlYi1hcHAvdml0ZS9idWlsZC1jbGllbnQuanNcIjtcbmltcG9ydCBydW5BcHBTZXJ2ZXIgZnJvbSBcIi4uLy4uL2xpYi9idWlsZC93ZWItYXBwL3ZpdGUvcnVuLWFwcC1zZXJ2ZXIuanNcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4uLy4uL2xpYi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyB0YXJnZXRQcm9qZWN0VmVyc2lvbiB9IGZyb20gXCIuLi8uLi9saWIvdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuXG4vKipcbiAqIEVudHJ5IHBvaW50IGZvciB0aGlzIHNjcmlwdFxuICovXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBydW4oKSB7XG4gIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gXCJkZXZlbG9wbWVudFwiO1xuXG4gIC8vIEJ1aWxkIHRoZSBjbGllbnQgaW4gd2F0Y2ggbW9kZS4gVGhlIENsaWVudCBidWlsZCBJUyBPTkxZIG1hZGUgc28gd2UgY2FuIHNlZVxuICAvLyB0aGUgZ2VuZXJhdGVkIGZpbGVzIHRvIGFpZCBpbiBkZWJ1Z2dpbmcuXG4gIGJ1aWxkQ2xpZW50KCk7XG5cbiAgY29uc29sZS53YXJuKGNoYWxrLnllbGxvd0JyaWdodEJvbGQoXCJTdGFydGluZyBkZXYgc2VydmVyLi4uXCIpKTtcbiAgcHJvY2Vzcy5lbnYuVklURV9SRUxFQVNFX1ZFUlNJT04gPSBhd2FpdCB0YXJnZXRQcm9qZWN0VmVyc2lvbigpO1xuICBhd2FpdCBydW5BcHBTZXJ2ZXIoKTtcbn1cbiIsCiAgImltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgdXJsIGZyb20gXCJ1cmxcIjtcblxuY29uc3QgX19kaXJuYW1lID0gdXJsLmZpbGVVUkxUb1BhdGgobmV3IFVSTChcIi5cIiwgaW1wb3J0Lm1ldGEudXJsKSk7XG5cbi8qKlxuICogVGhpcyByZXR1cm5zIHRoZSBwYXRoIHRvIHRoZSByb290IG9mIHRoZSBkZXZvcHMgcHJvamVjdCAoaW5zdGFsbGF0aW9uIG9yXG4gKiBkZXZlbG9wbWVudCBsb2NhdGlvbilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRldm9wc1Byb2plY3RQYXRoKCkge1xuICBjb25zdCBpc0Rpc3QgPSBwYXRoLmJhc2VuYW1lKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIFwiLi5cIikpID09PSBcImRpc3RcIjtcbiAgaWYgKGlzRGlzdCkgcmV0dXJuIHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIFwiLi4vLi4vXCIpO1xuICByZXR1cm4gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgXCIuLi8uLi8uLi9cIik7XG59XG4iLAogICJpbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCIuL2V4ZWMtc3luYy5qc1wiO1xuaW1wb3J0IHsgZ2V0UGFja2FnZU1hbmFnZXIgfSBmcm9tIFwiLi9nZXQtcGFja2FnZS1tYW5hZ2VyLmpzXCI7XG5cbi8qKlxuICogRXhlY3V0ZXMgYW4gYG5wbSBydW4gPGNvbW1hbmQ+YCBpbiB0aGUgY3VycmVudCBjb250ZXh0LlxuICpcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY29tbWFuZCBzdWNjZWVkZWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjU2NyaXB0KFxuICBjb21tYW5kOiBzdHJpbmcsXG4gIGFyZ3M6IChzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsKVtdID0gW11cbikge1xuICBjb25zdCBtYW5hZ2VyID0gYXdhaXQgZ2V0UGFja2FnZU1hbmFnZXIoKTtcblxuICByZXR1cm4gZXhlY1N5bmMobWFuYWdlclswXSwgW1xuICAgIFwicnVuXCIsXG4gICAgY29tbWFuZCxcbiAgICBhcmdzLmxlbmd0aCA+IDAgJiYgYXJnc1swXSAhPT0gXCItLVwiID8gXCItLVwiIDogdm9pZCAwLFxuICAgIC4uLmFyZ3MsXG4gIF0pO1xufVxuIiwKICAiaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4uL2xpYi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyBkZXZvcHNQcm9qZWN0UGF0aCB9IGZyb20gXCIuLi9saWIvZGV2b3BzLXByb2plY3QvZGV2b3BzLXByb2plY3QtcGF0aC5qc1wiO1xuaW1wb3J0IHsgZXhlY1NjcmlwdCB9IGZyb20gXCIuLi9saWIvZXhlYy9leGVjLXNjcmlwdC5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdFZlcnNpb24gfSBmcm9tIFwiLi4vbGliL3RhcmdldC1wcm9qZWN0L3RhcmdldC1wcm9qZWN0LXZlcnNpb24uanNcIjtcblxuLyoqXG4gKiBUaGlzIHJ1bnMgc3Rvcnlib29rIGluIHRoaXMgY29udGV4dCBvbiBiZWhhbGYgb2YgdGhlIHByb2plY3QgdGhlIGRldm9wcyBpc1xuICogaW5zdGFsbGVkIHdpdGhpbi5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKFxuICBidWlsZDogc3RyaW5nLFxuICBpbmNsdWRlOiBzdHJpbmdbXSxcbiAgLi4uX2FyZ3M6IGFueVtdXG4pIHtcbiAgY29uc3QgUFJPSkVDVF9ST09UID0gcGF0aC5yZXNvbHZlKFwiLlwiKTtcbiAgcHJvY2Vzcy5lbnYuUFJPSkVDVF9ST09UID0gUFJPSkVDVF9ST09UO1xuICBwcm9jZXNzLmVudi5WSVRFX1JFTEVBU0VfVkVSU0lPTiA9IGF3YWl0IHRhcmdldFByb2plY3RWZXJzaW9uKCk7XG4gIGNvbnN0IHN0b3J5Ym9va0NvbmZpZ1BhdGggPSBwYXRoLnJlc29sdmUoXCIuc3Rvcnlib29rXCIpO1xuICAvLyBSdW4gdGhpcyBwYWNrYWdlJ3Mgc3Rvcnlib29rIHNjcmlwdCBjb21tYW5kLlxuICBjb25zdCByb290UGF0aCA9IGF3YWl0IGRldm9wc1Byb2plY3RQYXRoKCk7XG4gIHByb2Nlc3MuY2hkaXIocm9vdFBhdGgpO1xuXG4gIC8vIFNldCB1cCBhbiBlbnZpcm9ubWVudCB0aGF0IHdpbGwgYmUgcHJvY2Vzc2VkIGluIHRoZSBtYWluLmpzIG9mIHN0b3J5eWJvb2tcbiAgLy8gY29uZmlnLiBUaGlzIHdpbGwgY2F1c2UgYWxsIHNwZWNpZmllZCBtb2R1bGVzIHRvIGJlIGxvb2tlZCBmb3Igd2hlblxuICAvLyBnYXRoZXJpbmcgc3RvcmllcyB0byBpbmNsdWRlIGluIHRoZSBidWlsZC5cbiAgaWYgKGluY2x1ZGUgJiYgaW5jbHVkZS5sZW5ndGggPiAwKSB7XG4gICAgcHJvY2Vzcy5lbnYuTk9ERV9NT0RVTEVTX1NUT1JJRVMgPSBpbmNsdWRlLmpvaW4oXCIsXCIpO1xuICB9XG5cbiAgaWYgKGJ1aWxkID09PSBcImJ1aWxkXCIpIHtcbiAgICBpZiAoXG4gICAgICAhZXhlY1NjcmlwdChcInN0b3J5Ym9va1wiLCBbXG4gICAgICAgIFwiYnVpbGRcIixcbiAgICAgICAgXCItY1wiLFxuICAgICAgICBzdG9yeWJvb2tDb25maWdQYXRoLFxuICAgICAgICBcIi1vXCIsXG4gICAgICAgIGBcIiR7cGF0aC5yZXNvbHZlKFBST0pFQ1RfUk9PVCwgXCJzdG9yeWJvb2stc3RhdGljXCIpfVwiYCxcbiAgICAgIF0pXG4gICAgKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGNoYWxrLnJlZEJyaWdodEJvbGQoXCJGYWlsZWQgdG8gYnVpbGQgc3Rvcnlib29rXCIpKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKFxuICAgICAgIWV4ZWNTY3JpcHQoXCJzdG9yeWJvb2tcIiwgW1xuICAgICAgICBcImRldlwiLFxuICAgICAgICBcIi0tbm8tdmVyc2lvbi11cGRhdGVzXCIsXG4gICAgICAgIFwiLXBcIixcbiAgICAgICAgcHJvY2Vzcy5lbnYuUE9SVCB8fCBcIjYwMDZcIixcbiAgICAgICAgXCItY1wiLFxuICAgICAgICBgXCIke3N0b3J5Ym9va0NvbmZpZ1BhdGh9XCJgLFxuICAgICAgXSlcbiAgICApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoY2hhbGsucmVkQnJpZ2h0Qm9sZChcIkZhaWxlZCB0byBydW4gc3Rvcnlib29rXCIpKTtcbiAgICB9XG4gIH1cbn1cbiIsCiAgIid1c2Ugc3RyaWN0JztcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcblxubGV0IGlzRG9ja2VyO1xuXG5mdW5jdGlvbiBoYXNEb2NrZXJFbnYoKSB7XG5cdHRyeSB7XG5cdFx0ZnMuc3RhdFN5bmMoJy8uZG9ja2VyZW52Jyk7XG5cdFx0cmV0dXJuIHRydWU7XG5cdH0gY2F0Y2ggKF8pIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn1cblxuZnVuY3Rpb24gaGFzRG9ja2VyQ0dyb3VwKCkge1xuXHR0cnkge1xuXHRcdHJldHVybiBmcy5yZWFkRmlsZVN5bmMoJy9wcm9jL3NlbGYvY2dyb3VwJywgJ3V0ZjgnKS5pbmNsdWRlcygnZG9ja2VyJyk7XG5cdH0gY2F0Y2ggKF8pIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSAoKSA9PiB7XG5cdGlmIChpc0RvY2tlciA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0aXNEb2NrZXIgPSBoYXNEb2NrZXJFbnYoKSB8fCBoYXNEb2NrZXJDR3JvdXAoKTtcblx0fVxuXG5cdHJldHVybiBpc0RvY2tlcjtcbn07XG4iLAogICIndXNlIHN0cmljdCc7XG5jb25zdCBvcyA9IHJlcXVpcmUoJ29zJyk7XG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBpc0RvY2tlciA9IHJlcXVpcmUoJ2lzLWRvY2tlcicpO1xuXG5jb25zdCBpc1dzbCA9ICgpID0+IHtcblx0aWYgKHByb2Nlc3MucGxhdGZvcm0gIT09ICdsaW51eCcpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRpZiAob3MucmVsZWFzZSgpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ21pY3Jvc29mdCcpKSB7XG5cdFx0aWYgKGlzRG9ja2VyKCkpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdHRyeSB7XG5cdFx0cmV0dXJuIGZzLnJlYWRGaWxlU3luYygnL3Byb2MvdmVyc2lvbicsICd1dGY4JykudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbWljcm9zb2Z0JykgP1xuXHRcdFx0IWlzRG9ja2VyKCkgOiBmYWxzZTtcblx0fSBjYXRjaCAoXykge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufTtcblxuaWYgKHByb2Nlc3MuZW52Ll9fSVNfV1NMX1RFU1RfXykge1xuXHRtb2R1bGUuZXhwb3J0cyA9IGlzV3NsO1xufSBlbHNlIHtcblx0bW9kdWxlLmV4cG9ydHMgPSBpc1dzbCgpO1xufVxuIiwKICAiJ3VzZSBzdHJpY3QnO1xubW9kdWxlLmV4cG9ydHMgPSAob2JqZWN0LCBwcm9wZXJ0eU5hbWUsIGZuKSA9PiB7XG5cdGNvbnN0IGRlZmluZSA9IHZhbHVlID0+IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsIHByb3BlcnR5TmFtZSwge3ZhbHVlLCBlbnVtZXJhYmxlOiB0cnVlLCB3cml0YWJsZTogdHJ1ZX0pO1xuXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmplY3QsIHByb3BlcnR5TmFtZSwge1xuXHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdGdldCgpIHtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGZuKCk7XG5cdFx0XHRkZWZpbmUocmVzdWx0KTtcblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fSxcblx0XHRzZXQodmFsdWUpIHtcblx0XHRcdGRlZmluZSh2YWx1ZSk7XG5cdFx0fVxuXHR9KTtcblxuXHRyZXR1cm4gb2JqZWN0O1xufTtcbiIsCiAgImNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBjaGlsZFByb2Nlc3MgPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG5jb25zdCB7cHJvbWlzZXM6IGZzLCBjb25zdGFudHM6IGZzQ29uc3RhbnRzfSA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBpc1dzbCA9IHJlcXVpcmUoJ2lzLXdzbCcpO1xuY29uc3QgaXNEb2NrZXIgPSByZXF1aXJlKCdpcy1kb2NrZXInKTtcbmNvbnN0IGRlZmluZUxhenlQcm9wZXJ0eSA9IHJlcXVpcmUoJ2RlZmluZS1sYXp5LXByb3AnKTtcblxuLy8gUGF0aCB0byBpbmNsdWRlZCBgeGRnLW9wZW5gLlxuY29uc3QgbG9jYWxYZGdPcGVuUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICd4ZGctb3BlbicpO1xuXG5jb25zdCB7cGxhdGZvcm0sIGFyY2h9ID0gcHJvY2VzcztcblxuLy8gUG9kbWFuIGRldGVjdGlvblxuY29uc3QgaGFzQ29udGFpbmVyRW52ID0gKCkgPT4ge1xuXHR0cnkge1xuXHRcdGZzLnN0YXRTeW5jKCcvcnVuLy5jb250YWluZXJlbnYnKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSBjYXRjaCB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG59O1xuXG5sZXQgY2FjaGVkUmVzdWx0O1xuZnVuY3Rpb24gaXNJbnNpZGVDb250YWluZXIoKSB7XG5cdGlmIChjYWNoZWRSZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuXHRcdGNhY2hlZFJlc3VsdCA9IGhhc0NvbnRhaW5lckVudigpIHx8IGlzRG9ja2VyKCk7XG5cdH1cblxuXHRyZXR1cm4gY2FjaGVkUmVzdWx0O1xufVxuXG4vKipcbkdldCB0aGUgbW91bnQgcG9pbnQgZm9yIGZpeGVkIGRyaXZlcyBpbiBXU0wuXG5cbkBpbm5lclxuQHJldHVybnMge3N0cmluZ30gVGhlIG1vdW50IHBvaW50LlxuKi9cbmNvbnN0IGdldFdzbERyaXZlc01vdW50UG9pbnQgPSAoKCkgPT4ge1xuXHQvLyBEZWZhdWx0IHZhbHVlIGZvciBcInJvb3RcIiBwYXJhbVxuXHQvLyBhY2NvcmRpbmcgdG8gaHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvd2luZG93cy93c2wvd3NsLWNvbmZpZ1xuXHRjb25zdCBkZWZhdWx0TW91bnRQb2ludCA9ICcvbW50Lyc7XG5cblx0bGV0IG1vdW50UG9pbnQ7XG5cblx0cmV0dXJuIGFzeW5jIGZ1bmN0aW9uICgpIHtcblx0XHRpZiAobW91bnRQb2ludCkge1xuXHRcdFx0Ly8gUmV0dXJuIG1lbW9pemVkIG1vdW50IHBvaW50IHZhbHVlXG5cdFx0XHRyZXR1cm4gbW91bnRQb2ludDtcblx0XHR9XG5cblx0XHRjb25zdCBjb25maWdGaWxlUGF0aCA9ICcvZXRjL3dzbC5jb25mJztcblxuXHRcdGxldCBpc0NvbmZpZ0ZpbGVFeGlzdHMgPSBmYWxzZTtcblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgZnMuYWNjZXNzKGNvbmZpZ0ZpbGVQYXRoLCBmc0NvbnN0YW50cy5GX09LKTtcblx0XHRcdGlzQ29uZmlnRmlsZUV4aXN0cyA9IHRydWU7XG5cdFx0fSBjYXRjaCB7fVxuXG5cdFx0aWYgKCFpc0NvbmZpZ0ZpbGVFeGlzdHMpIHtcblx0XHRcdHJldHVybiBkZWZhdWx0TW91bnRQb2ludDtcblx0XHR9XG5cblx0XHRjb25zdCBjb25maWdDb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoY29uZmlnRmlsZVBhdGgsIHtlbmNvZGluZzogJ3V0ZjgnfSk7XG5cdFx0Y29uc3QgY29uZmlnTW91bnRQb2ludCA9IC8oPzwhIy4qKXJvb3RcXHMqPVxccyooPzxtb3VudFBvaW50Pi4qKS9nLmV4ZWMoY29uZmlnQ29udGVudCk7XG5cblx0XHRpZiAoIWNvbmZpZ01vdW50UG9pbnQpIHtcblx0XHRcdHJldHVybiBkZWZhdWx0TW91bnRQb2ludDtcblx0XHR9XG5cblx0XHRtb3VudFBvaW50ID0gY29uZmlnTW91bnRQb2ludC5ncm91cHMubW91bnRQb2ludC50cmltKCk7XG5cdFx0bW91bnRQb2ludCA9IG1vdW50UG9pbnQuZW5kc1dpdGgoJy8nKSA/IG1vdW50UG9pbnQgOiBgJHttb3VudFBvaW50fS9gO1xuXG5cdFx0cmV0dXJuIG1vdW50UG9pbnQ7XG5cdH07XG59KSgpO1xuXG5jb25zdCBwVHJ5RWFjaCA9IGFzeW5jIChhcnJheSwgbWFwcGVyKSA9PiB7XG5cdGxldCBsYXRlc3RFcnJvcjtcblxuXHRmb3IgKGNvbnN0IGl0ZW0gb2YgYXJyYXkpIHtcblx0XHR0cnkge1xuXHRcdFx0cmV0dXJuIGF3YWl0IG1hcHBlcihpdGVtKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1hd2FpdC1pbi1sb29wXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGxhdGVzdEVycm9yID0gZXJyb3I7XG5cdFx0fVxuXHR9XG5cblx0dGhyb3cgbGF0ZXN0RXJyb3I7XG59O1xuXG5jb25zdCBiYXNlT3BlbiA9IGFzeW5jIG9wdGlvbnMgPT4ge1xuXHRvcHRpb25zID0ge1xuXHRcdHdhaXQ6IGZhbHNlLFxuXHRcdGJhY2tncm91bmQ6IGZhbHNlLFxuXHRcdG5ld0luc3RhbmNlOiBmYWxzZSxcblx0XHRhbGxvd05vbnplcm9FeGl0Q29kZTogZmFsc2UsXG5cdFx0Li4ub3B0aW9uc1xuXHR9O1xuXG5cdGlmIChBcnJheS5pc0FycmF5KG9wdGlvbnMuYXBwKSkge1xuXHRcdHJldHVybiBwVHJ5RWFjaChvcHRpb25zLmFwcCwgc2luZ2xlQXBwID0+IGJhc2VPcGVuKHtcblx0XHRcdC4uLm9wdGlvbnMsXG5cdFx0XHRhcHA6IHNpbmdsZUFwcFxuXHRcdH0pKTtcblx0fVxuXG5cdGxldCB7bmFtZTogYXBwLCBhcmd1bWVudHM6IGFwcEFyZ3VtZW50cyA9IFtdfSA9IG9wdGlvbnMuYXBwIHx8IHt9O1xuXHRhcHBBcmd1bWVudHMgPSBbLi4uYXBwQXJndW1lbnRzXTtcblxuXHRpZiAoQXJyYXkuaXNBcnJheShhcHApKSB7XG5cdFx0cmV0dXJuIHBUcnlFYWNoKGFwcCwgYXBwTmFtZSA9PiBiYXNlT3Blbih7XG5cdFx0XHQuLi5vcHRpb25zLFxuXHRcdFx0YXBwOiB7XG5cdFx0XHRcdG5hbWU6IGFwcE5hbWUsXG5cdFx0XHRcdGFyZ3VtZW50czogYXBwQXJndW1lbnRzXG5cdFx0XHR9XG5cdFx0fSkpO1xuXHR9XG5cblx0bGV0IGNvbW1hbmQ7XG5cdGNvbnN0IGNsaUFyZ3VtZW50cyA9IFtdO1xuXHRjb25zdCBjaGlsZFByb2Nlc3NPcHRpb25zID0ge307XG5cblx0aWYgKHBsYXRmb3JtID09PSAnZGFyd2luJykge1xuXHRcdGNvbW1hbmQgPSAnb3Blbic7XG5cblx0XHRpZiAob3B0aW9ucy53YWl0KSB7XG5cdFx0XHRjbGlBcmd1bWVudHMucHVzaCgnLS13YWl0LWFwcHMnKTtcblx0XHR9XG5cblx0XHRpZiAob3B0aW9ucy5iYWNrZ3JvdW5kKSB7XG5cdFx0XHRjbGlBcmd1bWVudHMucHVzaCgnLS1iYWNrZ3JvdW5kJyk7XG5cdFx0fVxuXG5cdFx0aWYgKG9wdGlvbnMubmV3SW5zdGFuY2UpIHtcblx0XHRcdGNsaUFyZ3VtZW50cy5wdXNoKCctLW5ldycpO1xuXHRcdH1cblxuXHRcdGlmIChhcHApIHtcblx0XHRcdGNsaUFyZ3VtZW50cy5wdXNoKCctYScsIGFwcCk7XG5cdFx0fVxuXHR9IGVsc2UgaWYgKHBsYXRmb3JtID09PSAnd2luMzInIHx8IChpc1dzbCAmJiAhaXNJbnNpZGVDb250YWluZXIoKSAmJiAhYXBwKSkge1xuXHRcdGNvbnN0IG1vdW50UG9pbnQgPSBhd2FpdCBnZXRXc2xEcml2ZXNNb3VudFBvaW50KCk7XG5cblx0XHRjb21tYW5kID0gaXNXc2wgP1xuXHRcdFx0YCR7bW91bnRQb2ludH1jL1dpbmRvd3MvU3lzdGVtMzIvV2luZG93c1Bvd2VyU2hlbGwvdjEuMC9wb3dlcnNoZWxsLmV4ZWAgOlxuXHRcdFx0YCR7cHJvY2Vzcy5lbnYuU1lTVEVNUk9PVH1cXFxcU3lzdGVtMzJcXFxcV2luZG93c1Bvd2VyU2hlbGxcXFxcdjEuMFxcXFxwb3dlcnNoZWxsYDtcblxuXHRcdGNsaUFyZ3VtZW50cy5wdXNoKFxuXHRcdFx0Jy1Ob1Byb2ZpbGUnLFxuXHRcdFx0Jy1Ob25JbnRlcmFjdGl2ZScsXG5cdFx0XHQn4oCTRXhlY3V0aW9uUG9saWN5Jyxcblx0XHRcdCdCeXBhc3MnLFxuXHRcdFx0Jy1FbmNvZGVkQ29tbWFuZCdcblx0XHQpO1xuXG5cdFx0aWYgKCFpc1dzbCkge1xuXHRcdFx0Y2hpbGRQcm9jZXNzT3B0aW9ucy53aW5kb3dzVmVyYmF0aW1Bcmd1bWVudHMgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGNvbnN0IGVuY29kZWRBcmd1bWVudHMgPSBbJ1N0YXJ0J107XG5cblx0XHRpZiAob3B0aW9ucy53YWl0KSB7XG5cdFx0XHRlbmNvZGVkQXJndW1lbnRzLnB1c2goJy1XYWl0Jyk7XG5cdFx0fVxuXG5cdFx0aWYgKGFwcCkge1xuXHRcdFx0Ly8gRG91YmxlIHF1b3RlIHdpdGggZG91YmxlIHF1b3RlcyB0byBlbnN1cmUgdGhlIGlubmVyIHF1b3RlcyBhcmUgcGFzc2VkIHRocm91Z2guXG5cdFx0XHQvLyBJbm5lciBxdW90ZXMgYXJlIGRlbGltaXRlZCBmb3IgUG93ZXJTaGVsbCBpbnRlcnByZXRhdGlvbiB3aXRoIGJhY2t0aWNrcy5cblx0XHRcdGVuY29kZWRBcmd1bWVudHMucHVzaChgXCJcXGBcIiR7YXBwfVxcYFwiXCJgLCAnLUFyZ3VtZW50TGlzdCcpO1xuXHRcdFx0aWYgKG9wdGlvbnMudGFyZ2V0KSB7XG5cdFx0XHRcdGFwcEFyZ3VtZW50cy51bnNoaWZ0KG9wdGlvbnMudGFyZ2V0KTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKG9wdGlvbnMudGFyZ2V0KSB7XG5cdFx0XHRlbmNvZGVkQXJndW1lbnRzLnB1c2goYFwiJHtvcHRpb25zLnRhcmdldH1cImApO1xuXHRcdH1cblxuXHRcdGlmIChhcHBBcmd1bWVudHMubGVuZ3RoID4gMCkge1xuXHRcdFx0YXBwQXJndW1lbnRzID0gYXBwQXJndW1lbnRzLm1hcChhcmcgPT4gYFwiXFxgXCIke2FyZ31cXGBcIlwiYCk7XG5cdFx0XHRlbmNvZGVkQXJndW1lbnRzLnB1c2goYXBwQXJndW1lbnRzLmpvaW4oJywnKSk7XG5cdFx0fVxuXG5cdFx0Ly8gVXNpbmcgQmFzZTY0LWVuY29kZWQgY29tbWFuZCwgYWNjZXB0ZWQgYnkgUG93ZXJTaGVsbCwgdG8gYWxsb3cgc3BlY2lhbCBjaGFyYWN0ZXJzLlxuXHRcdG9wdGlvbnMudGFyZ2V0ID0gQnVmZmVyLmZyb20oZW5jb2RlZEFyZ3VtZW50cy5qb2luKCcgJyksICd1dGYxNmxlJykudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuXHR9IGVsc2Uge1xuXHRcdGlmIChhcHApIHtcblx0XHRcdGNvbW1hbmQgPSBhcHA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFdoZW4gYnVuZGxlZCBieSBXZWJwYWNrLCB0aGVyZSdzIG5vIGFjdHVhbCBwYWNrYWdlIGZpbGUgcGF0aCBhbmQgbm8gbG9jYWwgYHhkZy1vcGVuYC5cblx0XHRcdGNvbnN0IGlzQnVuZGxlZCA9ICFfX2Rpcm5hbWUgfHwgX19kaXJuYW1lID09PSAnLyc7XG5cblx0XHRcdC8vIENoZWNrIGlmIGxvY2FsIGB4ZGctb3BlbmAgZXhpc3RzIGFuZCBpcyBleGVjdXRhYmxlLlxuXHRcdFx0bGV0IGV4ZUxvY2FsWGRnT3BlbiA9IGZhbHNlO1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0YXdhaXQgZnMuYWNjZXNzKGxvY2FsWGRnT3BlblBhdGgsIGZzQ29uc3RhbnRzLlhfT0spO1xuXHRcdFx0XHRleGVMb2NhbFhkZ09wZW4gPSB0cnVlO1xuXHRcdFx0fSBjYXRjaCB7fVxuXG5cdFx0XHRjb25zdCB1c2VTeXN0ZW1YZGdPcGVuID0gcHJvY2Vzcy52ZXJzaW9ucy5lbGVjdHJvbiB8fFxuXHRcdFx0XHRwbGF0Zm9ybSA9PT0gJ2FuZHJvaWQnIHx8IGlzQnVuZGxlZCB8fCAhZXhlTG9jYWxYZGdPcGVuO1xuXHRcdFx0Y29tbWFuZCA9IHVzZVN5c3RlbVhkZ09wZW4gPyAneGRnLW9wZW4nIDogbG9jYWxYZGdPcGVuUGF0aDtcblx0XHR9XG5cblx0XHRpZiAoYXBwQXJndW1lbnRzLmxlbmd0aCA+IDApIHtcblx0XHRcdGNsaUFyZ3VtZW50cy5wdXNoKC4uLmFwcEFyZ3VtZW50cyk7XG5cdFx0fVxuXG5cdFx0aWYgKCFvcHRpb25zLndhaXQpIHtcblx0XHRcdC8vIGB4ZGctb3BlbmAgd2lsbCBibG9jayB0aGUgcHJvY2VzcyB1bmxlc3Mgc3RkaW8gaXMgaWdub3JlZFxuXHRcdFx0Ly8gYW5kIGl0J3MgZGV0YWNoZWQgZnJvbSB0aGUgcGFyZW50IGV2ZW4gaWYgaXQncyB1bnJlZidkLlxuXHRcdFx0Y2hpbGRQcm9jZXNzT3B0aW9ucy5zdGRpbyA9ICdpZ25vcmUnO1xuXHRcdFx0Y2hpbGRQcm9jZXNzT3B0aW9ucy5kZXRhY2hlZCA9IHRydWU7XG5cdFx0fVxuXHR9XG5cblx0aWYgKG9wdGlvbnMudGFyZ2V0KSB7XG5cdFx0Y2xpQXJndW1lbnRzLnB1c2gob3B0aW9ucy50YXJnZXQpO1xuXHR9XG5cblx0aWYgKHBsYXRmb3JtID09PSAnZGFyd2luJyAmJiBhcHBBcmd1bWVudHMubGVuZ3RoID4gMCkge1xuXHRcdGNsaUFyZ3VtZW50cy5wdXNoKCctLWFyZ3MnLCAuLi5hcHBBcmd1bWVudHMpO1xuXHR9XG5cblx0Y29uc3Qgc3VicHJvY2VzcyA9IGNoaWxkUHJvY2Vzcy5zcGF3bihjb21tYW5kLCBjbGlBcmd1bWVudHMsIGNoaWxkUHJvY2Vzc09wdGlvbnMpO1xuXG5cdGlmIChvcHRpb25zLndhaXQpIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0c3VicHJvY2Vzcy5vbmNlKCdlcnJvcicsIHJlamVjdCk7XG5cblx0XHRcdHN1YnByb2Nlc3Mub25jZSgnY2xvc2UnLCBleGl0Q29kZSA9PiB7XG5cdFx0XHRcdGlmICghb3B0aW9ucy5hbGxvd05vbnplcm9FeGl0Q29kZSAmJiBleGl0Q29kZSA+IDApIHtcblx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKGBFeGl0ZWQgd2l0aCBjb2RlICR7ZXhpdENvZGV9YCkpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJlc29sdmUoc3VicHJvY2Vzcyk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdHN1YnByb2Nlc3MudW5yZWYoKTtcblxuXHRyZXR1cm4gc3VicHJvY2Vzcztcbn07XG5cbmNvbnN0IG9wZW4gPSAodGFyZ2V0LCBvcHRpb25zKSA9PiB7XG5cdGlmICh0eXBlb2YgdGFyZ2V0ICE9PSAnc3RyaW5nJykge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIGEgYHRhcmdldGAnKTtcblx0fVxuXG5cdHJldHVybiBiYXNlT3Blbih7XG5cdFx0Li4ub3B0aW9ucyxcblx0XHR0YXJnZXRcblx0fSk7XG59O1xuXG5jb25zdCBvcGVuQXBwID0gKG5hbWUsIG9wdGlvbnMpID0+IHtcblx0aWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykge1xuXHRcdHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIGEgYG5hbWVgJyk7XG5cdH1cblxuXHRjb25zdCB7YXJndW1lbnRzOiBhcHBBcmd1bWVudHMgPSBbXX0gPSBvcHRpb25zIHx8IHt9O1xuXHRpZiAoYXBwQXJndW1lbnRzICE9PSB1bmRlZmluZWQgJiYgYXBwQXJndW1lbnRzICE9PSBudWxsICYmICFBcnJheS5pc0FycmF5KGFwcEFyZ3VtZW50cykpIHtcblx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCdFeHBlY3RlZCBgYXBwQXJndW1lbnRzYCBhcyBBcnJheSB0eXBlJyk7XG5cdH1cblxuXHRyZXR1cm4gYmFzZU9wZW4oe1xuXHRcdC4uLm9wdGlvbnMsXG5cdFx0YXBwOiB7XG5cdFx0XHRuYW1lLFxuXHRcdFx0YXJndW1lbnRzOiBhcHBBcmd1bWVudHNcblx0XHR9XG5cdH0pO1xufTtcblxuZnVuY3Rpb24gZGV0ZWN0QXJjaEJpbmFyeShiaW5hcnkpIHtcblx0aWYgKHR5cGVvZiBiaW5hcnkgPT09ICdzdHJpbmcnIHx8IEFycmF5LmlzQXJyYXkoYmluYXJ5KSkge1xuXHRcdHJldHVybiBiaW5hcnk7XG5cdH1cblxuXHRjb25zdCB7W2FyY2hdOiBhcmNoQmluYXJ5fSA9IGJpbmFyeTtcblxuXHRpZiAoIWFyY2hCaW5hcnkpIHtcblx0XHR0aHJvdyBuZXcgRXJyb3IoYCR7YXJjaH0gaXMgbm90IHN1cHBvcnRlZGApO1xuXHR9XG5cblx0cmV0dXJuIGFyY2hCaW5hcnk7XG59XG5cbmZ1bmN0aW9uIGRldGVjdFBsYXRmb3JtQmluYXJ5KHtbcGxhdGZvcm1dOiBwbGF0Zm9ybUJpbmFyeX0sIHt3c2x9KSB7XG5cdGlmICh3c2wgJiYgaXNXc2wpIHtcblx0XHRyZXR1cm4gZGV0ZWN0QXJjaEJpbmFyeSh3c2wpO1xuXHR9XG5cblx0aWYgKCFwbGF0Zm9ybUJpbmFyeSkge1xuXHRcdHRocm93IG5ldyBFcnJvcihgJHtwbGF0Zm9ybX0gaXMgbm90IHN1cHBvcnRlZGApO1xuXHR9XG5cblx0cmV0dXJuIGRldGVjdEFyY2hCaW5hcnkocGxhdGZvcm1CaW5hcnkpO1xufVxuXG5jb25zdCBhcHBzID0ge307XG5cbmRlZmluZUxhenlQcm9wZXJ0eShhcHBzLCAnY2hyb21lJywgKCkgPT4gZGV0ZWN0UGxhdGZvcm1CaW5hcnkoe1xuXHRkYXJ3aW46ICdnb29nbGUgY2hyb21lJyxcblx0d2luMzI6ICdjaHJvbWUnLFxuXHRsaW51eDogWydnb29nbGUtY2hyb21lJywgJ2dvb2dsZS1jaHJvbWUtc3RhYmxlJywgJ2Nocm9taXVtJ11cbn0sIHtcblx0d3NsOiB7XG5cdFx0aWEzMjogJy9tbnQvYy9Qcm9ncmFtIEZpbGVzICh4ODYpL0dvb2dsZS9DaHJvbWUvQXBwbGljYXRpb24vY2hyb21lLmV4ZScsXG5cdFx0eDY0OiBbJy9tbnQvYy9Qcm9ncmFtIEZpbGVzL0dvb2dsZS9DaHJvbWUvQXBwbGljYXRpb24vY2hyb21lLmV4ZScsICcvbW50L2MvUHJvZ3JhbSBGaWxlcyAoeDg2KS9Hb29nbGUvQ2hyb21lL0FwcGxpY2F0aW9uL2Nocm9tZS5leGUnXVxuXHR9XG59KSk7XG5cbmRlZmluZUxhenlQcm9wZXJ0eShhcHBzLCAnZmlyZWZveCcsICgpID0+IGRldGVjdFBsYXRmb3JtQmluYXJ5KHtcblx0ZGFyd2luOiAnZmlyZWZveCcsXG5cdHdpbjMyOiAnQzpcXFxcUHJvZ3JhbSBGaWxlc1xcXFxNb3ppbGxhIEZpcmVmb3hcXFxcZmlyZWZveC5leGUnLFxuXHRsaW51eDogJ2ZpcmVmb3gnXG59LCB7XG5cdHdzbDogJy9tbnQvYy9Qcm9ncmFtIEZpbGVzL01vemlsbGEgRmlyZWZveC9maXJlZm94LmV4ZSdcbn0pKTtcblxuZGVmaW5lTGF6eVByb3BlcnR5KGFwcHMsICdlZGdlJywgKCkgPT4gZGV0ZWN0UGxhdGZvcm1CaW5hcnkoe1xuXHRkYXJ3aW46ICdtaWNyb3NvZnQgZWRnZScsXG5cdHdpbjMyOiAnbXNlZGdlJyxcblx0bGludXg6IFsnbWljcm9zb2Z0LWVkZ2UnLCAnbWljcm9zb2Z0LWVkZ2UtZGV2J11cbn0sIHtcblx0d3NsOiAnL21udC9jL1Byb2dyYW0gRmlsZXMgKHg4NikvTWljcm9zb2Z0L0VkZ2UvQXBwbGljYXRpb24vbXNlZGdlLmV4ZSdcbn0pKTtcblxub3Blbi5hcHBzID0gYXBwcztcbm9wZW4ub3BlbkFwcCA9IG9wZW5BcHA7XG5cbm1vZHVsZS5leHBvcnRzID0gb3BlbjtcbiIsCiAgImltcG9ydCB7IGlzQ2hpbGRQcm9jZXNzRXJyb3IgfSBmcm9tIFwiLi4vdXRpbC9pcy1jaGlsZC1wcm9jZXNzLWVycm9yLmpzXCI7XG5pbXBvcnQgeyBpc0RlZmluZWQgfSBmcm9tIFwiLi4vdXRpbC90eXBlcy5qc1wiO1xuXG4vKipcbiAqIEV4ZWN1dGVzIGEgY29tbWFuZCBvbiB0aGUgc2FtZSBzdGRpbyBhcyB0aGUgY3VycmVudCBwcm9jZXNzLiBUaGlzIGFic29yYnNcbiAqIGVycm9ycyBhbmQgYWxzbyBpZ25vcmVzIG51bGwvdW5kZWZpbmVkIGFyZ3VtZW50cy5cbiAqXG4gKiBSZXR1cm5zIHRoZSBzdGRvdXQgcmVzdWx0IG9mIHRoZSBjb21tYW5kIGlmIGl0IHN1Y2NlZWRzIGFuZCBudWxsIGlmIGl0IGZhaWxzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhlY1N5bmNSZXN1bHQoXG4gIGNvbW1hbmQ6IHN0cmluZyxcbiAgYXJnczogKHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpW10gPSBbXVxuKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gQnVuLnNwYXduU3luYyhbY29tbWFuZCwgLi4uYXJncy5maWx0ZXIoaXNEZWZpbmVkKV0sIHtcbiAgICAgIHN0ZGlvOiBbXCJpbmhlcml0XCIsIFwicGlwZVwiLCBcInBpcGVcIl0sXG4gICAgICBlbnY6IHByb2Nlc3MuZW52LFxuICAgIH0pO1xuXG4gICAgaWYgKHJlc3VsdC5leGl0Q29kZSAhPT0gMCkge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgYEVycm9yOiAke2NvbW1hbmR9ICR7YXJncy5qb2luKFwiIFwiKX0gZmFpbGVkIHdpdGggY29kZTogJHtcbiAgICAgICAgICByZXN1bHQuZXhpdENvZGVcbiAgICAgICAgfWBcbiAgICAgICk7XG4gICAgICBjb25zb2xlLmVycm9yKG5ldyBFcnJvcigpLnN0YWNrKTtcblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIChyZXN1bHQuc3Rkb3V0IHx8IFwiXCIpLnRvU3RyaW5nKCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChpc0NoaWxkUHJvY2Vzc0Vycm9yKGVycikpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGBFcnJvcjogJHtjb21tYW5kfSAke2FyZ3Muam9pbihcIiBcIil9IGZhaWxlZCB3aXRoIGNvZGU6ICR7ZXJyLnN0YXR1c31gXG4gICAgICApO1xuICAgIH0gZWxzZSBpZiAoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyLm1lc3NhZ2UpO1xuICAgIH1cblxuICAgIGNvbnNvbGUuZXJyb3IobmV3IEVycm9yKCkuc3RhY2spO1xuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiIsCiAgImV4cG9ydCBpbnRlcmZhY2UgSVRlbXBsYXRlUmVzdWx0cyB7XG4gIC8qKiBUaGlzIGlzIHRoZSByZXN1bHRpbmcgdGVtcGxhdGUgc3RyaW5nIGdlbmVyYXRlZCBmcm9tIHRoZSB0ZW1wbGF0aW5nICovXG4gIHRlbXBsYXRlOiBzdHJpbmc7XG4gIC8qKiBUaGlzIGlzIHRoZSB0ZW1wbGF0ZSBvcHRpb25zIHByb3ZpZGVkIGJ5IHRoZSB0ZW1wbGF0ZS4ge29wdGlvbjogbnVtIG9jY3VycmVuY2VzfSAqL1xuICB0ZW1wbGF0ZVByb3ZpZGVkT3B0aW9uczogTWFwPHN0cmluZywgbnVtYmVyPjtcbiAgLyoqXG4gICAqIFRoaXMgaXMgdGhlIHRlbXBsYXRlIG9wdGlvbnMgcHJvdmlkZWQgYnkgdGhlIHRlbXBsYXRlIHRoYXQgd2VyZSBub3QgcmVzb2x2ZWQgYnkgdGhlIG9wdGlvbnMgcGFyYW1ldGVyXG4gICAqIHtvcHRpb246IG51bSBvY2N1cnJlbmNlc31cbiAgICovXG4gIHVucmVzb2x2ZWRUZW1wbGF0ZU9wdGlvbnM6IE1hcDxzdHJpbmcsIG51bWJlcj47XG4gIC8qKiBUaGlzIGlzIHRoZSBvcHRpb25zIHByb3ZpZGVkIHRvIHRoZSB0ZW1wbGF0ZSB0aGF0IGRpZCBub3QgZ2V0IHJlc29sdmVkIGJ5IHRoZSB0ZW1wbGF0ZSB7b3B0aW9uOiAxfSAqL1xuICB1bnJlc29sdmVkUHJvdmlkZWRPcHRpb25zOiBNYXA8c3RyaW5nLCBudW1iZXI+O1xuICAvKiogVGhpcyBpcyB0aGUgbGlzdCBvZiBvcHRpb25zIHRoYXQgRElEIGdldCByZXNvbHZlZCBieSB0aGUgb3B0aW9ucyBwcm92aWRlZCB7b3B0aW9uOiBudW0gb2NjdXJyZW5jZXN9ICovXG4gIHJlc29sdmVkdGVtcGxhdGVPcHRpb25zOiBNYXA8c3RyaW5nLCBudW1iZXI+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElUZW1wbGF0ZVJlcXVpcmVtZW50cyB7XG4gIC8qKiBBIHN0cmluZyBpZGVudGlmaWVyIHRvIG1ha2UgaXQgZWFzaWVyIHRvIGlkZW50aWZ5IHdoaWNoIHRlbXBsYXRlIHRlbXBsYXRlIGZhaWxlZCByZXF1aXJlbWVudHMgKi9cbiAgbmFtZTogc3RyaW5nO1xuICAvKiogVGhlIG9wdGlvbnMgdGhhdCBtdXN0IGJlIHByZXNlbnQgd2l0aGluIGJvdGggcHJvdmlkZWQgb3B0aW9ucyBBTkQgd2l0aGluIHRoZSB0ZW1wbGF0ZSAqL1xuICB2YWx1ZXM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElUZW1wbGF0ZU9wdGlvbnMge1xuICAvKiogRG91YmxlIGN1cmx5IGJyYWNrZXRzIGZvciB0ZW1wbGF0ZSBpdGVtcyBpbnN0ZWFkIG9mIG9uZSAqL1xuICBkb3VibGVDdXJseUJyYWNrZXRzPzogYm9vbGVhbjtcbiAgLyoqIENhbGxiYWNrIGZvciAncmVxdWlyZWQnIGVycm9ycyBiZWluZyBlbWl0dGVkICovXG4gIG9uRXJyb3I/KG1zZzogc3RyaW5nKTogdm9pZDtcbiAgLyoqXG4gICAqIENhbGxiYWNrIHRoYXQgYWxsb3dzIG92ZXJyaWRlcyBmb3IgdG9rZW4gcmVwbGFjZW1lbnQuIFByb3ZpZGVzIHRoZSB0b2tlbiBmb3VuZCBhbmQgdGhlXG4gICAqIHN1Z2dlc3RlZCByZXBsYWNlbWVudCBmb3IgaXRcbiAgICovXG4gIG9uVG9rZW4/KHRva2VuOiBzdHJpbmcsIHJlcGxhY2U6IHN0cmluZyk6IHN0cmluZztcbiAgLyoqIFRoaXMgaXMgYSBrZXkgdmFsdWUgcGFpciB0aGUgdGVtcGxhdGUgdXNlcyB0byBtYXRjaCB0b2tlbnMgZm91bmQgdG8gcmVwbGFjZW1lbnQgdmFsdWVzICovXG4gIG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZD47XG4gIC8qKiBUaGlzIGlzIHVzZWQgdG8gaW5kaWNhdGUgd2hpY2ggdG9rZW5zIGFyZSByZXF1aXJlZCBib3RoIHdpdGhpbiB0aGUgdGVtcGxhdGUgQU5EIHdpdGhpbiB0aGUgJ29wdGlvbnMnICovXG4gIHJlcXVpcmVkPzogSVRlbXBsYXRlUmVxdWlyZW1lbnRzO1xuICAvKiogVGhpcyBpcyB0aGUgdGVtcGxhdGUgd3JpdHRlbiB3aXRoIHRlbXBsYXRpbmcgaW5mb3JtYXRpb24gKi9cbiAgdGVtcGxhdGU6IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGlzIGlzIGEgbWV0aG9kIHRoYXQgYWlkcyBpbiBtYWtpbmcgdGVtcGxhdGVzIGEgYml0IG1vcmUgZHluYW1pYyB3aXRoIHNpbXBsZSBzdHJpbmcgcmVwbGFjZW1lbnQgYmFzZWQgb25cbiAqIHRva2VucyB3cml0dGVuIGludG8gdGhlIHRlbXBsYXRlLiBUb2tlbnMgaW4gdGhlIHRlbXBsYXRlIHdpbGwgYXBwZWFyIGFzICR7dG9rZW59IGFuZCB3aWxsIGVpdGhlciBiZSBpZ25vcmVkIGJ5IHRoaXNcbiAqIG1ldGhvZCBhbmQgdGh1cyByZW1vdmVkIG9yIHdpbGwgYmUgcmVwbGFjZWQgd2l0aCBhIHByb3ZpZGVkIHZhbHVlLlxuICpcbiAqIFRoaXMgbWV0aG9kIHdpbGwgZ2l2ZSBmZWVkYmFjayBvbiB0aGUgcmVwbGFjZW1lbnRzIHRha2luZyBwbGFjZSBhbmQgc2ltcGxpZnkgdGhlIHByb2Nlc3Mgb2YgZGV0ZWN0aW5nIGVycm9yc1xuICogd2l0aGluIHRoZSBwcm9jZXNzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdGVtcGxhdGUoe1xuICB0ZW1wbGF0ZSxcbiAgb3B0aW9ucyxcbiAgcmVxdWlyZWQsXG4gIGRvdWJsZUN1cmx5QnJhY2tldHMsXG4gIG9uRXJyb3IsXG4gIG9uVG9rZW4sXG59OiBJVGVtcGxhdGVPcHRpb25zKTogSVRlbXBsYXRlUmVzdWx0cyB7XG4gIGNvbnN0IG1hdGNoZWQgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IG5vVmFsdWVQcm92aWRlZCA9IG5ldyBNYXAoKTtcbiAgY29uc3Qgbm90Rm91bmQgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IHRlbXBsYXRlUHJvdmlkZWRPcHRpb25zID0gbmV3IE1hcCgpO1xuXG4gIGxldCBwYXR0ZXJuID0gL1xcJFxceyhbXlxcfV0qKVxcfS9nO1xuXG4gIGlmIChkb3VibGVDdXJseUJyYWNrZXRzKSB7XG4gICAgcGF0dGVybiA9IC9cXCRcXHtcXHsoW15cXH1dKilcXH1cXH0vZztcbiAgfVxuXG4gIGNvbnN0IHRlbXBsYXRlUmVzdWx0cyA9IHRlbXBsYXRlLnJlcGxhY2UocGF0dGVybiwgKF94LCBtYXRjaCkgPT4ge1xuICAgIGxldCByZXBsYWNlID0gXCJcIjtcbiAgICB0ZW1wbGF0ZVByb3ZpZGVkT3B0aW9ucy5zZXQoXG4gICAgICBtYXRjaCxcbiAgICAgICh0ZW1wbGF0ZVByb3ZpZGVkT3B0aW9ucy5nZXQobWF0Y2gpIHx8IDApICsgMVxuICAgICk7XG5cbiAgICBpZiAobWF0Y2ggaW4gb3B0aW9ucykge1xuICAgICAgbWF0Y2hlZC5zZXQobWF0Y2gsIChtYXRjaGVkLmdldChtYXRjaCkgfHwgMCkgKyAxKTtcbiAgICAgIGNvbnN0IHZhbHVlID0gb3B0aW9uc1ttYXRjaF07XG5cbiAgICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHJlcGxhY2UgPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbm9WYWx1ZVByb3ZpZGVkLnNldChtYXRjaCwgKG5vVmFsdWVQcm92aWRlZC5nZXQobWF0Y2gpIHx8IDApICsgMSk7XG4gICAgfVxuXG4gICAgaWYgKG9uVG9rZW4pIHtcbiAgICAgIHJlcGxhY2UgPSBvblRva2VuKG1hdGNoLCByZXBsYWNlKTtcbiAgICAgIGlmIChyZXBsYWNlICE9PSBtYXRjaCkge1xuICAgICAgICBtYXRjaGVkLnNldChtYXRjaCwgKG1hdGNoZWQuZ2V0KG1hdGNoKSB8fCAwKSArIDEpO1xuICAgICAgICBub1ZhbHVlUHJvdmlkZWQuZGVsZXRlKG1hdGNoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVwbGFjZTtcbiAgfSk7XG5cbiAgT2JqZWN0LmtleXMob3B0aW9ucykuZm9yRWFjaCgob3B0aW9uKSA9PiB7XG4gICAgaWYgKCFtYXRjaGVkLmdldChvcHRpb24pKSB7XG4gICAgICBub3RGb3VuZC5zZXQob3B0aW9uLCAobm90Rm91bmQuZ2V0KG9wdGlvbikgfHwgMCkgKyAxKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIFByb3ZpZGUgbWV0cmljc1xuICBjb25zdCByZXN1bHRzOiBJVGVtcGxhdGVSZXN1bHRzID0ge1xuICAgIHJlc29sdmVkdGVtcGxhdGVPcHRpb25zOiBtYXRjaGVkLFxuICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZVJlc3VsdHMsXG4gICAgdGVtcGxhdGVQcm92aWRlZE9wdGlvbnMsXG4gICAgdW5yZXNvbHZlZFByb3ZpZGVkT3B0aW9uczogbm90Rm91bmQsXG4gICAgdW5yZXNvbHZlZFRlbXBsYXRlT3B0aW9uczogbm9WYWx1ZVByb3ZpZGVkLFxuICB9O1xuXG4gIGlmIChyZXF1aXJlZCkge1xuICAgIC8vIFRoaXMgd2lsbCBlbnN1cmUgdGhhdCBCT1RIIHRoZSBwYXJhbWV0ZXIgaW5wdXQgQU5EIHRoZSB0ZW1wbGF0ZSBwcm92aWRlZCB0aGUgcmVxdWlyZWQgb3B0aW9ucy5cbiAgICByZXF1aXJlZC52YWx1ZXMuZm9yRWFjaCgocmVxdWlyZSkgPT4ge1xuICAgICAgaWYgKHJlc3VsdHMudW5yZXNvbHZlZFByb3ZpZGVkT3B0aW9ucy5nZXQocmVxdWlyZSkpIHtcbiAgICAgICAgY29uc3QgbXNnID0gYCR7cmVxdWlyZWQubmFtZX06IENvdWxkIG5vdCByZXNvbHZlIGFsbCB0aGUgcmVxdWlyZWQgaW5wdXRzLiBJbnB1dDogJHtyZXF1aXJlfWA7XG4gICAgICAgIGlmIChvbkVycm9yKSBvbkVycm9yKG1zZyk7XG4gICAgICAgIGVsc2UgY29uc29sZS5lcnJvcihtc2cpO1xuICAgICAgfSBlbHNlIGlmIChyZXN1bHRzLnVucmVzb2x2ZWRUZW1wbGF0ZU9wdGlvbnMuZ2V0KHJlcXVpcmUpKSB7XG4gICAgICAgIGNvbnN0IG1zZyA9IGAke3JlcXVpcmVkLm5hbWV9OiBBIHJlcXVpcmVkIG9wdGlvbiB3YXMgbm90IHByb3ZpZGVkIGluIHRoZSBvcHRpb25zIHBhcmFtZXRlci4gT3B0aW9uOiAke3JlcXVpcmV9YDtcbiAgICAgICAgaWYgKG9uRXJyb3IpIG9uRXJyb3IobXNnKTtcbiAgICAgICAgZWxzZSBjb25zb2xlLmVycm9yKG1zZyk7XG4gICAgICB9IGVsc2UgaWYgKCFyZXN1bHRzLnJlc29sdmVkdGVtcGxhdGVPcHRpb25zLmdldChyZXF1aXJlKSkge1xuICAgICAgICBjb25zdCBtc2cgPSBgJHtyZXF1aXJlZC5uYW1lfTogQSByZXF1aXJlZCBvcHRpb24gd2FzIG5vdCBwcm92aWRlZCBpbiB0aGUgb3B0aW9ucyBwYXJhbWV0ZXIuIE9wdGlvbjogJHtyZXF1aXJlfWA7XG4gICAgICAgIGlmIChvbkVycm9yKSBvbkVycm9yKG1zZyk7XG4gICAgICAgIGVsc2UgY29uc29sZS5lcnJvcihtc2cpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgaG9zdGlsZSBmcm9tIFwiaG9zdGlsZVwiO1xuaW1wb3J0IG9wZW4gZnJvbSBcIm9wZW5cIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgdmFsaWRVUkwgZnJvbSBcInZhbGlkLXVybFwiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vbGliL3V0aWwvY2hhbGsuanNcIjtcbmltcG9ydCB7IGRlc2NyaXB0aW9uIH0gZnJvbSBcIi4uL2xpYi91dGlsL2Rlc2NyaXB0aW9uLmpzXCI7XG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCIuLi9saWIvZXhlYy9leGVjLXN5bmMuanNcIjtcbmltcG9ydCB7IGV4ZWNTeW5jUmVzdWx0IH0gZnJvbSBcIi4uL2xpYi9leGVjL2V4ZWMtc3luYy1yZXN1bHQuanNcIjtcbmltcG9ydCB7IHRlbXBsYXRlIH0gZnJvbSBcIi4uL2xpYi91dGlsL3RlbXBsYXRlLmpzXCI7XG5pbXBvcnQgeyB3YWl0IH0gZnJvbSBcIi4uL2xpYi91dGlsL3dhaXQuanNcIjtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWw6IGFueSk6IHZhbCBpcyBGdW5jdGlvbiB7XG4gIHJldHVybiB2YWwgJiYgdHlwZW9mIHZhbCA9PT0gXCJmdW5jdGlvblwiO1xufVxuXG4vKipcbiAqIFdyYXBzIGEgbWV0aG9kIHRoYXQgbm9ybWFsbHkgaGFzIGFuIGFzeW5jIGNhbGxiYWNrIHBhdHRlcm4gaW50byBhIFByb21pc2UsXG4gKiB0aHVzIG1ha2luZyBhd2FpdCBwYXR0ZXJucyBwb3NzaWJsZS5cbiAqL1xuZnVuY3Rpb24gcHJvbWlzaWZ5PFQ+KGNvbnRleHQ6IFQsIG1ldGhvZE5hbWU6IGtleW9mIFQsIC4uLmFyZ3M6IGFueVtdKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBtZXRob2QgPSBjb250ZXh0W21ldGhvZE5hbWVdO1xuXG4gICAgaWYgKCFpc0Z1bmN0aW9uKG1ldGhvZCkpIHtcbiAgICAgIHJlamVjdChuZXcgRXJyb3IoYCR7U3RyaW5nKG1ldGhvZE5hbWUpfSBpcyBub3QgYSBmdW5jdGlvbmApKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBtZXRob2QoLi4uYXJncywgKGVycm9yOiBFcnJvciwgdmFsdWU6IGFueSkgPT4ge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnJvcik7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUodmFsdWUgfHwgdm9pZCAwKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbi8qKlxuICogVGhpcyBsb29rcyBhdCB0aGUgcGFja2FnZS5qc29uIGFuZCBtb2RpZmllcyB0aGUgaG9zdCBmaWxlIHRvIGluY2x1ZGUgdGhlXG4gKiBob3N0cyBzcGVjaWZpZWQgaW4gdGhlIFwiaG9zdHNcIiBwcm9wZXJ0eS4gVGhpcyB3aWxsIG9ubHkgd29yayBpZiB0aGlzIHNjcmlwdFxuICogd2FzIHJhbiBhcyBhbiBhZG1pbmlzdHJhdG9yLlxuICovXG5hc3luYyBmdW5jdGlvbiBjb25maWd1cmVIb3N0cygpIHtcbiAgLy8gR2V0IHRoZSBwYWNrYWdlIGZvciB0aGUgcHJvamVjdFxuICBjb25zdCBwa2cgPSBmcy5yZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKTtcbiAgY29uc3QgaG9zdHMgPSBwa2cuaG9zdHM7XG5cbiAgLy8gTm8gaG9zdHMgcHJlc2VudCwgbWVhbnMgd2UgZG8gbm90IG5lZWQgdG8gZG8gYW55dGhpbmcgaW4gdGhpcyBwcm9jZXNzLlxuICBpZiAoIWhvc3RzKSByZXR1cm47XG5cbiAgLy8gVXBkYXRlIHRoZSBob3N0cyBmaWxlIHRvIG1hdGNoIHRoZSBob3N0cyBzcGVjaWZpZWQgaW4gcGFja2FnZS5qc29uXG4gIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhob3N0cyk7XG4gIGxldCBsaW5lcyA9IGF3YWl0IHByb21pc2lmeShob3N0aWxlLCBcImdldFwiLCBmYWxzZSk7XG4gIGNvbnN0IG5lZWRzSG9zdDogW3N0cmluZywgc3RyaW5nXVtdID0gW107XG5cbiAgY29uc29sZS53YXJuKGNoYWxrLnllbGxvdyhcIlVwZGF0aW5nIGhvc3RzIGZpbGUuLi5cIikpO1xuICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIElmIHRoZSBob3N0IGlzIG5vdCBwcmVzZW50IGluIHRoZSBjb25maWcgYWxyZWFkeSwgYWRkIGl0IGluXG4gICAgICBpZiAoXG4gICAgICAgICFsaW5lcy5maW5kKFxuICAgICAgICAgIChsOiBbc3RyaW5nLCBzdHJpbmddKSA9PiBsWzBdID09PSBrZXkgJiYgbFsxXSA9PT0gaG9zdHNba2V5XVxuICAgICAgICApXG4gICAgICApIHtcbiAgICAgICAgbmVlZHNIb3N0LnB1c2goW2tleSwgaG9zdHNba2V5XV0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIEVycm9yKSBjb25zb2xlLndhcm4oY2hhbGsucmVkKGVyci5tZXNzYWdlKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQXBwZW5kIHRoZSBob3N0cyB0byAvZXRjL2hvc3RzXG4gIGlmIChuZWVkc0hvc3QubGVuZ3RoID4gMCkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIGNoYWxrLnllbGxvdyhcbiAgICAgICAgXCJBZGRpbmcgaG9zdHMgKFlvdSBtYXkgYmUgcHJvbXB0ZWQgZm9yIGFkbWluaXN0cmF0b3IgcGFzc3dvcmQpOlxcblxcdFwiLFxuICAgICAgICBuZWVkc0hvc3QubWFwKChoKSA9PiBgJHtoWzBdfSA9PiAke2hbMV19YCkuam9pbihcIlxcblxcdFwiKVxuICAgICAgKVxuICAgICk7XG5cbiAgICBhd2FpdCBleGVjU3luYyhcInN1ZG9cIiwgW1xuICAgICAgXCJlY2hvXCIsXG4gICAgICBcIkdyYW50ZWQgc3VkbyBhY2Nlc3MgdG8gdXBkYXRlIGhvc3RzIGZpbGUuXCIsXG4gICAgXSk7XG5cbiAgICAvLyBMYXN0IHRocmVlIGNoYXJhY3RlcnMgYXJlIHRoZSBwZXJtaXNzaW9uc1xuICAgIGNvbnN0IGNobW9kQmFrID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoXCJzdGF0XCIsIFtcbiAgICAgIFwiLWZcIixcbiAgICAgIFwiJXBcIixcbiAgICAgIFwiL2V0Yy9ob3N0c1wiLFxuICAgIF0pLnRvU3RyaW5nKCk7XG5cbiAgICAvLyBNYWtlIHRoZSBmaWxlIHdyaXRlYWJsZVxuICAgIGF3YWl0IGV4ZWNTeW5jKFwic3Vkb1wiLCBbXCJjaG1vZFwiLCBcIjY2NlwiLCBcIi9ldGMvaG9zdHNcIl0pO1xuXG4gICAgZm9yIChjb25zdCBob3N0IG9mIG5lZWRzSG9zdCkge1xuICAgICAgZnMuYXBwZW5kRmlsZVN5bmMoXCIvZXRjL2hvc3RzXCIsIGAke2hvc3RbMF19ICR7aG9zdFsxXX1gKTtcbiAgICB9XG5cbiAgICBmcy5hcHBlbmRGaWxlU3luYyhcIi9ldGMvaG9zdHNcIiwgYFxcbmApO1xuXG4gICAgLy8gUmVzdG9yZSB0aGUgcGVybWlzc2lvbnNcbiAgICBhd2FpdCBleGVjU3luYyhcInN1ZG9cIiwgW1xuICAgICAgXCJjaG1vZFwiLFxuICAgICAgY2htb2RCYWsuc3Vic3RyaW5nKGNobW9kQmFrLmxlbmd0aCAtIDQpLnRyaW0oKSxcbiAgICAgIFwiL2V0Yy9ob3N0c1wiLFxuICAgIF0pO1xuICB9XG5cbiAgYXdhaXQgd2FpdCg1MDApO1xuXG4gIC8vIEFmdGVyIHVwZGF0aW5nIHRoZSBob3N0IGZpbGUsIGxldCdzIGVuc3VyZSBhbGwgaG9zdHMgd2VyZSBhZGRlZC5cbiAgY29uc29sZS53YXJuKGNoYWxrLnllbGxvdyhcIlZlcmlmeWluZyBob3N0cyBmaWxlLi4uXCIpKTtcbiAgbGluZXMgPSBhd2FpdCBwcm9taXNpZnkoaG9zdGlsZSwgXCJnZXRcIiwgZmFsc2UpO1xuICBsZXQgZGlkRmFpbCA9IGZhbHNlO1xuXG4gIG5lZWRzSG9zdC5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICBpZiAoXG4gICAgICAhbGluZXMuZmluZCgobDogW3N0cmluZywgc3RyaW5nXSkgPT4gbFswXSA9PT0ga2V5ICYmIGxbMV0gPT09IGhvc3RzW2tleV0pXG4gICAgKSB7XG4gICAgICBkaWRGYWlsID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgY2hhbGsucmVkQnJpZ2h0KFxuICAgICAgICAgIGBGYWlsZWQgdG8gYWRkIGhvc3Q6ICR7Y2hhbGsueWVsbG93QnJpZ2h0KFxuICAgICAgICAgICAga2V5XG4gICAgICAgICAgKX0gPT4gJHtjaGFsay55ZWxsb3dCcmlnaHQodmFsdWUpfWBcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIGlmIChkaWRGYWlsKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgY2hhbGsucmVkKGRlc2NyaXB0aW9uYFxuICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICogU29tZSBob3N0cyBzcGVjaWZpZWQgaW4gdGhlIHBhY2thZ2UuanNvbiB3ZXJlIG5vdCBhYmxlIHRvIGJlIHdyaXR0ZW4gICpcbiAgICAgICAgKiB0byB0aGUgaG9zdHMgZmlsZSBmb3IgdGhlIHN5c3RlbS4gWW91IGNhbiBhbWVuZCB0aGlzIGJ5IGVkaXRpbmcgdGhlICAgKlxuICAgICAgICAqIGZpbGUgeW91cnNlbGYsIG9yIGJ5IHRyeWluZyB0byBydW4gdGhpcyBzY3JpcHQgYWdhaW4gYXMgYW4gYWRtaW4uICAgICAqXG4gICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgIGApXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvcGVuVVJMKFxuICB1cmxDb25maWc6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4sXG4gIHVybDogc3RyaW5nLFxuICBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+XG4pIHtcbiAgbGV0IHRhcmdldFVybCA9IHVybDtcblxuICBpZiAodmFsaWRVUkwuaXNXZWJVcmkodXJsKSkge1xuICAgIHRhcmdldFVybCA9IHVybDtcbiAgfSBlbHNlIGlmICh1cmxDb25maWdbdXJsXSkge1xuICAgIHRhcmdldFVybCA9IHVybENvbmZpZ1t1cmxdO1xuICB9XG5cbiAgLy8gUmVwbGFjZSBhbnlcbiAgY29uc3QgcmVzdWx0ID0gdGVtcGxhdGUoe1xuICAgIG9wdGlvbnMsXG4gICAgdGVtcGxhdGU6IHRhcmdldFVybCxcbiAgfSk7XG5cbiAgaWYgKHJlc3VsdC51bnJlc29sdmVkVGVtcGxhdGVPcHRpb25zLnNpemUgPiAwKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgY2hhbGsucmVkKFxuICAgICAgICBkZXNjcmlwdGlvbmBcbiAgICAgICAgICBZb3UgbXVzdCBzcGVjaWZ5IHRoZXNlIGVudiB2YXJpYWJsZXMgZm9yIHRoaXMgVVJMIHRvIHdvcms6XG4gICAgICAgICAgJHtBcnJheS5mcm9tKHJlc3VsdC51bnJlc29sdmVkVGVtcGxhdGVPcHRpb25zLmtleXMoKSkuam9pbihcIlxcblxcdFwiKX1cbiAgICAgICAgYFxuICAgICAgKVxuICAgICk7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBlbnYgY29uZmlndXJhdGlvbiBmb3IgVVJMXCIpO1xuICB9XG5cbiAgdGFyZ2V0VXJsID0gcmVzdWx0LnRlbXBsYXRlO1xuXG4gIGlmICh2YWxpZFVSTC5pc1dlYlVyaSh0YXJnZXRVcmwpKSB7XG4gICAgY29uc29sZS53YXJuKFwiTmF2aWdhdGluZyB0bzpcIiwgY2hhbGsuY3lhbkJyaWdodEJvbGQodGFyZ2V0VXJsKSk7XG4gICAgb3Blbih0YXJnZXRVcmwpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUud2FybihcIkNhbiBub3Qgb3BlbiBpbnZhbGlkIFVSTDpcIiwgY2hhbGsucmVkQnJpZ2h0Qm9sZCh0YXJnZXRVcmwpKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgY29tbWFuZCBzaW1wbHkgb3BlbnMgYSBVUkwgdmlhIGFuIG5wbSBjb21tYW5kLiBUaGUgdmFsdWUgcHJvdmlkZWQgY2FuIGJlXG4gKiBhIHZhbGlkIFVSSSBPUiBpdCBjYW4gYmUgYSBrZXkgZm9yIHRoZSB2YWx1ZSBmb3VuZCBpbiBwYWNrYWdlLmpzb24gXCJ1cmxcIi5cbiAqXG4gKiBlZyAtXG4gKiB1cmw6IFwibm9kZSBiaW4vbWFpbiB1cmwgXFxcImh0dHBzOi8vZmlnbWEuY29tXFxcIlwiXG4gKlxuICogb3IgaWYgdGhlcmUgaXMgYSBcImZpZ21hXCIgZW50cnkgaW4gdGhlIFwidXJsXCIgcHJvcGVydHkgaW4gcGFja2FnZS5qc29uIC1cbiAqIHVybDogXCJub2RlIGJpbi9tYWluIHVybCBcXFwiZmlnbWFcXFwiXCJcbiAqL1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKHVybD86IHN0cmluZyB8IHN0cmluZ1tdLCBvcHRpb25zPzogc3RyaW5nW10pIHtcbiAgY29uc3QgcGtnID0gZnMucmVhZEpTT05TeW5jKHBhdGgucmVzb2x2ZShcInBhY2thZ2UuanNvblwiKSk7XG4gIGNvbnN0IHVybENvbmZpZzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHBrZz8udXJsIHx8IHt9O1xuICBjb25zdCBvcHRpb25zQ29uZmlnOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID1cbiAgICBvcHRpb25zPy5yZWR1Y2UoXG4gICAgICAocCwgb3B0LCBpKSA9PiB7XG4gICAgICAgIHBbYCR7aSArIDF9YF0gPSBvcHQ7XG4gICAgICAgIHJldHVybiBwO1xuICAgICAgfSxcbiAgICAgIHt9IGFzIFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbiAgICApIHx8IHt9O1xuXG4gIGlmICghdXJsIHx8IHVybC5sZW5ndGggPD0gMCkge1xuICAgIGNvbnNvbGUud2FybihkZXNjcmlwdGlvbmBcbiAgICAgIEF2YWlsYWJsZSBVUkxzOlxuICAgICAgICAke2NoYWxrLmN5YW5CcmlnaHRCb2xkKE9iamVjdC5rZXlzKHVybENvbmZpZykuam9pbihcIlxcbiAgICAgICAgXCIpKX1cbiAgICBgKTtcblxuICAgIHJldHVybjtcbiAgfVxuXG4gIGF3YWl0IGNvbmZpZ3VyZUhvc3RzKCk7XG5cbiAgY29uc3QgYWxsT3B0aW9ucyA9IHtcbiAgICAuLi5wcm9jZXNzLmVudixcbiAgICAuLi5vcHRpb25zQ29uZmlnLFxuICB9O1xuXG4gIGlmIChBcnJheS5pc0FycmF5KHVybCkpIHtcbiAgICB1cmwuZm9yRWFjaCgodXJpKSA9PiB7XG4gICAgICBvcGVuVVJMKHVybENvbmZpZywgdXJpLCBhbGxPcHRpb25zKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBvcGVuVVJMKHVybENvbmZpZywgdXJsLCBhbGxPcHRpb25zKTtcbiAgfVxufVxuIiwKICAiaW1wb3J0IGNoaWxkX3Byb2Nlc3MgZnJvbSBcImNoaWxkX3Byb2Nlc3NcIjtcblxuLyoqXG4gKiBUaGlzIGNoZWNrcyB0aGUgY3VycmVudCBnaXQgcmVwb3NpdG9yeSB0byBzZWUgaWYgaXQgaGFzIHVuY29taXR0ZWQgY2hhbmdlc1xuICogbGluZ2VyaW5nLiBUaGlzIGNoZWNrIGlzIG5lY2Vzc2FyeSBiZWZvcmUgc29tZSBwcm9jZXNzIGNhbiBiZSBleGVjdXRlZFxuICogc2FmZWx5LlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2l0SGFzQ2hhbmdlcygpIHtcbiAgdHJ5IHtcbiAgICAvLyBUT0RPOiBmaW5kIGEgbmljZXIgd2F5IHRvIGhhbmRsZSBwaXBlZCBjb21tYW5kcyBzbyB3ZSBjYW4gYWJzdHJhY3QgdGhlXG4gICAgLy8gdXNlIG9mIGNoaWxkX3Byb2Nlc3MgaGVyZS5cbiAgICBjaGlsZF9wcm9jZXNzLmV4ZWNTeW5jKFxuICAgICAgXCJnaXQgc3RhdHVzIC0tcG9yY2VsYWluPXYxIDI+L2Rldi9udWxsIHwgd2MgLWwgfCBncmVwIDBcIixcbiAgICAgIHtcbiAgICAgICAgZW52OiBwcm9jZXNzLmVudixcbiAgICAgIH1cbiAgICApO1xuICB9IGNhdGNoIChfZSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwKICAiaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiLi4vZXhlYy9leGVjLXN5bmMuanNcIjtcbmltcG9ydCB7IGdpdEhhc0NoYW5nZXMgfSBmcm9tIFwiLi9naXQtaGFzLWNoYW5nZXMuanNcIjtcbmltcG9ydCB7IHByb21wdENvbmZpcm0gfSBmcm9tIFwiLi4vcHJvbXB0L3Byb21wdC1jb25maXJtLmpzXCI7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgY3VycmVudCBjb250ZXh0IGJhY2sgdG8gZGV2IGFuZCByZXNldHMgdG8gdGhlIGxhdGVzdCBpbiBkZXYuXG4gKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBvcGVyYXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAqXG4gKiBJZiBmYWxzZSBpcyByZXR1cm5lZCwgdGhlIGdpdCBzdGF0ZSBzaG91bGQgYmUgY29uc2lkZXJlZCB1bmRlZmluZWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnaXRSZXR1cm5Ub0Rldih3aXRoUHJvbXB0PzogYm9vbGVhbikge1xuICAvLyBJZiBhIHByb21wdCB3YXMgcmVxdWVzdGVkLCB3ZSB3aWxsIGFzayB0aGUgdXNlciBpZiB0aGV5IHdpc2ggdG8gbGV0IHRoaXNcbiAgLy8gb3BlcmF0aW9uIGhhcHBlbi5cbiAgaWYgKHdpdGhQcm9tcHQpIHtcbiAgICBjb25zdCBzaG91bGRHaXRCcmFuY2ggPSBhd2FpdCBwcm9tcHRDb25maXJtKGBcbiAgICAgIFdvdWxkIHlvdSBsaWtlIHRvIHJldHVybiBiYWNrIHRvIGRldmVsb3BtZW50P1xuICAgICAgUnVucyB0aGUgZm9sbG93aW5nOlxuICAgICAgICBnaXQgZmV0Y2hcbiAgICAgICAgZ2l0IGNoZWNrb3V0IGRldlxuICAgICAgICBnaXQgcmVzZXQgLS1oYXJkIG9yaWdpbi9kZXZcbiAgICBgKTtcblxuICAgIGlmICghc2hvdWxkR2l0QnJhbmNoKSByZXR1cm47XG4gIH1cblxuICBpZiAoYXdhaXQgZ2l0SGFzQ2hhbmdlcygpKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiQ2FuIG5vdCByZXR1cm4gdG8gZGV2IGJyYW5jaCBhcyBjaGFuZ2VzIGFyZSBwcmVzZW50IG9uIHRoZSBjdXJyZW50IGJyYW5jaC5cIlxuICAgICk7XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBsZXQgZmFpbCA9IGZhbHNlO1xuXG4gIGlmICghKGF3YWl0IGV4ZWNTeW5jKFwiZ2l0XCIsIFtcImZldGNoXCJdKSkpIGZhaWwgPSB0cnVlO1xuICBpZiAoIShhd2FpdCBleGVjU3luYyhcImdpdFwiLCBbXCJjaGVja291dFwiLCBcImRldlwiXSkpKSBmYWlsID0gdHJ1ZTtcbiAgaWYgKCEoYXdhaXQgZXhlY1N5bmMoXCJnaXRcIiwgW1wicmVzZXRcIiwgXCItLWhhcmRcIiwgXCJvcmlnaW4vZGV2XCJdKSkpIGZhaWwgPSB0cnVlO1xuXG4gIGlmIChmYWlsKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkNvdWxkIG5vdCByZXR1cm4gdG8gZGV2IGJyYW5jaC5cIik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgSWdub3JlIGZyb20gXCJpZ25vcmVcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuLi8uLi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCIuLi8uLi9leGVjL2V4ZWMtc3luYy5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdERlcGVuZGVuY2llcyB9IGZyb20gXCIuLi8uLi90YXJnZXQtcHJvamVjdC90YXJnZXQtcHJvamVjdC1kZXBlbmRlbmNpZXMuanNcIjtcbmltcG9ydCB7IHdhaXQgfSBmcm9tIFwiLi4vLi4vdXRpbC93YWl0LmpzXCI7XG5cbmNvbnN0IGdpdElnbm9yZVBhdGggPSBwYXRoLnJlc29sdmUoXCIuZ2l0aWdub3JlXCIpO1xubGV0IGlnbm9yZSA9IElnbm9yZS5kZWZhdWx0KCk7XG5cbmlmIChmcy5leGlzdHNTeW5jKGdpdElnbm9yZVBhdGgpKSB7XG4gIGlnbm9yZSA9IGlnbm9yZS5hZGQoZnMucmVhZEZpbGVTeW5jKGdpdElnbm9yZVBhdGgpLnRvU3RyaW5nKCkpO1xufVxuXG4vKipcbiAqIEJ1bmRsZSB0aGUgY29tbWFuZHNcbiAqL1xuYXN5bmMgZnVuY3Rpb24gYnVpbGRDb21tYW5kcygpIHtcbiAgLy8gV2UgZ2V0IGFsbCBkZXBlbmRlbmNpZXMgb2YgdGhlIHByb2plY3QgYW5kIGNvbnNpZGVyIHRoZW0gZXh0ZXJuYWwuIFRoaXNcbiAgLy8gaW1wcm92ZXMgdGhlIGFiaWxpdHkgZm9yIHRoZSBjb2RlIHRvIGJlIGJ1bmRsZWQgc2luY2UgYmluIGNvbW1hbmRzIGhpdCBhXG4gIC8vIExPVCBvZiBzbmFncyBpbiBob3cgdGhleSBhcmUgaW1wbGVtZW50ZWQuXG4gIGNvbnN0IGRlcHMgPSBhd2FpdCB0YXJnZXRQcm9qZWN0RGVwZW5kZW5jaWVzKCk7XG5cbiAgLy8gQnVpbGQgdGhlIHNvdXJjZSBkaXJlY3RseSB0byB0aGUgZGlzdCBmb2xkZXIuIFRoaXMga2VlcHMgc2FtZSByZWxhdGl2ZVxuICAvLyBkZXB0aCBmb3IgYWxsIGZpbGVzIGFzIHdoZW4gdGhleSBhcmUgaW4gdGhlIGJpbiBmb2xkZXIgdGhlbXNlbHZlcyBhbmRcbiAgLy8gcmVkdWNlcyBwcm9qZWN0IGNvbXBsZXhpdHkuXG4gIGNvbnNvbGUud2FybihcIkJ1aWxkaW5nIGZ1bGwgZGlzdHJpYnV0aW9uLi4uXCIpO1xuICBsZXQgcmVzdWx0cyA9IGF3YWl0IEJ1bi5idWlsZCh7XG4gICAgZW50cnlwb2ludHM6IFtwYXRoLnJlc29sdmUoXCIuL2Jpbi9tYWluLnRzXCIpXSxcbiAgICB0YXJnZXQ6IFwiYnVuXCIsXG4gICAgZXh0ZXJuYWw6IE9iamVjdC5rZXlzKGRlcHMpLFxuICAgIG1pbmlmeTogdHJ1ZSxcbiAgICBzb3VyY2VtYXA6IFwiaW5saW5lXCIsXG4gIH0pO1xuXG4gIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzdWx0cy5vdXRwdXRzKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgXCJXcml0aW5nIGJpbiBidW5kbGUgcmVzb3VyY2U6XCIsXG4gICAgICBjaGFsay5jeWFuQnJpZ2h0Qm9sZChyZXNvdXJjZS5wYXRoKVxuICAgICk7XG5cbiAgICBhd2FpdCBCdW4ud3JpdGUocGF0aC5yZXNvbHZlKFwiLi9kaXN0L2JpblwiLCByZXNvdXJjZS5wYXRoKSwgcmVzb3VyY2UpO1xuICB9XG5cbiAgY29uc29sZS53YXJuKFwiQnVpbGRpbmcgZ2ltcGVkIGRpc3RyaWJ1dGlvbi4uLlwiKTtcbiAgcmVzdWx0cyA9IGF3YWl0IEJ1bi5idWlsZCh7XG4gICAgZW50cnlwb2ludHM6IFtwYXRoLnJlc29sdmUoXCIuL2Jpbi9tYWluLWdpbXAudHNcIildLFxuICAgIHRhcmdldDogXCJub2RlXCIsXG4gICAgZXh0ZXJuYWw6IE9iamVjdC5rZXlzKGRlcHMpLFxuICAgIG1pbmlmeTogdHJ1ZSxcbiAgICBzb3VyY2VtYXA6IFwiaW5saW5lXCIsXG4gIH0pO1xuXG4gIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzdWx0cy5vdXRwdXRzKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgXCJXcml0aW5nIGJpbiBidW5kbGUgcmVzb3VyY2U6XCIsXG4gICAgICBjaGFsay5jeWFuQnJpZ2h0Qm9sZChyZXNvdXJjZS5wYXRoKVxuICAgICk7XG5cbiAgICBhd2FpdCBCdW4ud3JpdGUocGF0aC5yZXNvbHZlKFwiLi9kaXN0L2JpblwiLCByZXNvdXJjZS5wYXRoKSwgcmVzb3VyY2UpO1xuICB9XG5cbiAgY29uc29sZS53YXJuKFwiQ29weWluZyBlbnRyeSBjcm9zcy1wbGF0Zm9ybSBkaXN0cmlidXRpb24uLi5cIik7XG4gIGZzLmNvcHlGaWxlU3luYyhcbiAgICBwYXRoLnJlc29sdmUoXCIuL2Jpbi9tYWluLWVudHJ5LmNqc1wiKSxcbiAgICBwYXRoLnJlc29sdmUoXCIuL2Rpc3QvYmluL21haW4tZW50cnkuY2pzXCIpXG4gICk7XG59XG5cbi8qKlxuICogQnVpbGRzIHRoZSBkaXN0cmlidXRpb24gdmVyc2lvbnMgb2Ygc2hpbSBmaWxlcy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gYnVpbGRTaGltKCkge1xuICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwiLi9iaW4vc2hpbVwiKSkpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiTm8gc2hpbSBkaXN0cmlidXRpb24gZmlsZXMgZm91bmQgdG8gYmUgYnVpbHRcIik7XG4gIH1cblxuICAvLyAgRGVsZXRlIHRoZSBjdXJyZW50IHNoaW0gZGlzdHJpYnV0aW9uXG4gIGlmIChmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShcIi4vc2hpbVwiKSkpIHtcbiAgICBmcy5yZW1vdmVTeW5jKHBhdGgucmVzb2x2ZShcIi4vc2hpbVwiKSk7XG4gIH1cblxuICAvLyBXZSBnZXQgYWxsIGRlcGVuZGVuY2llcyBvZiB0aGUgcHJvamVjdCBhbmQgY29uc2lkZXIgdGhlbSBleHRlcm5hbC4gVGhpc1xuICAvLyBpbXByb3ZlcyB0aGUgYWJpbGl0eSBmb3IgdGhlIGNvZGUgdG8gYmUgYnVuZGxlZCBzaW5jZSBiaW4gY29tbWFuZHMgaGl0IGFcbiAgLy8gTE9UIG9mIHNuYWdzIGluIGhvdyB0aGV5IGFyZSBpbXBsZW1lbnRlZC5cbiAgY29uc3QgZGVwcyA9IGF3YWl0IHRhcmdldFByb2plY3REZXBlbmRlbmNpZXMoKTtcblxuICBjb25zb2xlLndhcm4oXCJCdWlsZGluZyBzaGltIGRpc3RyaWJ1dGlvbi4uLlwiKTtcbiAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IEJ1bi5idWlsZCh7XG4gICAgZW50cnlwb2ludHM6IFtwYXRoLnJlc29sdmUoXCIuL2Jpbi9zaGltL2luZGV4LnRzXCIpXSxcbiAgICB0YXJnZXQ6IFwibm9kZVwiLFxuICAgIGV4dGVybmFsOiBPYmplY3Qua2V5cyhkZXBzKSxcbiAgICBtaW5pZnk6IHRydWUsXG4gIH0pO1xuXG4gIC8vIFdyaXRlIG91ciBmaWxlcyB0byBhIG5hbWVzcGFjZSBmb2xkZXIgdGhhdCBjYW4gY29udGFpbiBhbnkgcHJvamVjdCBpbXBvcnRzXG4gIC8vIHdpdGhpbiB0aGUgc2hpbSBwcm9qZWN0IHdpdGhvdXQgcG9sbHV0aW5nIHRoZSBwcm9qZWN0IHdpdGggZGlzdHJpYnV0aW9uXG4gIC8vIGZpbGVzLlxuICBmb3IgKGNvbnN0IHJlc291cmNlIG9mIHJlc3VsdHMub3V0cHV0cykge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiV3JpdGluZyBzaGltIGJ1bmRsZSByZXNvdXJjZTpcIixcbiAgICAgIGNoYWxrLmN5YW5CcmlnaHRCb2xkKHJlc291cmNlLnBhdGgpXG4gICAgKTtcblxuICAgIGF3YWl0IEJ1bi53cml0ZShcbiAgICAgIHBhdGgucmVzb2x2ZShcIi4vc2hpbS9zcmMvYmluL3NoaW1cIiwgcmVzb3VyY2UucGF0aCksXG4gICAgICByZXNvdXJjZVxuICAgICk7XG4gIH1cblxuICAvLyBXcml0ZSBhIGJhcnJlbCBleHBvcnQgaW4gdGhlIHNoaW0gZm9sZGVyIHRvIG5vcm1hbGl6ZSB0aGUgaW1wb3J0IHBhdGggaW4gYVxuICAvLyB3YXkgdGhhdCBpcyBjb252ZW5pZW50IGZvciB0aGUgZGV2ZWxvcGVyOlxuICAvLyBpbXBvcnQgeyAuLi4gfSBmcm9tIFwiZGV2b3BzL3NoaW0vaW5kZXguanNcIjtcbiAgZnMud3JpdGVGaWxlU3luYyhcbiAgICBwYXRoLnJlc29sdmUoXCIuL3NoaW0vaW5kZXguanNcIiksXG4gICAgYGV4cG9ydCAqIGZyb20gXCIuL3NyYy9iaW4vc2hpbS9pbmRleC5qc1wiO1xcbmAsXG4gICAgeyBlbmNvZGluZzogXCJ1dGYtOFwiIH1cbiAgKTtcbiAgZnMud3JpdGVGaWxlU3luYyhcbiAgICBwYXRoLnJlc29sdmUoXCIuL3NoaW0vaW5kZXguZC50c1wiKSxcbiAgICBgZXhwb3J0ICogZnJvbSBcIi4vc3JjL2Jpbi9zaGltL2luZGV4LmQudHNcIjtcXG5gLFxuICAgIHsgZW5jb2Rpbmc6IFwidXRmLThcIiB9XG4gICk7XG5cbiAgLy8gV3JpdGUgdGhlIHR5cGUgZGVjYWxyYXRpb25zIGZvciB0aGUgZmlsZXMuIE1ha2UgYSB0ZW1wIHRzY29uZmlnIHByb2plY3RcbiAgLy8gZmlsZSB0byB0YXJnZXQgdGhlIHNoaW0gc291cmNlIGZpbGVzIG9ubHkuXG4gIGNvbnN0IHRzQ29uZmlnID0gZnMucmVhZEpTT05TeW5jKHBhdGgucmVzb2x2ZShcInRzY29uZmlnLmpzb25cIikpO1xuICB0c0NvbmZpZy5leGNsdWRlID0gdHNDb25maWcuZXhjbHVkZSB8fCBbXTtcbiAgdHNDb25maWcuZXhjbHVkZS5wdXNoKFwiLi9iaW4vbGliLyoqXCIpO1xuICB0c0NvbmZpZy5pbmNsdWRlID0gW1wiLi9iaW4vc2hpbVwiXTtcbiAgZnMud3JpdGVKU09OU3luYyhwYXRoLnJlc29sdmUoXCJ0c2NvbmZpZy50ZW1wLmpzb25cIiksIHRzQ29uZmlnKTtcbiAgLy8gRW5zdXJlIHRoZSBmaWxlIHN5c3RlbSBoYXMgZmx1c2hlZCB0aGUgdGVtcCBmaWxlIHRvIGRpc2tcbiAgYXdhaXQgd2FpdCg1MDApO1xuXG4gIC8vIFJ1biB0c2MgYW5kIG91dHB1dCB0aGVcbiAgaWYgKFxuICAgICFleGVjU3luYyhcInRzY1wiLCBbXG4gICAgICBcIi1kXCIsXG4gICAgICBcIi0tZW1pdERlY2xhcmF0aW9uT25seVwiLFxuICAgICAgXCItLXByZXR0eVwiLFxuICAgICAgXCItLW91dERpclwiLFxuICAgICAgcGF0aC5yZXNvbHZlKFwiLi9zaGltL3NyYy9iaW5cIiksXG4gICAgICBcIi0tcHJvamVjdFwiLFxuICAgICAgcGF0aC5yZXNvbHZlKFwidHNjb25maWcudGVtcC5qc29uXCIpLFxuICAgIF0pXG4gICkge1xuICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBjb21waWxlIHR5cGUgZGVjbGFyYXRpb25zIGZvciB0aGUgc2hpbSBmaWxlcy5cIik7XG4gICAgZnMucmVtb3ZlU3luYyhwYXRoLnJlc29sdmUoXCJ0c2NvbmZpZy50ZW1wLmpzb25cIikpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIC8vIFJlbW92ZSB0aGUgdGVtcCBmaWxlXG4gIGZzLnJlbW92ZVN5bmMocGF0aC5yZXNvbHZlKFwidHNjb25maWcudGVtcC5qc29uXCIpKTtcbn1cblxuLyoqXG4gKiBXZSBtdXN0IGNvcHkgYWxsIG9mIHRoZSB0ZW1wbGF0aW5nIGZpbGVzIGFuZCBzdHJ1Y3R1cmUgdG8gdGhlIGRpc3RyaWJ1dGlvbiBhc1xuICogdGhvc2UgZmlsZXMgYXJlIHV0aWxpemVkIGluIG1hbnkgb2YgdGhlIGNvbW1hbmRzIGFuZCB0aGUgdGVtcGxhdGluZyBzeXN0ZW0gYXNcbiAqIGEgd2hvbGUgbXVzdCB1c2UgdGhlbSBmb3IgdGhlIHNha2Ugb2YuLi4ueW91IGtub3cuLi50ZW1wbGF0aW5nLi4uXG4gKlxuICogVGhpcyBwcmVzZW50cyBzb21lIGNoYWxsZW5nZXMgYXMgdGhlIHRlbXBsYXRpbmcgc3lzdGVtIGhhcyBncm93biB0byBiZSBhXG4gKiByb2J1c3Qgc3lzdGVtIGZvciB3aGljaCBpdCBoYXMgdGhlIGNhcGFiaWxpdGllcyB0byByZXBsYWNlIG1vcmUgY29tcGxleFxuICogY29tbWFuZHMgc3VjaCBhcyBgY29tcG9uZW50IG5ld2AuIEJ1dCB0aGlzIGNvbXBsZXhpdHkgbWVhbnMgdGhlIHRlbXBsYXRlc1xuICogdGhlbXNlbHZlcyBub3cgaGF2ZSBhIHN0cnVjdHVyZSB0aGF0IHJlcXVpcmVzIHRoZSB0ZW1wbGF0ZSB0byBiZSB0cmFuc3BpbGVkXG4gKiBzbyB0aGF0IGl0IGRvZXMgbm90IGNhcnJ5IGEgYnVyZGVuIG9mIGNvbXBsZXhpdHkgd2hlbiB0cnlpbmcgdG8gcnVuIHRoZVxuICogY29tbWFuZC4gaWUgLSBpZiBhIHRlbXBsYXRlIGluIHRoZSBkZXZvcHMgZGlyZWN0b3J5IHV0aWxpemVzIHRvb2xpbmcgZnJvbSB0aGVcbiAqIGRldm9wcyBwcm9qZWN0IHNwZWNpZmljYWxseSwgd2UgZG9uJ3Qgd2FudCB0byBoYXZlIHRvIGNvcHkgYWxsIG9mIHRoYXRcbiAqIHRvb2xpbmcgb3ZlciB0byB0aGUgZGlzdHJpYnV0aW9uIGp1c3QgdG8gbWFrZSB0aGUgdGVtcGxhdGUgd29yay5cbiAqXG4gKiBUaGlzIHdvdWxkIGFsc28gY2F1c2UgaHVnZSBpc3N1ZXMgZm9yIG92ZXJyaWRlcyBhbmQgd2hhdCBub3QuIFNvIHdlIGJ1bmRsZVxuICogdGhlIHRlbXBsYXRlIHRvIHJlZHVjZSB0aGlzIGNvbXBsZXhpdHkgYW5kIG1ha2UgdGhlIHRlbXBsYXRlIGd1YXJhbnRlZWQgdG9cbiAqIHdvcmsgZXZlbiBpbiB0aGUgdGFyZ2V0IHByb2plY3RzIHdpdGggbXVjaCBsZXNzIGZ1c3MuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNvcHlUZW1wbGF0ZXMoKSB7XG4gIC8vIFdlIG5vdyBuZWVkIHRvIGNvcHkgYW55IGZpbGVzIHRoYXQgYXJlIFwicmVhZFwiIGZyb20gdGhlIGJpbiBmb2xkZXIgc3VjaCBhc1xuICAvLyB0ZW1wbGF0ZXMuXG4gIGNvbnNvbGUud2FybihcbiAgICBjaGFsay55ZWxsb3dCcmlnaHQoXCJDb3B5aW5nIHRlbXBsYXRlIGZpbGVzIGZvciBiaW4gZGlzdHJpYnV0aW9uXCIpXG4gICk7XG5cbiAgY29uc3QgdGVtcGxhdGVTcmMgPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBcIi4uLy4uL3RlbXBsYXRlXCIpO1xuICBjb25zdCB0ZW1wbGF0ZURpc3QgPSBwYXRoLnJlc29sdmUoXCIuL2Rpc3QvYmluL3RlbXBsYXRlXCIpO1xuXG4gIGZzLmNvcHlTeW5jKHRlbXBsYXRlU3JjLCB0ZW1wbGF0ZURpc3QpO1xuXG4gIC8vIEZpbmQgYWxsIG9mIHRoZSBpbmRleCBmaWxlcyB0aGF0IHdpbGwgbmVlZCB0byBiZSBjb21waWxlZFxuICBjb25zdCB0ZW1wbGF0ZXMgPSBmc1xuICAgIC5yZWFkZGlyU3luYyh0ZW1wbGF0ZURpc3QpXG4gICAgLm1hcCgoZmlsZSkgPT4gcGF0aC5yZXNvbHZlKHRlbXBsYXRlRGlzdCwgZmlsZSwgXCJpbmRleC50c1wiKSlcbiAgICAuZmlsdGVyKChmaWxlKSA9PiB7XG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAvLyBXZSBnZXQgYWxsIGRlcGVuZGVuY2llcyBvZiB0aGUgcHJvamVjdCBhbmQgY29uc2lkZXIgdGhlbSBleHRlcm5hbC4gVGhpc1xuICAvLyBpbXByb3ZlcyB0aGUgYWJpbGl0eSBmb3IgdGhlIGNvZGUgdG8gYmUgYnVuZGxlZCBzaW5jZSBiaW4gY29tbWFuZHMgaGl0IGFcbiAgLy8gTE9UIG9mIHNuYWdzIGluIGhvdyB0aGV5IGFyZSBpbXBsZW1lbnRlZC5cbiAgY29uc3QgZGVwcyA9IGF3YWl0IHRhcmdldFByb2plY3REZXBlbmRlbmNpZXMoKTtcbiAgbGV0IGRpZEVycm9yID0gZmFsc2U7XG5cbiAgLy8gQnVpbGQgdGhlIHRlbXBsYXRlc1xuICBmb3IgKGNvbnN0IHRlbXBsYXRlIG9mIHRlbXBsYXRlcykge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBCdW4uYnVpbGQoe1xuICAgICAgZW50cnlwb2ludHM6IFt0ZW1wbGF0ZV0sXG4gICAgICB0YXJnZXQ6IFwiYnVuXCIsXG4gICAgICBleHRlcm5hbDogT2JqZWN0LmtleXMoZGVwcyksXG4gICAgICBtaW5pZnk6IHRydWUsXG4gICAgfSk7XG5cbiAgICAvLyBFbnN1cmUgdGhlIGJ1bmRsZSBwcm9kdWNlZCByZXN1bHRzIG9yIHRoaXMgbWVhbnMgdGhlIGJ1aWxkIGZhaWxlZFxuICAgIGlmICghcmVzdWx0cy5zdWNjZXNzKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBjaGFsay5yZWRCcmlnaHRCb2xkKFwiQnVpbGQgZmFpbGVkIGZvciB0ZW1wbGF0ZTpcIiksXG4gICAgICAgIGNoYWxrLmN5YW5CcmlnaHRCb2xkKFxuICAgICAgICAgIHBhdGgucmVsYXRpdmUodGVtcGxhdGVEaXN0LCBwYXRoLmRpcm5hbWUodGVtcGxhdGUpKVxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBmb3IgKGNvbnN0IG1lc3NhZ2Ugb2YgcmVzdWx0cy5sb2dzKSB7XG4gICAgICAgIC8vIEJ1biB3aWxsIHByZXR0eSBwcmludCB0aGUgbWVzc2FnZSBvYmplY3RcbiAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTtcbiAgICAgIH1cblxuICAgICAgZGlkRXJyb3IgPSB0cnVlO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzdWx0cy5vdXRwdXRzKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiV3JpdGluZyB0ZW1wbGF0ZSBlbnRyeSBmaWxlOlwiLFxuICAgICAgICBjaGFsay5jeWFuQnJpZ2h0Qm9sZChcbiAgICAgICAgICBwYXRoLnJlbGF0aXZlKFxuICAgICAgICAgICAgdGVtcGxhdGVEaXN0LFxuICAgICAgICAgICAgcGF0aC5yZXNvbHZlKHBhdGguZGlybmFtZSh0ZW1wbGF0ZSksIHJlc291cmNlLnBhdGgpXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBhd2FpdCBCdW4ud3JpdGUoXG4gICAgICAgIHBhdGgucmVzb2x2ZShwYXRoLmRpcm5hbWUodGVtcGxhdGUpLCByZXNvdXJjZS5wYXRoKSxcbiAgICAgICAgcmVzb3VyY2VcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgaWYgKGRpZEVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIGNoYWxrLnJlZEJyaWdodEJvbGQoXG4gICAgICAgIFwiU29tZSB0ZW1wbGF0ZXMgaGF2ZSBlcnJvcnMgKHNlZSBhYm92ZSksIHN0b3BwaW5nIHRoZSBidWlsZCBwcm9jZXNzLlwiXG4gICAgICApXG4gICAgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cblxuLyoqXG4gKiBDb3B5IGFueSBzdXBwb3J0aW5nIGZpbGVzIHRoYXQgYXJlIHJlcXVpcmVkIGZvciB0aGUgY29tbWFuZHMgdG8gd29ya1xuICogY29ycmVjdGx5LlxuICovXG5hc3luYyBmdW5jdGlvbiBjb3B5QXJ0aWZhY3RzKCkge1xuICAvLyBDb3B5IHRoZSBzaCBzY3JpcHQgZm9yIHN0YXJ0aW5nIHVwIHRoZSBiaW4gY29tbWFuZHNcbiAgY29uc29sZS53YXJuKFxuICAgIGNoYWxrLnllbGxvd0JyaWdodChcIkNvcHlpbmcgZW50cnkgc2hlbGwgc2NyaXB0IGZvciBiaW4gZGlzdHJpYnV0aW9uXCIpXG4gICk7XG5cbiAgZnMuY29weVN5bmMoXG4gICAgcGF0aC5yZXNvbHZlKFwiLi9iaW4vbWFpbi1lbnRyeS5zaFwiKSxcbiAgICBwYXRoLnJlc29sdmUoXCIuL2Rpc3QvYmluL21haW4tZW50cnkuc2hcIilcbiAgKTtcblxuICBmcy5jb3B5U3luYyhcbiAgICBwYXRoLnJlc29sdmUoXCIuL2Jpbi9tYWluLWVudHJ5LnBzMVwiKSxcbiAgICBwYXRoLnJlc29sdmUoXCIuL2Rpc3QvYmluL21haW4tZW50cnkucHMxXCIpXG4gICk7XG59XG5cbi8qKlxuICogVGhpcyBydW5zIHRoZSBidWlsZCBzY3JpcHQgZm9yIGJ1bmRsaW5nIHRoZSBkZXZvcHMgZW52aXJvbm1lbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbGVhc2VCaW4oKSB7XG4gIGNvbnNvbGUud2FybihjaGFsay5jeWFuQnJpZ2h0KFwiQnVpbGRpbmcgYmluIGNvbW1hbmRzIGZvciB0aGUgZGlzdHJpYnV0aW9uLlwiKSk7XG5cbiAgaWYgKFxuICAgICFmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShcIi4vYmluL21haW4udHNcIikpIHx8XG4gICAgIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwiLi9iaW4vbWFpbi1lbnRyeS5zaFwiKSkgfHxcbiAgICBpZ25vcmUuaWdub3JlcyhcImJpblwiKVxuICApIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBgVHJpZWQgdG8gbWFrZSBhIHJlbGVhc2UgZm9yIHRoZSBiaW4gY29tbWFuZHMsIGJ1dCBubyBiaW4vbWFpbi50cyBvciBiaW4vbWFpbi5zaCBlbnRyeSBmaWxlIHdhcyBmb3VuZC4gKG9yIHdhcyBnaXRpZ25vcmVkKTpcXG5cXHQke3BhdGgucmVzb2x2ZShcbiAgICAgICAgXCIuL2Jpbi9tYWluLnRzXCJcbiAgICAgICl9XFxuXFx0JHtwYXRoLnJlc29sdmUoXCIuL2Jpbi9tYWluLnNoXCIpfWBcbiAgICApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGZzLmVuc3VyZURpclN5bmMocGF0aC5yZXNvbHZlKFwiLi9kaXN0XCIpKTtcbiAgZnMuZW5zdXJlRGlyU3luYyhwYXRoLnJlc29sdmUoXCIuL2Rpc3QvYmluL3RlbXBsYXRlXCIpKTtcblxuICBhd2FpdCBidWlsZENvbW1hbmRzKCk7XG4gIGF3YWl0IGJ1aWxkU2hpbSgpO1xuICBhd2FpdCBjb3B5VGVtcGxhdGVzKCk7XG4gIGF3YWl0IGNvcHlBcnRpZmFjdHMoKTtcbn1cbiIsCiAgImltcG9ydCAqIGFzIFZpdGUgZnJvbSBcInZpdGVcIjtcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiB2aXRlRGV2b3BzU3RyaW5nUmVwbGFjZVBsdWdpbihcbiAgcmVwbGFjZW1lbnRzOiB7IGZyb206IHN0cmluZzsgdG86IHN0cmluZyB9W11cbik6IFZpdGUuUGx1Z2luT3B0aW9uIHtcbiAgcmV0dXJuIHtcbiAgICBuYW1lOiBcInZpdGUtZGV2b3BzLXN0cmluZy1yZXBsYWNlLXBsdWdpblwiLFxuICAgIGVuZm9yY2U6IFwicHJlXCIsXG5cbiAgICBsb2FkKGlkOiBzdHJpbmcpIHtcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKGlkKTtcbiAgICAgIC8vIERldGVybWluZSBhcHByb3ByaWF0ZSBNSU1FIHR5cGVcbiAgICAgIGNvbnN0IGV4dGVuc2lvbnMgPSBbXCIudHNcIiwgXCIuanNcIiwgXCIudHN4XCIsIFwiLmpzeFwiXTtcblxuICAgICAgLy8gSWYgdGhlIGV4dGVuc2lvbiB0eXBlIHdhcyBlc3RhYmxpc2hlZCwgdGhpcyByZXNvdXJjZSB3aWxsIGJlIGJhc2U2NCBpbmxpbmVkLlxuICAgICAgaWYgKFxuICAgICAgICBmcy5leGlzdHNTeW5jKGZpbGVQYXRoKSAmJlxuICAgICAgICBleHRlbnNpb25zLmluY2x1ZGVzKHBhdGguZXh0bmFtZShmaWxlUGF0aCkpICYmXG4gICAgICAgICFmaWxlUGF0aC5pbmNsdWRlcyhcIm5vZGVfbW9kdWxlc1wiKSAmJlxuICAgICAgICAhZmlsZVBhdGguaW5jbHVkZXMoXCJcXHgwMFwiKVxuICAgICAgKSB7XG4gICAgICAgIGxldCBjb2RlID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCB7IGVuY29kaW5nOiBcInV0Zi04XCIgfSk7XG4gICAgICAgIC8vIFJlcGxhY2UgdGhlIGRpc2NvdmVyZWQgc3RyaW5nIGluIHRoZSBjb2RlXG4gICAgICAgIHJlcGxhY2VtZW50cy5mb3JFYWNoKChyZXBsYWNlbWVudCkgPT4ge1xuICAgICAgICAgIGNvZGUgPSBjb2RlLnJlcGxhY2UocmVwbGFjZW1lbnQuZnJvbSwgcmVwbGFjZW1lbnQudG8pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY29kZTtcbiAgICAgIH1cbiAgICB9LFxuICB9O1xufVxuIiwKICAiLyoqXG4gKiBUaGlzIGlzIGEgc3BlY2lhbGl6ZWQgcGx1Z2luIGZvciBzdXBwb3J0aW5nIHRoZSBgYXBwL2NvbmZpZ2AgZm9sZGVyIHRvIGhhdmVcbiAqIHRhcmdldHRlZCBlbnZpcm9ubWVudCBmaWxlcyB0aGF0IGF1dG9tYXRpY2FsbHkgc3dhcCBmb3IgdGhlIGNvcnJlY3RcbiAqIGVudmlyb25tZW50IGJlaW5nIGJ1aWx0IGZvci5cbiAqXG4gKiBUaGUgZGVmYXVsdCBjb25maWd1cmF0aW9uIHdvdWxkIGJlIHRvIGhhdmUgYGVudmAgZmlsZXMgYXQgdGhlIHJvb3Qgb2YgdGhlXG4gKiBmb2xkZXI6XG4gKlxuICogYGBgXG4gKiBhcHAvY29uZmlnOlxuICogICBlbnYudHNcbiAqICAgZW52LnByb2QudHNcbiAqICAgZW52LnN0YWdlLnRzXG4gKiAgIGVudi5jdXN0b20udHNcbiAqIGBgYFxuICpcbiAqIFlvdSBoYXZlIHR3byB3YXlzIHRvIHRhcmdldCB0aGUgY29uZmlndXJhdGlvbjpcbiAqXG4gKiBGb3IgZGV2ZWxvcG1lbnQgdXNlIHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZSBgRU5WX01PREVgIHRvIHRhcmdldCB0aGVcbiAqIGVudmlyb25tZW50IG9mIGNob2ljZSBzdWNoIGFzXG4gKlxuICogYGBgXG4gKiBFTlZfTU9ERT1jdXN0b21cbiAqIGBgYFxuICpcbiAqIEZvciByZWxlYXNlcyB5b3Ugc3BlY2lmeSBhIGBidWlsZC5jb25mLmpzYCBmaWxlIGluIHRoZSByb290IG9mIHRoZSBwcm9qZWN0XG4gKiB3aXRoIHRoZSBjb250ZW50czpcbiAqXG4gKiBgYGBcbiAqIGV4cG9ydCBjb25zdCBCVUlMRF9UQVJHRVRTID0gW1wicHJvZFwiLCBcImN1c3RvbVwiXTtcbiAqIGBgYFxuICpcbiAqIFdoaWNoIHdpbGwgY2F1c2UgdGhlIHJlbGVhc2UgcHJvY2VzcyB0byBtYWtlIGEgZGlzdHJpYnV0aW9uIHBlciByZWxlYXNlXG4gKiB0YXJnZXQgc3BlY2lmaWVkLlxuICpcbiAqIGVudiB3aXRoaW4gdGhpcyBkZXZvcHMgc3lzdGVtIGlzIGludGVuZGVkIHRvIGhlbHAgc21vb3RoZSBvdmVyIGEgZGV2IHNlcnZlclxuICogd2l0aCB0aGUgZGV2ZWxvcG1lbnQgZW52aXJvbm1lbnQgdG8gbWFrZSBpdCBlYXNpZXIgdG8gaW50ZXJmYWNlIHdpdGggYW55XG4gKiByZW1vdGUgc2VydmVyIHVuZGVyIGFueSBkb21haW4uXG4gKlxuICogSG93ZXZlciwgdGhlIGNvbmNlcHQgY2FuIGJlIGV4cGFuZGVkIGZvciB0aGUgZGV2ZWxvcGVyIGJ5IGFkZGluZyBzdWIgZm9sZGVyc1xuICogdG8gY3JlYXRlIG1vcmUgc3BlY2lmaWMgZW52aXJvbm1lbnQgY29uZmlndXJhdGlvbnMgdGhhdCBtYXkgYmUgbmVlZGVkIGZvciBhXG4gKiBmcm9udCBlbmQgYnV0IE5PVCBhIHNlcnZlci4gT3IgbWF5IGJlIGl0J3MganVzdCBmb3IgZWFzaWVyIG9yZ2FuaXphdGlvbiBvZlxuICogY29uZmlndXJhdGlvbi4gT25lIGNvbW1vbiB1c2Ugd291bGQgYmUgYSB0aGVtZTpcbiAqXG4gKiBgYGBcbiAqIGFwcC9jb25maWc6XG4gKiAgIGVudjpcbiAqICAgICBlbnYudHNcbiAqICAgICBlbnYucHJvZC50c1xuICogICAgIGVudi5zdGFnZS50c1xuICogICAgIGVudi5jdXN0b20udHNcbiAqICB0aGVtZTpcbiAqICAgICB0aGVtZS50c1xuICogICAgIHRoZW1lLnByb2QudHNcbiAqICAgICB0aGVtZS5zdGFnZS50c1xuICogICAgIHRoZW1lLmN1c3RvbS50c1xuICogYGBgXG4gKlxuICogWW91ciBjb2RlIGltcG9ydHMgdGhlc2UgY29uZmlndXJhdGlvbnMgdmlhOlxuICpcbiAqIGBgYFxuICogaW1wb3J0IHsgVGhpbmcgfSBmcm9tIFwiY29uZmlnL3RoaW5nXCI7XG4gKiBgYGBcbiAqXG4gKiBUaGUgaW1wb3J0YW50IGZvcm1hdHRpbmcgY29uY2VybnMgaGVyZSBpcyB0byBlbnN1cmUgeW91IG1ha2UgYSBjb21tb24gZW50cnlcbiAqIGZpbGUgd2l0aCB0aGUgc2FtZSBuYW1lIGFzIHRoZSBwYXJlbnQgZm9sZGVyOlxuICpcbiAqIGBgYFxuICogYXBwL2NvbmZpZzpcbiAqICAgZW52OlxuICogICAgIGVudi50c1xuICogICB0aGVtZTpcbiAqICAgICB0aGVtZS50c1xuICogYGBgXG4gKlxuICogVGhlbiB5b3UgYWRkIGFueSBhZGRpdGlvbmFsIGVudmlyb25tZW50cyBvZiB0aGUgc2FtZSBmaWxlIG5hbWUuXG4gKiBgPGZpbGU+LjxlbnZpcm9ubWVudD4udHNgLlxuICpcbiAqIFRoZSBmaWxlIHdpdGggbm8gZW52aXJvbm1lbnQgaW4gaXQncyBmaWxlIHBhdGggaXMgdGhlIGZpbGUgdXNlZCBpblxuICogZGV2ZWxvcG1lbnQgd2hlbiBubyBlbnZpcm9ubWVudCBpcyBzcGVjaWZpZWQuXG4gKi9cblxuaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4uLy4uL2xpYi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyB2aXRlRGV2b3BzU3RyaW5nUmVwbGFjZVBsdWdpbiB9IGZyb20gXCIuL3ZpdGUtZGV2b3BzLXN0cmluZy1yZXBsYWNlLXBsdWdpbi5qc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gdml0ZURldm9wc0FwcENvbmZpZ1BsdWdpbihlbnY/OiBzdHJpbmcgfCBudWxsKSB7XG4gIC8vIFRoaXMgaXMgYSBmaXggZm9yIHJ1bm5pbmcgc3Rvcnlib29rIGhvdyB3ZSBydW4gaXQgd2hpY2ggYWRqdXN0cyB0aGUgY3dkXG4gIC8vIHRvIHRoZSBkZXZvcHMgZm9sZGVyXG4gIGNvbnN0IHByb2plY3RSb290ID0gcHJvY2Vzcy5lbnYuUFJPSkVDVF9ST09UIHx8IFwiLlwiO1xuICAvLyBMb29rIGluIHRoZSBhcHAgY29uZmlnIGZvbGRlciBmb3IgYW55IGZvbGRlciBlbnZpcm9ubWVudHNcbiAgY29uc3QgY29uZmlnUGF0aCA9IHBhdGgucmVzb2x2ZShwcm9qZWN0Um9vdCwgXCJhcHAvY29uZmlnXCIpO1xuXG4gIGlmICghZnMuZXhpc3RzU3luYyhjb25maWdQYXRoKSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIGB2aXRlRGV2b3BzQXBwQ29uZmlnUGx1Z2luOiAke2NoYWxrLmN5YW5CcmlnaHRCb2xkKFxuICAgICAgICBcIk5vIGFwcC9jb25maWcgZm9sZGVyIGZvdW5kLlwiXG4gICAgICApfWBcbiAgICApO1xuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBhbGxGb2xkZXJzID0gZnMucmVhZGRpclN5bmMoY29uZmlnUGF0aCkuZmlsdGVyKChmKSA9PiB7XG4gICAgICByZXR1cm4gZnMuc3RhdFN5bmMocGF0aC5qb2luKGNvbmZpZ1BhdGgsIGYpKS5pc0RpcmVjdG9yeSgpO1xuICAgIH0pO1xuICAgIGNvbnN0IGZvbGRlclBhdGhzID0gYWxsRm9sZGVycy5tYXAoKGYpID0+IHBhdGguam9pbihjb25maWdQYXRoLCBmKSk7XG4gICAgY29uc3QgcmVwbGFjZW1lbnRzID0gYWxsRm9sZGVycy5tYXAoKGZvbGRlciwgaSkgPT4ge1xuICAgICAgLy8gV2l0aCBubyBlbnZpcm9ubWVudCwgd2UgY2hlY2sgZm9yIHRoZSBzcGVjaWFsIGNhc2Ugb2YgYSAubG9jYWwgZmlsZSBiZWluZ1xuICAgICAgLy8gcHJlc2VudCBpbiB0aGUgZm9sZGVyLiBJZiBpdCBpcywgd2UgdXNlIHRoYXQgYXMgdGhlIGVudmlyb25tZW50LlxuICAgICAgaWYgKCFlbnYpIHtcbiAgICAgICAgLy8gSWYgbG9jYWwgZXhpc3RzLCBjcmVhdGUgc3BlY2lhbCByZXBsYWNlbWVudCB0byB0YXJnZXQgdGhlIGxvY2FsIGZpbGVcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGZvbGRlclBhdGhzW2ldLCBgJHtmb2xkZXJ9LmxvY2FsYCkpIHx8XG4gICAgICAgICAgZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oZm9sZGVyUGF0aHNbaV0sIGAke2ZvbGRlcn0ubG9jYWwuanNgKSkgfHxcbiAgICAgICAgICBmcy5leGlzdHNTeW5jKHBhdGguam9pbihmb2xkZXJQYXRoc1tpXSwgYCR7Zm9sZGVyfS5sb2NhbC50c2ApKSB8fFxuICAgICAgICAgIGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGZvbGRlclBhdGhzW2ldLCBgJHtmb2xkZXJ9LmxvY2FsLnRzeGApKSB8fFxuICAgICAgICAgIGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGZvbGRlclBhdGhzW2ldLCBgJHtmb2xkZXJ9LmxvY2FsLmpzeGApKVxuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBmcm9tOiBgXCJjb25maWcvJHtmb2xkZXJ9LyR7Zm9sZGVyfVwiYCxcbiAgICAgICAgICAgICAgdG86IGBcImNvbmZpZy8ke2ZvbGRlcn0vJHtmb2xkZXJ9LmxvY2FsXCJgLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZnJvbTogYFwiY29uZmlnLyR7Zm9sZGVyfS8ke2ZvbGRlcn0uanNcImAsXG4gICAgICAgICAgICAgIHRvOiBgXCJjb25maWcvJHtmb2xkZXJ9LyR7Zm9sZGVyfS5sb2NhbC5qc1wiYCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZyb206IGBcImNvbmZpZy8ke2ZvbGRlcn0vJHtmb2xkZXJ9LnRzXCJgLFxuICAgICAgICAgICAgICB0bzogYFwiY29uZmlnLyR7Zm9sZGVyfS8ke2ZvbGRlcn0ubG9jYWwudHNcImAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBPdGhlcndpc2UsIHRoZSBkZWZhdWx0IGVudiBmaWxlIHdpbGwgYmUgdXNlZFxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQW4gZW52aXJvbWVudCB3YXMgc3BlY2lmaWVkLCBzbyB3ZSB3aWxsIHRhcmdldCB0aGF0IGVudmlyb25tZW50XG4gICAgICByZXR1cm4gW1xuICAgICAgICB7XG4gICAgICAgICAgZnJvbTogYFwiY29uZmlnLyR7Zm9sZGVyfS8ke2ZvbGRlcn1cImAsXG4gICAgICAgICAgdG86IGBcImNvbmZpZy8ke2ZvbGRlcn0vJHtmb2xkZXJ9LiR7ZW52fVwiYCxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGZyb206IGBcImNvbmZpZy8ke2ZvbGRlcn0vJHtmb2xkZXJ9LmpzXCJgLFxuICAgICAgICAgIHRvOiBgXCJjb25maWcvJHtmb2xkZXJ9LyR7Zm9sZGVyfS4ke2Vudn0uanNcImAsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBmcm9tOiBgXCJjb25maWcvJHtmb2xkZXJ9LyR7Zm9sZGVyfS50c1wiYCxcbiAgICAgICAgICB0bzogYFwiY29uZmlnLyR7Zm9sZGVyfS8ke2ZvbGRlcn0uJHtlbnZ9LnRzXCJgLFxuICAgICAgICB9LFxuICAgICAgXTtcbiAgICB9KTtcblxuICAgIC8vIEZsYXR0ZW4gYWxsIG9mIG91ciBtYXBwaW5ncyBpbnRvIGEgc2luZ2xlIGFycmF5XG4gICAgY29uc3QgZmxhdHRlbmVkID0gcmVwbGFjZW1lbnRzLnJlZHVjZSgoYWNjLCB2YWwpID0+IGFjYy5jb25jYXQodmFsKSwgW10pO1xuXG4gICAgLy8gU2VlIGlmIHRoZXJlJ3MgYSBiYXNlIGVudiBsb2NhbCBmaWxlIHRvIHVzZVxuICAgIGNvbnN0IHNob3VsZFVzZUxvY2FsVG9wRW52ID1cbiAgICAgICFlbnYgJiZcbiAgICAgIChmcy5leGlzdHNTeW5jKHBhdGguam9pbihjb25maWdQYXRoLCBgZW52LmxvY2FsYCkpIHx8XG4gICAgICAgIGZzLmV4aXN0c1N5bmMocGF0aC5qb2luKGNvbmZpZ1BhdGgsIGBlbnYubG9jYWwuanNgKSkgfHxcbiAgICAgICAgZnMuZXhpc3RzU3luYyhwYXRoLmpvaW4oY29uZmlnUGF0aCwgYGVudi5sb2NhbC50c2ApKSB8fFxuICAgICAgICBmcy5leGlzdHNTeW5jKHBhdGguam9pbihjb25maWdQYXRoLCBgZW52LmxvY2FsLnRzeGApKSB8fFxuICAgICAgICBmcy5leGlzdHNTeW5jKHBhdGguam9pbihjb25maWdQYXRoLCBgZW52LmxvY2FsLmpzeGApKSk7XG5cbiAgICAvLyBHZW5lcmF0ZSBtYXBwaW5ncyBmb3IgdGhlIHRvcCBsZXZlbCBlbnYgZmlsZS4gVGhpcyBpcyBhIGxlZ2FjeSBzdXBwb3J0XG4gICAgLy8gZmVhdHVyZS5cbiAgICBjb25zdCBtYXBUb3BFbnYgPSBzaG91bGRVc2VMb2NhbFRvcEVudlxuICAgICAgPyAvLyBVc2UgdGhlIGxvY2FsIGVudiBmaWxlIGlmIGl0IGV4aXN0c1xuICAgICAgICBbXG4gICAgICAgICAgeyBmcm9tOiAnXCJjb25maWcvZW52XCInLCB0bzogYFwiY29uZmlnL2Vudi5sb2NhbFwiYCB9LFxuICAgICAgICAgIHsgZnJvbTogJ1wiY29uZmlnL2Vudi5qc1wiJywgdG86IGBcImNvbmZpZy9lbnYubG9jYWwuanNcImAgfSxcbiAgICAgICAgICB7IGZyb206ICdcImNvbmZpZy9lbnYudHNcIicsIHRvOiBgXCJjb25maWcvZW52LmxvY2FsLnRzXCJgIH0sXG4gICAgICAgIF1cbiAgICAgIDogZW52XG4gICAgICA/IC8vIFVzZSB0aGUgY29ycmVjdCBlbnZpcm9ubWVudCB3aGVuIHNwZWNpZmllZFxuICAgICAgICBbXG4gICAgICAgICAgeyBmcm9tOiAnXCJjb25maWcvZW52XCInLCB0bzogYFwiY29uZmlnL2Vudi4ke2Vudn1cImAgfSxcbiAgICAgICAgICB7IGZyb206ICdcImNvbmZpZy9lbnYuanNcIicsIHRvOiBgXCJjb25maWcvZW52LiR7ZW52fS5qc1wiYCB9LFxuICAgICAgICAgIHsgZnJvbTogJ1wiY29uZmlnL2Vudi50c1wiJywgdG86IGBcImNvbmZpZy9lbnYuJHtlbnZ9LnRzXCJgIH0sXG4gICAgICAgIF1cbiAgICAgIDogLy8gSWYgbm8gZW52aXJvbm1lbnQgd2FzIHNwZWNpZmllZCwgbm8gbWFwcGluZyBzaG91bGQgaGFwcGVuXG4gICAgICAgIFtdO1xuXG4gICAgY29uc3QgYWxsTWFwcGluZ3MgPSBbXG4gICAgICAvLyBTdXBwb3J0IGVudiBmcm9tIHRoZSByb290IG9mIHRoZSBjb25maWcgZm9sZGVyXG4gICAgICAuLi5tYXBUb3BFbnYsXG4gICAgICAvLyBTdXBwb3J0IGFueSBmb2xkZXIgZW52aXJvbm1lbnRzXG4gICAgICAuLi5mbGF0dGVuZWQsXG4gICAgXTtcblxuICAgIC8vIExvZyB0aGUgbWFwcGluZyBjb25maWd1cmF0aW9uIGluIHVzZVxuICAgIGlmIChhbGxNYXBwaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLndhcm4oYFxuXG4gICR7Y2hhbGsueWVsbG93QnJpZ2h0Qm9sZChcIlVzaW5nIHRoZSBmb2xsb3dpbmcgbWFwcGluZ3MgZm9yIGFwcCBjb25maWc6XCIpfVxuXG4gIFxcdCR7Y2hhbGsuY3lhbkJyaWdodEJvbGQoXG4gICAgYWxsTWFwcGluZ3MubWFwKChtKSA9PiBgXFxuICAke20uZnJvbX0gPT4gJHttLnRvfWApLmpvaW4oXCJcXG5cXHRcIilcbiAgKX1cblxuICAgICAgYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHZpdGVEZXZvcHNTdHJpbmdSZXBsYWNlUGx1Z2luKGFsbE1hcHBpbmdzKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIGNoYWxrLnJlZEJyaWdodEJvbGQoYFxuICAgICAgQXBwIGNvbmZpZyBwbHVnaW4gZmFpbGVkIHRvIGxvYWQuIFRoZSBkZWZhdWx0IGNvbmZpZyBwYXRocyB3aWxsIGJlIHVzZWRcbiAgICAgIGFuZCBhbnkgc3BlY2lmaWMgZW52aXJvbm1lbnQgcmVxdWVzdGVkIHdpbGwgYmUgaWdub3JlZC5cbiAgICBgKVxuICAgICk7XG4gIH1cbn1cbiIsCiAgImltcG9ydCAqIGFzIFZpdGUgZnJvbSBcInZpdGVcIjtcbmltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBJZ25vcmUgZnJvbSBcImlnbm9yZVwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGJ1aWxkVml0ZUNvbmZpZyB9IGZyb20gXCIuLi8uLi9idWlsZC12aXRlLWNvbmZpZy5qc1wiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbC9jaGFsay5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdFZlcnNpb24gfSBmcm9tIFwiLi4vLi4vLi4vdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuaW1wb3J0IHsgdml0ZURldm9wc0FwcENvbmZpZ1BsdWdpbiB9IGZyb20gXCIuLi8uLi8uLi8uLi9zaGltL3ZpdGUtcGx1Z2lucy92aXRlLWRldm9wcy1hcHAtY29uZmlnLXBsdWdpbi5qc1wiO1xuXG5jb25zdCBnaXRJZ25vcmVQYXRoID0gcGF0aC5yZXNvbHZlKFwiLmdpdGlnbm9yZVwiKTtcbmxldCBpZ25vcmUgPSBJZ25vcmUuZGVmYXVsdCgpO1xuXG5pZiAoZnMuZXhpc3RzU3luYyhnaXRJZ25vcmVQYXRoKSkge1xuICBpZ25vcmUgPSBpZ25vcmUuYWRkKGZzLnJlYWRGaWxlU3luYyhnaXRJZ25vcmVQYXRoKS50b1N0cmluZygpKTtcbn1cblxuLyoqXG4gKiBUaGlzIHBlcmZvcm1zIHRoZSBidW5kbGluZyBwcm9jZXNzIGZvciBkaXN0cmlidXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWxlYXNlQ2xpZW50KGVudjogc3RyaW5nKSB7XG4gIGNvbnNvbGUud2FybihjaGFsay5jeWFuQnJpZ2h0KFwiQnVpbGRpbmcgY2xpZW50IGZpbGVzIGZvciB0aGUgZGlzdHJpYnV0aW9uLlwiKSk7XG5cbiAgLy8gUHJvdmlkZSB0aGUgYnVuZGxpbmcgcHJvY2VzcyB0aGUgY3VycmVudCBidWlsZCB2ZXJzaW9uLiBUaGlzIGFsbG93c1xuICAvLyBwcmludGluZyB0aGUgdmVyc2lvbiBpbiBhIG1lYW5pbmdmdWwgd2F5IGZvciBkZWJ1Z2dpbmcuXG4gIHByb2Nlc3MuZW52LlZJVEVfUkVMRUFTRV9WRVJTSU9OID1cbiAgICBwcm9jZXNzLmVudi5WSVRFX1JFTEVBU0VfVkVSU0lPTiB8fCAoYXdhaXQgdGFyZ2V0UHJvamVjdFZlcnNpb24oKSk7XG5cbiAgaWYgKHByb2Nlc3MuZW52LkZPUkNFX0JVSUxEICE9PSBcInRydWVcIikge1xuICAgIGlmIChcbiAgICAgICFmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShcImFwcC9jbGllbnRcIikpIHx8XG4gICAgICBpZ25vcmUuaWdub3JlcyhcImFwcC9jbGllbnRcIilcbiAgICApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGBUcmllZCB0byBtYWtlIGEgcmVsZWFzZSBmb3IgdGhlIHdlYiBhcHAgY2xpZW50LCBidXQgbm8gYXBwL2NsaWVudCBlbnRyeSBmaWxlIHdhcyBmb3VuZC4gKG9yIHdhcyBnaXRpZ25vcmVkKTpcXG5cXHQke3BhdGgucmVzb2x2ZShcbiAgICAgICAgICBcImFwcC9jbGllbnRcIlxuICAgICAgICApfWBcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgbm9kZUVudkJhayA9IHByb2Nlc3MuZW52Lk5PREVfRU5WO1xuICBwcm9jZXNzLmVudi5OT0RFX0VOViA9IFwicHJvZHVjdGlvblwiO1xuXG4gIGNvbnNvbGUud2FybihcbiAgICBgUmVsZWFzaW5nICR7Y2hhbGsueWVsbG93QnJpZ2h0Qm9sZChcImFwcC9jbGllbnRcIil9IGZvciBFbnZpcm9ubWVudDpgLFxuICAgIGNoYWxrLmN5YW5CcmlnaHRCb2xkKGVudilcbiAgKTtcbiAgcHJvY2Vzcy5lbnYuQlVJTERfRU5WID0gZW52O1xuXG4gIGNvbnN0IGNvbmZpZyA9IGF3YWl0IGJ1aWxkVml0ZUNvbmZpZygpO1xuXG4gIC8vIE1ha2Ugc3VyZSBvdXIgZW52aXJvbm1lbnQgaXMgcmVwbGFjZWQgZm9yIHRoZSBidWlsZFxuICBjb25maWcucGx1Z2lucyA9IFt2aXRlRGV2b3BzQXBwQ29uZmlnUGx1Z2luKGVudiksIC4uLihjb25maWcucGx1Z2lucyB8fCBbXSldO1xuXG4gIGNvbmZpZy5sb2dMZXZlbCA9IFwid2FyblwiO1xuICBjb25maWcubW9kZSA9IFwicHJvZHVjdGlvblwiO1xuICBjb25maWcucm9vdCA9IHBhdGgucmVzb2x2ZShcImFwcC9jbGllbnRcIik7XG4gIGNvbmZpZy5idWlsZCEub3V0RGlyID0gcGF0aC5yZXNvbHZlKFwiZGlzdC9hcHAvY2xpZW50XCIsIGVudik7XG4gIGNvbmZpZy5idWlsZCEud2F0Y2ggPSB2b2lkIDA7XG4gIGNvbmZpZy5idWlsZCEucm9sbHVwT3B0aW9ucyEub3V0cHV0ID0ge1xuICAgIGRpcjogY29uZmlnLmJ1aWxkIS5vdXREaXIsXG4gICAgZW50cnlGaWxlTmFtZXM6IFwiaW5kZXguanNcIixcbiAgICBjaHVua0ZpbGVOYW1lczogXCJpbmRleC5qc1wiLFxuICAgIG1hbnVhbENodW5rczogdW5kZWZpbmVkLFxuICB9O1xuXG4gIGF3YWl0IFZpdGUuYnVpbGQoY29uZmlnKTtcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBub2RlRW52QmFrO1xuXG4gIC8vIFJ1biBhIHF1aWNrIGNoZWNrIHRvIG1ha2Ugc3VyZSB0aGUgZGlzdHJpYnV0aW9uIGZpbGUgd2FzIG1hZGVcbiAgaWYgKCFmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShgZGlzdC9hcHAvY2xpZW50LyR7ZW52fS9pbmRleC5qc2ApKSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICBcIlxcblxcbkZhaWxlZCB0byBjcmVhdGUgQ2xpZW50IG91dHB1dCBidW5kbGUuIEV4aXRpbmcgcHJvY2Vzcy4uLlxcblxcblwiXG4gICAgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cbiIsCiAgImltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSBcIi4vZXhlYy1zeW5jLmpzXCI7XG5pbXBvcnQgeyBnZXRQYWNrYWdlTWFuYWdlciB9IGZyb20gXCIuL2dldC1wYWNrYWdlLW1hbmFnZXIuanNcIjtcblxuLyoqXG4gKiBFeGVjdXRlcyBhbiBgbnB4IDxjb21tYW5kPmAgaW4gdGhlIGN1cnJlbnQgY29udGV4dC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4ZWNTY3JpcHRYKGFyZ3M6IChzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsKVtdID0gW10pIHtcbiAgY29uc3QgbWFuYWdlciA9IGF3YWl0IGdldFBhY2thZ2VNYW5hZ2VyKCk7XG5cbiAgaWYgKGV4ZWNTY3JpcHRYLm9wdGltaXplKSB7XG4gICAgaWYgKG1hbmFnZXJbMV0gPT09IFwiYnVueFwiKSB7XG4gICAgICByZXR1cm4gZXhlY1N5bmMobWFuYWdlclsxXSwgW1wiLS1idW5cIiwgLi4uYXJnc10pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBleGVjU3luYyhtYW5hZ2VyWzFdLCBbLi4uYXJnc10pO1xufVxuXG5leGVjU2NyaXB0WC5vcHRpbWl6ZSA9IHRydWU7XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbC9jaGFsay5qc1wiO1xuaW1wb3J0IHsgZXhlY1NjcmlwdFggfSBmcm9tIFwiLi4vLi4vLi4vZXhlYy9leGVjLXNjcmlwdHguanNcIjtcblxuLyoqXG4gKiBHZW5lcmF0ZXMgdHlwZXMgZm9yIHRoZSBidWlsZCBmb3IgdGhlIHRhcmdldCBwcm9qZWN0IHVpIGZvbGRlci5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbGVhc2VMaWJyYXJ5VHlwZXMoKSB7XG4gIC8vIE11c3QgaGF2ZSBhIGNvbXBvbmVudCBsaWIgZm9sZGVyIHRvIGNvbnNpZGVyXG4gIGlmICghZnMuZXhpc3RzU3luYyhwYXRoLnJlc29sdmUoXCJ1aVwiKSkpIHJldHVybjtcbiAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYSBmb2xkZXIgdG8gaW5qZWN0IHRoZSB0eXBlcyBpbnRvXG4gIGZzLmVuc3VyZURpcihwYXRoLnJlc29sdmUoXCJkaXN0L3R5cGVzXCIpKTtcbiAgLy8gR2VuZXJhdGUgdGhlIC5kLnRzIGZpbGVzIHVzaW5nIHRzYyBjb21tYW5kIHZpYSBidW54XG4gIGNvbnNvbGUud2FybihjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiR2VuZXJhdGluZyAuZC50cyBmaWxlcy4uLlwiKSk7XG5cbiAgLy8gUGVyZm9ybSB0aGUgZHRzIGdlbmVyYXRpb25cbiAgZXhlY1NjcmlwdFgoW1xuICAgIFwidHNjXCIsXG4gICAgXCItLWVtaXREZWNsYXJhdGlvbk9ubHlcIixcbiAgICBcIi0tZGVjbGFyYXRpb25cIixcbiAgICBcIi0tb3V0RGlyXCIsXG4gICAgXCJkaXN0L3R5cGVzXCIsXG4gICAgXCItLXByb2plY3RcIixcbiAgICBwYXRoLnJlc29sdmUoXCJ0c2NvbmZpZy5qc29uXCIpLFxuICBdKTtcblxuICAvLyBEZWxldGUgdGhlIGdlbmVyYXRlZCB0eXBlIG9mIGV2ZXJ5IGZvbGRlciBFWENFUFQgdGhlIHVpIGFuZCB1dGlsIGZvbGRlclxuICBjb25zdCBmb2xkZXJzID0gZnMucmVhZGRpclN5bmMocGF0aC5yZXNvbHZlKFwiZGlzdC90eXBlc1wiKSk7XG4gIGZvciAoY29uc3QgZm9sZGVyIG9mIGZvbGRlcnMpIHtcbiAgICBpZiAoZm9sZGVyID09PSBcInVpXCIgfHwgZm9sZGVyID09PSBcInV0aWxcIikgY29udGludWU7XG4gICAgY29uc29sZS53YXJuKGNoYWxrLnllbGxvd0JyaWdodChgUmVtb3ZpbmcgdHlwZXMgZm9yIGZvbGRlcjogJHtmb2xkZXJ9YCkpO1xuICAgIGZzLnJlbW92ZVN5bmMocGF0aC5yZXNvbHZlKFwiZGlzdC90eXBlc1wiLCBmb2xkZXIpKTtcbiAgfVxufVxuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRhcmdldFByb2plY3ROYW1lKCkge1xuICBjb25zdCBwYWNrYWdlSnNvbiA9IGZzLnJlYWRKU09OU3luYyhwYXRoLnJlc29sdmUoXCJwYWNrYWdlLmpzb25cIikpO1xuICByZXR1cm4gcGFja2FnZUpzb24ubmFtZSB8fCBcIlwiO1xufVxuIiwKICAiaW1wb3J0ICogYXMgVml0ZSBmcm9tIFwidml0ZVwiO1xuaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IElnbm9yZSBmcm9tIFwiaWdub3JlXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgYnVpbGRWaXRlQ29uZmlnIH0gZnJvbSBcIi4uLy4uL2J1aWxkLXZpdGUtY29uZmlnLmpzXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuLi8uLi8uLi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyByZWxlYXNlTGlicmFyeVR5cGVzIH0gZnJvbSBcIi4vcmVsZWFzZS1saWJyYXJ5LXR5cGVzLmpzXCI7XG5pbXBvcnQgeyB0YXJnZXRQcm9qZWN0RGVwZW5kZW5jaWVzIH0gZnJvbSBcIi4uLy4uLy4uL3RhcmdldC1wcm9qZWN0L3RhcmdldC1wcm9qZWN0LWRlcGVuZGVuY2llcy5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdE5hbWUgfSBmcm9tIFwiLi4vLi4vLi4vdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtbmFtZS5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdFZlcnNpb24gfSBmcm9tIFwiLi4vLi4vLi4vdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuXG5jb25zdCBnaXRJZ25vcmVQYXRoID0gcGF0aC5yZXNvbHZlKFwiLmdpdGlnbm9yZVwiKTtcbmxldCBpZ25vcmUgPSBJZ25vcmUuZGVmYXVsdCgpO1xuXG5pZiAoZnMuZXhpc3RzU3luYyhnaXRJZ25vcmVQYXRoKSkge1xuICBpZ25vcmUgPSBpZ25vcmUuYWRkKGZzLnJlYWRGaWxlU3luYyhnaXRJZ25vcmVQYXRoKS50b1N0cmluZygpKTtcbn1cblxuLyoqXG4gKiBCdW5kbGVzIHRoZSBsaWJyYXJ5IGZvciBkaXN0cmlidXRpb25cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbGVhc2VMaWJyYXJ5KCkge1xuICBjb25zb2xlLndhcm4oY2hhbGsuY3lhbkJyaWdodChcIkNvcHlpbmcgdWkgZmlsZXMgZm9yIHRoZSBkaXN0cmlidXRpb24uXCIpKTtcblxuICAvLyBQcm92aWRlIHRoZSBidW5kbGluZyBwcm9jZXNzIHRoZSBjdXJyZW50IGJ1aWxkIHZlcnNpb24uIFRoaXMgYWxsb3dzXG4gIC8vIHByaW50aW5nIHRoZSB2ZXJzaW9uIGluIGEgbWVhbmluZ2Z1bCB3YXkgZm9yIGRlYnVnZ2luZy5cbiAgcHJvY2Vzcy5lbnYuVklURV9SRUxFQVNFX1ZFUlNJT04gPVxuICAgIHByb2Nlc3MuZW52LlZJVEVfUkVMRUFTRV9WRVJTSU9OIHx8IChhd2FpdCB0YXJnZXRQcm9qZWN0VmVyc2lvbigpKTtcblxuICBpZiAoIXByb2Nlc3MuZW52LkZPUkNFX0JVSUxEKSB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShcInVpXCIpKSB8fCBpZ25vcmUuaWdub3JlcyhcInVpXCIpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBgXCJObyBsaWJyYXJ5IHByb2plY3QgZm91bmQgKG9yIHdhcyBnaXRpZ25vcmVkKSBmb3IgYnVuZGxpbmcgcmVsZWFzZSBhdDpcXG5cXHQke3BhdGgucmVzb2x2ZShcbiAgICAgICAgICBcInVpXCJcbiAgICAgICAgKX1gXG4gICAgICApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGNvbnNvbGUud2FybihjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiU3RhcnRpbmcgVml0ZSBjbGllbnQgYnVpbGQuLi5cIikpO1xuICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwidWkvaW5kZXgudHNcIikpKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiVGhlIFVJIGZvbGRlciBwcm9qZWN0IGhhcyBubyBpbmRleC50cyBlbnRyeSBwb2ludCB0byBjcmVhdGUgdGhlIGxpYnJhcnkuXCJcbiAgICApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIFVwZGF0ZSB0aGUgLmQudHMgZmlsZXMgZm9yIHRoZSBsaWJyYXJ5IHByb2plY3RcbiAgYXdhaXQgcmVsZWFzZUxpYnJhcnlUeXBlcygpO1xuXG4gIGNvbnNvbGUud2FybihjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiQnVpbGRpbmcgbGlicmFyeSBidW5kbGUuLi5cIikpO1xuICBjb25zdCBjb25maWcgPSBhd2FpdCBidWlsZFZpdGVDb25maWcoKTtcblxuICBjb25maWcubG9nTGV2ZWwgPSBcIndhcm5cIjtcbiAgY29uZmlnLnJvb3QgPSBwYXRoLnJlc29sdmUoXCJ1aVwiKTtcbiAgY29uZmlnLmJ1aWxkIS5saWIgPSB7XG4gICAgLy8gQ291bGQgYWxzbyBiZSBhIGRpY3Rpb25hcnkgb3IgYXJyYXkgb2YgbXVsdGlwbGUgZW50cnkgcG9pbnRzXG4gICAgZW50cnk6IHBhdGgucmVzb2x2ZShcInVpL2luZGV4LnRzXCIpLFxuICAgIG5hbWU6IChhd2FpdCB0YXJnZXRQcm9qZWN0TmFtZSgpKS5zcGxpdChcIkBcIikuam9pbihcIlwiKS5zcGxpdChcIi9cIikuam9pbihcIl9cIiksXG4gICAgLy8gVGhlIHByb3BlciBleHRlbnNpb25zIHdpbGwgYmUgYWRkZWRcbiAgICBmaWxlTmFtZTogXCJpbmRleFwiLFxuICB9O1xuXG4gIGNvbmZpZy5tb2RlID0gXCJwcm9kdWN0aW9uXCI7XG4gIGNvbmZpZy5yb290ID0gcGF0aC5yZXNvbHZlKFwiYXBwL2NsaWVudFwiKTtcbiAgY29uZmlnLmJ1aWxkIS5vdXREaXIgPSBwYXRoLnJlc29sdmUoXCJkaXN0L3VpXCIpO1xuICBjb25maWcuYnVpbGQhLndhdGNoID0gdm9pZCAwO1xuICBjb25maWcuYnVpbGQhLnJvbGx1cE9wdGlvbnMhLm91dHB1dCA9IHtcbiAgICBkaXI6IGNvbmZpZy5idWlsZCEub3V0RGlyLFxuICAgIGVudHJ5RmlsZU5hbWVzOiBcImluZGV4LmpzXCIsXG4gICAgY2h1bmtGaWxlTmFtZXM6IFwiaW5kZXguanNcIixcbiAgICBtYW51YWxDaHVua3M6IHVuZGVmaW5lZCxcbiAgfTtcblxuICBjb25zdCBleHRlcm5hbCA9IE9iamVjdC5rZXlzKGF3YWl0IHRhcmdldFByb2plY3REZXBlbmRlbmNpZXMoKSk7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIkV4dGVybmFsaXplZCBMaWJyYXJpZXMgdGhhdCB3aWxsIG5vdCBiZSBpbmNsdWRlZCBpbiB0aGUgYnVuZGxlOlwiLFxuICAgIGV4dGVybmFsXG4gICk7XG5cbiAgY29uZmlnLmJ1aWxkIS5yb2xsdXBPcHRpb25zID0ge1xuICAgIC4uLmNvbmZpZy5idWlsZCEucm9sbHVwT3B0aW9ucyxcbiAgICBleHRlcm5hbCxcbiAgfTtcblxuICBhd2FpdCBWaXRlLmJ1aWxkKGNvbmZpZyk7XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vLi4vdXRpbC9jaGFsay5qc1wiO1xuaW1wb3J0IHsgdGFyZ2V0UHJvamVjdFZlcnNpb24gfSBmcm9tIFwiLi4vLi4vdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuaW1wb3J0IHsgd2FpdCB9IGZyb20gXCIuLi8uLi91dGlsL3dhaXQuanNcIjtcblxuLyoqXG4gKiBUaGlzIHBlcmZvcm1zIHRoZSBidW5kbGluZyBwcm9jZXNzIGZvciBkaXN0cmlidXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWxlYXNlU3RvcmllcygpIHtcbiAgcHJvY2Vzcy5lbnYuVklURV9SRUxFQVNFX1ZFUlNJT04gPVxuICAgIHByb2Nlc3MuZW52LlZJVEVfUkVMRUFTRV9WRVJTSU9OIHx8IChhd2FpdCB0YXJnZXRQcm9qZWN0VmVyc2lvbigpKTtcblxuICBjb25zb2xlLndhcm4oY2hhbGsuY3lhbkJyaWdodChcIkNvcHlpbmcgc3RvcnkgZmlsZXMgZm9yIHRoZSBkaXN0cmlidXRpb24uXCIpKTtcbiAgY29uc3Qgb3V0cHV0UGF0aCA9IHBhdGgucmVzb2x2ZShcImRpc3Qvc3Rvcmllc1wiKTtcbiAgY29uc3Qgc3Rvcmllc1BhdGggPSBwYXRoLnJlc29sdmUoXCJ1aS9zdG9yaWVzXCIpO1xuICBjb25zdCBkaXN0UGF0aCA9IHBhdGgucmVzb2x2ZShcImRpc3RcIik7XG5cbiAgaWYgKCFmcy5leGlzdHNTeW5jKHN0b3JpZXNQYXRoKSkge1xuICAgIGNvbnNvbGUuZXJyb3IoYENvdWxkIG5vdCBmaW5kIHN0b3JpZXMgZGlyZWN0b3J5OlxcblxcdCR7c3Rvcmllc1BhdGh9YCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRW5zdXJlIHRoZSBkaXJlY3RvcnkgZm9yIHRoZSBzdG9yaWVzIGV4aXN0cyBpbiB0aGUgc3lzdGVtXG4gIGZzLmVuc3VyZURpclN5bmMob3V0cHV0UGF0aCk7XG4gIC8vIERlZXAgY29weSB0aGUgc3RvcmllcyBmb2xkZXIgdG8gdGhlIGRpc3RyaWJ1dGlvblxuICBmcy5jb3B5U3luYyhzdG9yaWVzUGF0aCwgb3V0cHV0UGF0aCk7XG5cbiAgLy8gR2V0IHRoZSBuYW1lIG9mIHRoaXMgcHJvamVjdCBmcm9tIGl0J3MgcGFja2FnZS5qc29uXG4gIGNvbnN0IHBhY2thZ2VKc29uUGF0aCA9IHBhdGgucmVzb2x2ZShcInBhY2thZ2UuanNvblwiKTtcbiAgY29uc3QgcHJvamVjdFBhY2thZ2UgPSBmcy5yZWFkSlNPTlN5bmMocGFja2FnZUpzb25QYXRoKTtcblxuICAvLyBXZSBub3cgbmVlZCB0byB3cml0ZSBhIHNpbXBsZSBwYWNrYWdlLmpzb24gZmlsZSB0byB0aGUgZGlzdCBmb2xkZXIgdG9cbiAgLy8gZW5zdXJlIHRoZSBzdG9yaWVzIGltcG9ydHMgcmVmZXJlbmNlIHRoZSBzYW1lIGxpYnJhcnkgdmlhIHJlbGF0aXZlIHBhdGhcbiAgLy8gaW1wb3J0cy5cbiAgLy8gVGhpcyBjb3JyZWN0cyBpbXBvcnRzIHRoYXQgZG86IGZyb20gXCIuLi8uLi8uLlwiXG4gIGNvbnN0IHBhY2thZ2VKc29uID0ge1xuICAgIG5hbWU6IHByb2plY3RQYWNrYWdlLm5hbWUgfHwgXCJ1bmtub3duXCIsXG4gICAgcHJpdmF0ZTogdHJ1ZSxcbiAgICB0eXBlOiBcIm1vZHVsZVwiLFxuICAgIG1haW46IFwiLi91aS9pbmRleC5qc1wiLFxuICAgIHR5cGVzOiBcIi4vdHlwZXMvdWkvaW5kZXguZC50c1wiLFxuICAgIGRlcGVuZGVuY2llczoge30sXG4gICAgcmVwb3NpdG9yeToge30sXG4gICAgc2NyaXB0czoge30sXG4gICAgZGV2RGVwZW5kZW5jaWVzOiB7fSxcbiAgfTtcblxuICBjb25zb2xlLndhcm4oXG4gICAgXCJXcml0aW5nIGRpc3RyaWJ1dGlvbiBwYWNrYWdlLmpzb246XCIsXG4gICAgcGF0aC5yZXNvbHZlKGRpc3RQYXRoLCBcInBhY2thZ2UuanNvblwiKVxuICApO1xuICBmcy53cml0ZUpTT05TeW5jKHBhdGgucmVzb2x2ZShkaXN0UGF0aCwgXCJwYWNrYWdlLmpzb25cIiksIHBhY2thZ2VKc29uKTtcblxuICAvLyBMZXQgdGhlIHdyaXRlIGNvbXBsZXRlXG4gIGF3YWl0IHdhaXQoNTAwKTtcblxuICAvLyBXcml0ZSBhIGRpc3RyaWJ1dGlvbiBmb2xkZXIgY2FsbGVkIGNvbXBvbmVudHMgd2hpY2ggd2lsbCBzaW1wbHkgYmUgYVxuICAvLyBwYWNrYWdlIGpzb24gY29uZmlndXJhdGlvbiB0aGF0IHJvdXRlcyB0aGUgaW1wb3J0IHRvIHRoZSB1aSByZWxlYXNlXG4gIGZzLmVuc3VyZURpclN5bmMocGF0aC5yZXNvbHZlKGRpc3RQYXRoLCBcImNvbXBvbmVudHNcIikpO1xuXG4gIC8vIEFsc28gd3JpdGUgdGhlIHBhY2thZ2UuanNvbiBmaWxlIHRvIHRoZSBjb21wb25lbnRzIGZvbGRlciB0byByZXJvdXRlXG4gIC8vIGNvbXBvbmVudCBpbXBvcnRzIHRvIHRoZSB1aSByZWxlYXNlIGRpc3RyaWJ1dGlvbiBhcyB3ZWxsLlxuICAvLyBUaGlzIGNvcnJlY3RzIGltcG9ydHMgdGhhdCBkbzogZnJvbSBcIi4uLy4uLy4uL2NvbXBvbmVudHNcIlxuICBwYWNrYWdlSnNvbi5tYWluID0gXCIuLi91aS9pbmRleC5qc1wiO1xuICBwYWNrYWdlSnNvbi50eXBlcyA9IFwiLi4vdHlwZXMvdWkvaW5kZXguZC50c1wiO1xuXG4gIGNvbnNvbGUud2FybihcbiAgICBcIldyaXRpbmcgZGlzdHJpYnV0aW9uIHBhY2thZ2UuanNvbjpcIixcbiAgICBwYXRoLnJlc29sdmUoZGlzdFBhdGgsIFwiY29tcG9uZW50cy9wYWNrYWdlLmpzb25cIilcbiAgKTtcbiAgZnMud3JpdGVKU09OU3luYyhcbiAgICBwYXRoLnJlc29sdmUoZGlzdFBhdGgsIFwiY29tcG9uZW50cy9wYWNrYWdlLmpzb25cIiksXG4gICAgcGFja2FnZUpzb25cbiAgKTtcblxuICAvLyBMZXQgdGhlIHdyaXRlIGNvbXBsZXRlXG4gIGF3YWl0IHdhaXQoNTAwKTtcbiAgY29uc29sZS53YXJuKFwiRmluaXNoZWQgY29weWluZyBzdG9yaWVzLlwiKTtcbn1cbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuLi8uLi9saWIvdXRpbC9jaGFsay5qc1wiO1xuaW1wb3J0IHsgZXhlY1NjcmlwdCB9IGZyb20gXCIuLi8uLi9saWIvZXhlYy9leGVjLXNjcmlwdC5qc1wiO1xuaW1wb3J0IHsgZ2l0UmV0dXJuVG9EZXYgfSBmcm9tIFwiLi4vLi4vbGliL2dpdC9naXQtcmV0dXJuLXRvLWRldi5qc1wiO1xuaW1wb3J0IHsgcHJvbXB0Q29uZmlybSB9IGZyb20gXCIuLi8uLi9saWIvcHJvbXB0L3Byb21wdC1jb25maXJtLmpzXCI7XG5pbXBvcnQgeyByZWxlYXNlQmluIH0gZnJvbSBcIi4uLy4uL2xpYi9idWlsZC9iaW4vcmVsZWFzZS1iaW4uanNcIjtcbmltcG9ydCB7IHJlbGVhc2VDbGllbnQgfSBmcm9tIFwiLi4vLi4vbGliL2J1aWxkL3dlYi1hcHAvdml0ZS9yZWxlYXNlLWNsaWVudC5qc1wiO1xuaW1wb3J0IHsgcmVsZWFzZUxpYnJhcnkgfSBmcm9tIFwiLi4vLi4vbGliL2J1aWxkL2xpYnJhcnkvdml0ZS9yZWxlYXNlLWxpYnJhcnkuanNcIjtcbmltcG9ydCB7IHJlbGVhc2VTdG9yaWVzIH0gZnJvbSBcIi4uLy4uL2xpYi9idWlsZC9saWJyYXJ5L3JlbGVhc2Utc3Rvcmllcy5qc1wiO1xuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyBhbGwgb2YgdGhlIHBhY2thZ2UganNvbiBzZXR0aW5ncyBhbmQgZW5zdXJlcyB0aGVcbiAqIHJlcG9zaXRvcmllcyBsaXN0ZWQgYXJlIHZhbGlkIGZvciB1c2Ugd2l0aGluIHRoaXMgY29udGV4dC5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVSZWxlYXNlKCkge1xuICBpZiAocHJvY2Vzcy5lbnYuUVVJQ0tfQlVJTEQgPT09IFwidHJ1ZVwiKSByZXR1cm47XG4gIC8vIFJ1biB0aGUgdmlldy1yZWxlYXNlIGNvbW1hbmQgdG8gc2VlIGlmIHRoZSByZWxlYXNlIHByb2Nlc3MgcHJvZHVjZXNcbiAgLy8gYSB2YWxpZCBvdXRwdXRcbiAgLy8gUnVuIHRoZSB2aWV3LXJlbGVhc2Ugc2NyaXB0XG4gIGF3YWl0IGV4ZWNTY3JpcHQoXCJyZWxlYXNlXCIsIFtcInZpZXdcIl0pO1xuXG4gIC8vIEFzayBpZiB0aGUgdmlldy1yZWxlYXNlIHNjcmlwdCBsb29rcyBnb29kIGFuZCBzaG91bGQgY29udGludWVcbiAgY29uc3Qgc2hvdWxkQ29udGludWUgPSBhd2FpdCBwcm9tcHRDb25maXJtKFxuICAgIFwiXFxuU2hvdWxkIHRoZSByZWxlYXNlIGNvbnRpbnVlIGJlaW5nIG1hZGU/XCJcbiAgKTtcblxuICAvLyBRdWl0IHRoZSBwcm9jZXNzIGlmIHRoZSB2aWV3IHJlbGVhc2UgZGlkIG5vdCB3b3JrXG4gIGlmICghc2hvdWxkQ29udGludWUpIHtcbiAgICBhd2FpdCBnaXRSZXR1cm5Ub0Rldih0cnVlKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGlzIHBlcmZvcm1zIGFsbCBidW5kbGluZyBwcm9jZWR1cmVzIGFuZCBzZXQgdXAgbmVlZGVkIHRvIGJ1bmRsZSB0aGVcbiAqIHByb2plY3QuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGJ1bmRsZVByb2plY3QoKSB7XG4gIGNvbnNvbGUud2FybihcbiAgICBcIkdhdGhlcmluZyBidWlsZCB0YXJnZXRzIGZyb206XCIsXG4gICAgY2hhbGsueWVsbG93QnJpZ2h0KHBhdGgucmVzb2x2ZShcImJ1aWxkLmNvbmYuanNcIikpXG4gICk7XG4gIGNvbnN0IGJ1aWxkRW52aXJvbm1lbnRzID0gKGF3YWl0IGltcG9ydChwYXRoLnJlc29sdmUoXCJidWlsZC5jb25mLmpzXCIpKSlcbiAgICAuQlVJTERfVEFSR0VUUztcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBcInByb2R1Y3Rpb25cIjtcblxuICBjb25zb2xlLndhcm4oXG4gICAgXCJCdWlsZGluZyBlbnZpcm9ubWVudHNcIixcbiAgICBjaGFsay5yZWRCcmlnaHRCb2xkKEpTT04uc3RyaW5naWZ5KGJ1aWxkRW52aXJvbm1lbnRzKSlcbiAgKTtcblxuICBpZiAoIUFycmF5LmlzQXJyYXkoYnVpbGRFbnZpcm9ubWVudHMpKSB7XG4gICAgY29uc29sZS5lcnJvcihcImJ1aWxkLmNvbmYuanMgbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmcgdmFsdWVzXCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGZvciAoY29uc3QgZW52IG9mIGJ1aWxkRW52aXJvbm1lbnRzKSB7XG4gICAgYXdhaXQgcmVsZWFzZUNsaWVudChlbnYpO1xuICB9XG5cbiAgYXdhaXQgcmVsZWFzZUxpYnJhcnkoKTtcbiAgYXdhaXQgcmVsZWFzZVN0b3JpZXMoKTtcbiAgYXdhaXQgcmVsZWFzZUJpbigpO1xufVxuXG4vKipcbiAqIFRoaXMgY2xlYXJzIG91dCB0aGUgZGlzdHJpYnV0aW9uIGZvbGRlciBzbyBubyBsaW5nZXJpbmcgaXJyZWxldmFudCBmcmFnbWVudHNcbiAqIGV4aXN0cy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gY2xlYXJQcmV2aW91c0Rpc3RyaWJ1dGlvbigpIHtcbiAgdHJ5IHtcbiAgICBmcy5yZW1vdmVTeW5jKHBhdGgucmVzb2x2ZShcImRpc3RcIikpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLndhcm4oXCJObyBkaXN0IGZvbGRlciB0byBjbGVhbiBvdXQuXCIpO1xuICB9XG5cbiAgZnMuZW5zdXJlRGlyU3luYyhwYXRoLnJlc29sdmUoXCJkaXN0XCIpKTtcbn1cblxuLyoqXG4gKiBUaGlzIGNvcGllcyBhbGwgbmVjZXNzYXJ5IGVsZW1lbnRzIGZyb20gdGhlIHByb2plY3QgaW50byB0aGUgZGlzdHJpYnV0aW9uXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNvcHlBbmRDbGVhbkZyYWdtZW50cygpIHtcbiAgLy8gQ2xlYW4gb3V0IHRoZSBjb21waWxlZCB0ZXN0IGZpbGUgdHlwaW5nc1xuICB0cnkge1xuICAgIGZzLnJlbW92ZVN5bmMocGF0aC5yZXNvbHZlKFwiZGlzdC90ZXN0XCIpKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS53YXJuKFwiTm8gdGVzdCBmb2xkZXIgdG8gY2xlYW4gb3V0XCIpO1xuICB9XG5cbiAgLy8gQ2xlYW4gb3V0IHVuaXQtdGVzdHNcbiAgdHJ5IHtcbiAgICBmcy5yZW1vdmVTeW5jKHBhdGgucmVzb2x2ZShcImRpc3QvdW5pdC10ZXN0XCIpKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS53YXJuKFwiTm8gdW5pdC10ZXN0IGZvbGRlciB0byBjbGVhbiBvdXRcIik7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKCkge1xuICAvLyBQZXJmb3JtIGFueSB0eXBlc2NyaXB0IHNwZWNpZmljIGFjdGlvbnNcbiAgY29uc29sZS53YXJuKFwiVmFsaWRhdGluZyB0aGUgcmVsZWFzZS4uLlwiKTtcbiAgYXdhaXQgdmFsaWRhdGVSZWxlYXNlKCk7XG4gIC8vIERlbGV0ZSBhbnkgZmlsZXMgaW4gdGhlIGRpc3QgZm9sZGVyIHNvIHdlIGhhdmUgYSBjbGVhbiBidWlsZCB3aXRoIG5vXG4gIC8vIGNoYW5jZXMgb2YgY2FjaGluZyBvciBrZWVwaW5nIG5vIGxvbmdlciByZWxldmFudCBmaWxlcy5cbiAgY29uc29sZS53YXJuKFwiQ2xlYXIgcHJldmlvdXMgYnVpbGQuLi5cIik7XG4gIGF3YWl0IGNsZWFyUHJldmlvdXNEaXN0cmlidXRpb24oKTtcbiAgLy8gQnVpbGQgdGhlIG1vbm9saXRoaWMgZGlzdHJpYnV0aW9uXG4gIGNvbnNvbGUud2FybihcIkJ1bmRsaW5nIHByb2plY3QuLi5cIik7XG4gIGF3YWl0IGJ1bmRsZVByb2plY3QoKTtcbiAgLy8gQ29weSBhbmQgZGVsZXRlIGFueSBmcmFnbWVudHMgaW4gdGhlIGRpc3QgZm9sZGVyIHRoYXQgaXMgbmVjZXNzYXJ5XG4gIGNvbnNvbGUud2FybihcIkZpbmFsIGNsZWFudXAuLi5cIik7XG4gIGF3YWl0IGNvcHlBbmRDbGVhbkZyYWdtZW50cygpO1xuICBjb25zb2xlLndhcm4oXCJSZWxlYXNlIEJ1aWxkIGNvbXBsZXRlIVwiKTtcbn1cbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBncm91cEJ5IGZyb20gXCJsb2Rhc2gvZ3JvdXBCeS5qc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB1bmlxIGZyb20gXCJsb2Rhc2gvdW5pcS5qc1wiO1xuaW1wb3J0IHVwcGVyRmlyc3QgZnJvbSBcImxvZGFzaC91cHBlckZpcnN0LmpzXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuLi8uLi9saWIvdXRpbC9jaGFsay5qc1wiO1xuaW1wb3J0IHsgY29tcGFyZSwgaW5jIH0gZnJvbSBcInNlbXZlclwiO1xuaW1wb3J0IHsgZXhlY1N5bmNSZXN1bHQgfSBmcm9tIFwiLi4vLi4vbGliL2V4ZWMvZXhlYy1zeW5jLXJlc3VsdC5qc1wiO1xuXG5jb25zdCB7IGV4aXN0c1N5bmMsIHJlYWRGaWxlU3luYywgcmVhZEpTT05TeW5jLCB3cml0ZUZpbGVTeW5jIH0gPSBmcztcblxuLyoqIEB0eXBlIHt7W2tleTogc3RyaW5nXTogJ2JyZWFraW5nJyB8ICdhZGRlZCcgfCAnZml4ZWQnIHwgJ3Rhc2snfX0gKi9cbmNvbnN0IHJlbGVhc2VUYWdzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICBicmVha2luZzogXCJicmVha2luZ1wiLFxuXG4gIGZlYXQ6IFwiYWRkZWRcIixcbiAgZmVhdHVyZTogXCJhZGRlZFwiLFxuICBhZGRlZDogXCJhZGRlZFwiLFxuXG4gIGZpeDogXCJmaXhlZFwiLFxuICBmaXhlZDogXCJmaXhlZFwiLFxuICBob3RmaXg6IFwiZml4ZWRcIixcblxuICB0YXNrOiBcInRhc2tcIixcbn07XG5cbmNvbnN0IHRhZ09yZGVyID0gdW5pcShPYmplY3QudmFsdWVzKHJlbGVhc2VUYWdzKSk7XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IG5vdGVzXG4gKi9cbmZ1bmN0aW9uIGdldFJlbGVhc2VUeXBlKG5vdGVzOiBzdHJpbmcpIHtcbiAgY29uc3QgZ3JvdXBzID0gbm90ZXNcbiAgICAudG9Mb3dlckNhc2UoKVxuICAgIC5zcGxpdChcIlxcblwiKVxuICAgIC5tYXAoKGxpbmUpID0+IChsaW5lLm1hdGNoKC8jIyAoXFx3KykvKSB8fCBbXSlbMV0pXG4gICAgLmZpbHRlcihCb29sZWFuKTtcbiAgaWYgKGdyb3Vwcy5pbmNsdWRlcyhcImJyZWFraW5nXCIpKSByZXR1cm4gXCJtYWpvclwiO1xuICBpZiAoZ3JvdXBzLmluY2x1ZGVzKFwiYWRkZWRcIikpIHJldHVybiBcIm1pbm9yXCI7XG4gIHJldHVybiBcInBhdGNoXCI7XG59XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGZvclZlcnNpb24gVGhlIHZlcnNpb24gdG8gYnVpbGQgdGhlIHJlbGVhc2Ugbm90ZXMgZm9yXG4gKlxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5hc3luYyBmdW5jdGlvbiBidWlsZFJlbGVhc2VOb3Rlcyhmb3JWZXJzaW9uOiBzdHJpbmcpIHtcbiAgY29uc29sZS53YXJuKFwiQnVpbGRpbmcgcmVsZWFzZSBub3Rlcy4uLlwiKTtcblxuICBjb25zb2xlLndhcm4oXCJmZXRjaGluZyB0YWdzLi4uXCIpO1xuICBjb25zdCBnZXRUYWdzID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoXCJnaXRcIiwgW1widGFnXCIsIFwiLS1saXN0XCJdKTtcblxuICBpZiAoZ2V0VGFncyA9PT0gbnVsbCkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3QgZ2V0IGdpdCB0YWdzXCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnN0IHRhZ3MgPSBnZXRUYWdzLnRyaW0oKS5zcGxpdChcIlxcblwiKS5zb3J0KGNvbXBhcmUpO1xuXG4gIGNvbnN0IHByZXZpb3VzVmVyc2lvbiA9XG4gICAgdGFnc1tcbiAgICAgICh0YWdzLmluY2x1ZGVzKGZvclZlcnNpb24pID8gdGFncy5pbmRleE9mKGZvclZlcnNpb24pIDogdGFncy5sZW5ndGgpIC0gMVxuICAgIF07XG5cbiAgY29uc29sZS53YXJuKFwiZmV0Y2hpbmcgdmVyc2lvbiBoYXNoLi4uXCIpO1xuICBjb25zdCBjdXJyZW50VmVyc2lvbkhhc2hFeGVjID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoYGdpdGAsIFtcbiAgICBcInJldi1saXN0XCIsXG4gICAgXCItMVwiLFxuICAgIGAke2ZvclZlcnNpb259YCxcbiAgXSk7XG5cbiAgaWYgKGN1cnJlbnRWZXJzaW9uSGFzaEV4ZWMgPT09IG51bGwpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiQ291bGRuJ3QgZ2V0IGN1cnJlbnQgdmVyc2lvbiBoYXNoXCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnN0IGN1cnJlbnRWZXJzaW9uSGFzaCA9IGN1cnJlbnRWZXJzaW9uSGFzaEV4ZWMudHJpbSgpO1xuXG4gIGNvbnNvbGUud2FybihcImZldGNoaW5nIHByZXZpb3VzIHZlcnNpb24gaGFzaC4uLlwiKTtcbiAgbGV0IHByZXZpb3VzVmVyc2lvbkhhc2hFeGVjID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoYGdpdGAsIFtcbiAgICBgcmV2LWxpc3RgLFxuICAgIGAtMWAsXG4gICAgYCR7cHJldmlvdXNWZXJzaW9ufWAsXG4gIF0pO1xuXG4gIGlmIChwcmV2aW91c1ZlcnNpb25IYXNoRXhlYyA9PT0gbnVsbCkge1xuICAgIHByZXZpb3VzVmVyc2lvbkhhc2hFeGVjID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoYGdpdGAsIFtcbiAgICAgIGByZXYtbGlzdGAsXG4gICAgICBcIi0tbWF4LXBhcmVudHM9MFwiLFxuICAgICAgXCJIRUFEXCIsXG4gICAgXSk7XG5cbiAgICBpZiAocHJldmlvdXNWZXJzaW9uSGFzaEV4ZWMgPT09IG51bGwpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZG4ndCBnZXQgcHJldmlvdXMgdmVyc2lvbiBoYXNoXCIpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHByZXZpb3VzVmVyc2lvbkhhc2ggPSBwcmV2aW91c1ZlcnNpb25IYXNoRXhlYy50cmltKCk7XG5cbiAgY29uc29sZS53YXJuKFwiZmV0Y2hpbmcgbG9ncy4uLlwiKTtcbiAgY29uc3QgbG9nc0V4ZWMgPSBhd2FpdCBleGVjU3luY1Jlc3VsdChgZ2l0YCwgW1xuICAgIFwibG9nXCIsXG4gICAgXCItLXByZXR0eT0lQlwiLFxuICAgIGAke3ByZXZpb3VzVmVyc2lvbkhhc2h9Li4uJHtjdXJyZW50VmVyc2lvbkhhc2h9YCxcbiAgXSk7XG5cbiAgaWYgKGxvZ3NFeGVjID09PSBudWxsKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGdldCBsb2dzXCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnN0IGxvZ3MgPSBsb2dzRXhlY1xuICAgIC5zcGxpdChcIlxcblwiKVxuICAgIC8vIENvbnZlcnQgdGhlIGxpbmVzIGludG8gYW4gYXJyYXkgb2YgdGFnIGFuZCBtZXNzYWdlIG9iamVjdHNcbiAgICAubWFwKChsaW5lKSA9PiB7XG4gICAgICBjb25zdCBbLCB0YWcgPSBcIlwiLCBtZXNzYWdlID0gXCJcIl0gPVxuICAgICAgICBsaW5lLm1hdGNoKC9eXFxzKihcXHcrPylcXHMqOlxccyooLiopXFxzKiQvKSB8fCBbXTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRhZzogcmVsZWFzZVRhZ3NbdGFnLnRvTG93ZXJDYXNlKCldLFxuICAgICAgICBtZXNzYWdlOiB1cHBlckZpcnN0KG1lc3NhZ2UpLFxuICAgICAgfTtcbiAgICB9KVxuICAgIC8vIFJlbW92ZSBsaW5lcyB0aGF0IGRvIG5vdCBjb250YWluIGEga25vd24gdGFnXG4gICAgLmZpbHRlcigobm90ZSkgPT4gbm90ZS50YWcpO1xuXG4gIGNvbnN0IGdyb3VwcyA9IGdyb3VwQnkobG9ncywgXCJ0YWdcIik7XG4gIC8vIEJ1aWxkIHRoZSByZWxlYXNlIG5vdGVzXG4gIGNvbnN0IHRleHQgPSB0YWdPcmRlclxuICAgIC8vIFJlbW92ZSB0YWdzIHRoYXQgZG9uJ3QgZXhpc3QgaW4gdGhlIGN1cnJlbnQgb3V0cHV0XG4gICAgLmZpbHRlcigoZ3JvdXBOYW1lKSA9PiBncm91cHNbZ3JvdXBOYW1lXSlcbiAgICAubWFwKChncm91cE5hbWUpID0+IHtcbiAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW2dyb3VwTmFtZV07XG4gICAgICByZXR1cm4gYCMjICR7Z3JvdXBOYW1lLnJlcGxhY2UoLyhcXHcpLywgKGMpID0+IGMudG9VcHBlckNhc2UoKSl9XFxuXFxuJHtncm91cFxuICAgICAgICAubWFwKCh7IHRhZywgbWVzc2FnZSB9KSA9PiBgLSBbXFxgJHt0YWcudG9VcHBlckNhc2UoKX1cXGBdOiAke21lc3NhZ2V9YClcbiAgICAgICAgLmpvaW4oXCJcXG5cIil9YDtcbiAgICB9KVxuICAgIC5qb2luKFwiXFxuXFxuXCIpO1xuXG4gIGNvbnNvbGUud2FybihcIk5ldyByZWxlYXNlIG5vdGVzIGNvbXBsZXRlZFwiKTtcbiAgcmV0dXJuIHRleHQ7XG59XG5cbi8qKlxuICogUHJpbnQgcmVsZWFzZSBub3RlcyBzaW5jZSB0aGUgbGFzdCByZWxlYXNlXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgU2VlIGJlbG93XG4gKiBAcGFyYW0ge3N0cmluZ30gb3B0aW9ucy5maWxlIFRoZSBmaWxlIHRvIHByaW50IHJlbGVhc2Ugbm90ZXMgdG8uIElmIHRoaXMgaXNcbiAqIGxlZnQgYmxhbmssIHRoZW4gdGhlIHJlbGVhc2Ugbm90ZXMgd2lsbCBiZSBwcmludGVkIHRvIFNURE9VVC5cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy51cGRhdGVQYWNrYWdlIFVwZGF0ZSB0aGUgcGFja2FnZS5qc29uXG4gKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMudGFnIFRydWUgaWYgYSBnaXQgdGFnIHNob3VsZCBiZSBjcmVhdGVkXG4gKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMuZXJyb3JPbkVtcHR5IFRydWUgaWYgbm8gcmVsZWFzZSBub3RlcyB3aWxsIGJlIGNyZWF0ZWRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKFxuICBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBib29sZWFuIHwgbnVtYmVyPiA9IHt9XG4pIHtcbiAgY29uc29sZS53YXJuKFwiR2VuZXJhdGluZyBSZWxlYXNlIE5vdGVzLi4uXCIpO1xuICAvLyBQdWxsIGluIGFueSB0YWdzXG4gIGNvbnN0IGZldGNoRXhlYyA9IGF3YWl0IGV4ZWNTeW5jUmVzdWx0KFwiZ2l0XCIsIFtcImZldGNoXCIsIFwiLS10YWdzXCJdKTtcblxuICBpZiAoZmV0Y2hFeGVjID09PSBudWxsKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGZldGNoIHRhZ3NcIik7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgLy8gR2V0IHRoZSBjdXJyZW50IHZlcnNpb25cbiAgY29uc3QgcGtnID0gcmVhZEpTT05TeW5jKHBhdGgucmVzb2x2ZShcInBhY2thZ2UuanNvblwiKSk7XG4gIGNvbnN0IHsgdmVyc2lvbjogY3VycmVudFZlcnNpb24gPSBcIjAuMC4xXCIgfSA9IHBrZztcbiAgY29uc29sZS53YXJuKFwiQ3VycmVudCBQcm9qZWN0IHZlcnNpb246XCIsIHsgY3VycmVudFZlcnNpb24gfSk7XG5cbiAgY29uc3Qgbm90ZXMgPSBhd2FpdCBidWlsZFJlbGVhc2VOb3RlcyhcIkhFQURcIik7XG4gIGNvbnN0IHJlbGVhc2VUeXBlID0gZ2V0UmVsZWFzZVR5cGUobm90ZXMpO1xuICBjb25zdCBuZXdWZXJzaW9uID0gcmVsZWFzZVR5cGUgJiYgaW5jKGN1cnJlbnRWZXJzaW9uLCByZWxlYXNlVHlwZSk7XG5cbiAgaWYgKCFuZXdWZXJzaW9uKSB7XG4gICAgY29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBkZXRlcm1pbmUgbmV4dCB2ZXJzaW9uXCIsIHsgY3VycmVudFZlcnNpb24gfSk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgLy8gQ3JlYXRlIHRoZSB0YWcgaWYgd2Ugd2VyZSB0b2xkIHRvIGRvIHNvXG4gIGlmIChvcHRpb25zLnRhZykge1xuICAgIGNvbnNvbGUud2FybihcIkNyZWF0aW5nIHRoZSBuZXcgdGFnLi4uXCIpO1xuICAgIGNvbnN0IHRhZ0V4ZWMgPSBhd2FpdCBleGVjU3luY1Jlc3VsdChgZ2l0YCwgW1xuICAgICAgXCJ0YWdcIixcbiAgICAgIFwiLWFcIixcbiAgICAgIG5ld1ZlcnNpb24sXG4gICAgICBcIi1tXCIsXG4gICAgICBgUmVsZWFzZSAke25ld1ZlcnNpb259YCxcbiAgICBdKTtcblxuICAgIGlmICh0YWdFeGVjID09PSBudWxsKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiQ291bGRuJ3QgY3JlYXRlIHRhZ1wiKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG4gIH1cblxuICAvLyBVcGRhdGUgcGFja2FnZS5qc29uIGlmIHdlIHdlcmUgdG9sZCB0byBkbyBzb1xuICBpZiAob3B0aW9ucy51cGRhdGVQYWNrYWdlKSB7XG4gICAgY29uc29sZS53YXJuKFwiVXBkYXRpbmcgdGhlIHBhY2thZ2UuanNvbi4uLlwiKTtcbiAgICBjb25zdCBwa2cgPSByZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKTtcbiAgICBwa2cudmVyc2lvbiA9IG5ld1ZlcnNpb247XG5cbiAgICB3cml0ZUZpbGVTeW5jKFxuICAgICAgcGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpLFxuICAgICAgYCR7SlNPTi5zdHJpbmdpZnkocGtnLCBudWxsLCBcIiAgXCIpfVxcbmBcbiAgICApO1xuICB9XG5cbiAgY29uc3QgdGV4dCA9IGAjIyAke25ld1ZlcnNpb259XFxuXFxuJHtub3Rlc31gO1xuXG4gIC8vIElmIHRoZSBub3RlcyBhcmUgZW1wdHksIHRocm93IGFuIGVycm9yIGlmIHJlcXVlc3RlZCB0byBkbyBzb1xuICBpZiAoIW5vdGVzLnRyaW0oKSAmJiBvcHRpb25zLmVycm9yT25FbXB0eSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIFwiTm8gbm90ZXMgd2VyZSBnZW5lcmF0ZWQgYXMgbm8gc2VtdmVyIHN0eWxlIG1lc3NhZ2VzIHdlcmUgZm91bmRcIlxuICAgICk7XG4gIH1cblxuICAvLyBPdXRwdXQgdGhlIG5vdGVzIHRvIHRoZSBjb25zb2xlIG9yIGEgZmlsZVxuICBpZiAob3B0aW9ucy5maWxlKSB7XG4gICAgY29uc29sZS53YXJuKFwiV3JpdGluZyB0aGUgcmVsZWFzZSBub3RlcyB0byBmaWxlOlwiLCBvcHRpb25zLmZpbGUpO1xuICAgIGNvbnN0IGZpbGUgPSBwYXRoLnJlc29sdmUob3B0aW9ucy5maWxlIGFzIHN0cmluZyk7XG4gICAgY29uc3QgcHJldmlvdXNUZXh0ID0gZXhpc3RzU3luYyhmaWxlKSA/IHJlYWRGaWxlU3luYyhmaWxlKSA6IFwiXCI7XG4gICAgd3JpdGVGaWxlU3luYyhmaWxlLCBgJHtgJHt0ZXh0fVxcblxcbiR7cHJldmlvdXNUZXh0fWAudHJpbSgpfVxcbmApO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gMTAwOyArK2kpIHtcbiAgICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGUpKSBicmVhaztcbiAgICAgIGlmIChpID09PSAxMDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIFwiUmVsZWFzZSBub3RlcyBmaWxlIHdhcyBub3QgY3JlYXRlZCBpbiB0aW1lIGZvciB0aGUgZmluYWwgcmVsZWFzZSBjb21taXQ6XCIsXG4gICAgICAgICAgY2hhbGsucmVkQnJpZ2h0Qm9sZChmaWxlKVxuICAgICAgICApO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIGFsbCBmcmFnbWVudHMgYXJlIGdvaW5nIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBjb21taXRcbiAgICBjb25zb2xlLndhcm4oXCJBZGRpbmcgZnJhZ21lbnRzIHRvIGdpdC4uLlwiKTtcbiAgICBpZiAoKGF3YWl0IGV4ZWNTeW5jUmVzdWx0KFwiZ2l0XCIsIFtcImFkZFwiLCBcIi1BXCJdKSkgPT09IG51bGwpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJDb3VsZCBub3QgZW5zdXJlIGFsbCBmcmFnbWVudHMgYXJlIGFkZGVkIGZvciB0aGUgbmV4dCBjb21taXQuXCJcbiAgICAgICk7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuXG4gICAgLy8gQ29tbWl0IHRoZSBjaGFuZ2VzXG4gICAgY29uc29sZS53YXJuKFwiQ29tbWl0dGluZyB0byBnaXQuLi5cIik7XG4gICAgY29uc3QgY29tbWl0RXhlYyA9IGF3YWl0IGV4ZWNTeW5jUmVzdWx0KFwiZ2l0XCIsIFtcbiAgICAgIFwiY29tbWl0XCIsXG4gICAgICBcIi1hbVwiLFxuICAgICAgYFJlbGVhc2UgJHtuZXdWZXJzaW9ufWAsXG4gICAgXSk7XG5cbiAgICBpZiAoY29tbWl0RXhlYyA9PT0gbnVsbCkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkbid0IGNvbW1pdCBjaGFuZ2VzXCIpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cblxuICAgIGNvbnNvbGUud2FybihgXFxuXFxuJHtjaGFsay5jeWFuKHRleHQpfVxcblxcbmApO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUud2FybihgXFxuXFxuJHtjaGFsay5jeWFuKHRleHQpfVxcblxcbmApO1xuICB9XG5cbiAgLy8gV2hlbmV2ZXIgdGhpcyBpcyByYW4gaXQgbWFrZXMgc2Vuc2UgdG8gdXBkYXRlIG91ciByZWxlYXNlIHZlcnNpb24gaGVyZSBzb1xuICAvLyBpdCBpcyBhdmFpYWxibGUgdG8gdGhlIHJlc3Qgb2YgYW55IHByb2Nlc3MgcnVubmluZyB1bmRlciBpdCdzIGFzc3VtcHRpb25zLlxuICBwcm9jZXNzLmVudi5WSVRFX1JFTEVBU0VfVkVSU0lPTiA9IG5ld1ZlcnNpb247XG59XG4iLAogICJpbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCIuLi9leGVjL2V4ZWMtc3luYy5qc1wiO1xuXG4vKipcbiAqIFRoaXMgY2hlY2tzIGlmIHRoZSBjdXJyZW50IGdpdCBjb250ZXh0IGhhcyBhY2Nlc3MgdG8gdGhlIHNwZWNpZmllZCByZW1vdGVcbiAqIHJlcG9zaXRvcnkuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnaXRDYW5BY2Nlc3NSZW1vdGUocmVtb3RlOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGV4ZWNTeW5jKGBnaXRgLCBbYGxzLXJlbW90ZWAsIHJlbW90ZV0pO1xufVxuIiwKICAiaW1wb3J0IHsgZGVzY3JpcHRpb24gfSBmcm9tIFwiLi4vdXRpbC9kZXNjcmlwdGlvbi5qc1wiO1xuaW1wb3J0IHsgZXhlY1N5bmNSZXN1bHQgfSBmcm9tIFwiLi4vZXhlYy9leGVjLXN5bmMtcmVzdWx0LmpzXCI7XG5pbXBvcnQgeyBnaXRDYW5BY2Nlc3NSZW1vdGUgfSBmcm9tIFwiLi9naXQtY2FuLWFjY2Vzcy1yZW1vdGUuanNcIjtcblxuLyoqXG4gKiBFbnN1cmVzIHRoZSBkZXZlbG9wZXIgaGFzIGVzdGFibGlzaGVkIHRoZSBwcm92aWRlZCByZW1vdGUgbmFtZSBBTkQgaGFzIGFjY2Vzc1xuICogdG8gdGhlIHJlbW90ZSBVUkwgYXNzb2NpYXRlZCB3aXRoIHRoZSByZW1vdGUgbmFtZS4gVGhpcyBpcyBhbiBhc3NlcnRpb24gc29cbiAqIHdpbGwgY2F1c2UgdGhlIHByb2dyYW0gdG8gZXhpdCBvbiBmYWlsdXJlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2l0RW5zdXJlUmVtb3RlKHJlbW90ZTogc3RyaW5nKSB7XG4gIC8vIFdlIGNoZWNrIG91ciByZW1vdGUgdG8gZW5zdXJlIHdlIGhhdmUgYSBwcm9qZWN0IHdpdGggZXhwZWN0ZWQgdmFsdWVzXG4gIGNvbnN0IHJlbW90ZUxpc3RQcm9jZXNzID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoXCJnaXRcIiwgW1wicmVtb3RlXCIsIFwiLXZcIl0pO1xuXG4gIGlmIChyZW1vdGVMaXN0UHJvY2VzcyA9PT0gbnVsbCkge1xuICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBsaXN0IHJlbW90ZXMgZm9yIHRoZSBnaXQgcHJvamVjdC5cIik7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgY29uc3QgcmVtb3RlcyA9IHJlbW90ZUxpc3RQcm9jZXNzLnNwbGl0KC9cXHI/XFxuL2cpO1xuXG4gIGNvbnN0IGZvdW5kUmVtb3RlID0gcmVtb3Rlcy5maW5kKChyb3cpID0+IHJvdy5pbmRleE9mKHJlbW90ZSkgPj0gMCk7XG5cbiAgaWYgKCFmb3VuZFJlbW90ZSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIGRlc2NyaXB0aW9uYFxuICAgICAgWW91IE1VU1QgaGF2ZSBhIHJlbW90ZSBuYW1lZCAke3JlbW90ZX0gd2hpY2ggcG9pbnRzIHRvIHRoZSByZXBvc2l0b3J5IHlvdVxuICAgICAgd2lzaCB0byBkZXBsb3kgdG8uXG5cbiAgICAgICR7cmVtb3Rlcy5qb2luKFwiXFxuXCIpfVxuICAgIGBcbiAgICApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnN0IHJlbW90ZVVybCA9IGZvdW5kUmVtb3RlLnNwbGl0KC9cXHMrL2cpWzFdO1xuXG4gIC8vIE5vdyBjaGVjayB0byBtYWtlIHN1cmUgdGhlIHJlcG8gc3BlY2lmaWVkIGV4aXN0cyBpbiBnaXQgYW5kIGlzIGF2YWlsYWJsZSB0b1xuICAvLyB0aGUgdXNlclxuICBpZiAoIWdpdENhbkFjY2Vzc1JlbW90ZShyZW1vdGVVcmwpKSB7XG4gICAgY29uc29sZS53YXJuKGBcbiAgICAgIFlvdSBkbyBub3Qgc2VlbSB0byBoYXZlIGFjY2VzcyB0byB0aGUgcmVwbyBsaXN0ZWQgaW4gdGhlIHBhY2thZ2UganNvbiBvZlxuICAgICAgdGhpcyBwcm9qZWN0LiBQbGVhc2UgZW5zdXJlIHlvdSBoYXZlIHdyaXRlIGFjY2VzcyB0byB0aGUgcmVwbzpcbiAgICAgICR7cmVtb3RlVXJsfVxuICAgICAgYW5kIHRoZW4gdHJ5IHRvIHJ1biB0aGUgcmVsZWFzZSBhZ2Fpbi5cbiAgICBgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cbiIsCiAgImltcG9ydCB7IGV4ZWNTeW5jUmVzdWx0IH0gZnJvbSBcIi4uL2V4ZWMvZXhlYy1zeW5jLXJlc3VsdC5qc1wiO1xuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY3VycmVudCBicmFuY2ggaW4gdGhlIGN1cnJlbnQgZ2l0IGNvbnRleHQuIFJldHVybnMgdm9pZCBpZiBhXG4gKiBicmFuY2ggY2FuIG5vdCBiZSBkZXRlcm1pbmVkLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2l0Q3VycmVudEJyYW5jaCgpIHtcbiAgLy8gR2V0IHRoZSBjdXJyZW50IGJyYW5jaCBuYW1lIHNvIHdlIGNhbiBvYnRhaW4gdGhlIGhhc2ggb2YgdGhlIHRpY2tldFxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjU3luY1Jlc3VsdChcImdpdFwiLCBbXG4gICAgXCJyZXYtcGFyc2VcIixcbiAgICBcIi0tYWJicmV2LXJlZlwiLFxuICAgIFwiSEVBRFwiLFxuICBdKTtcblxuICBpZiAocmVzdWx0ID09PSBudWxsKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBkZXRlcm1pbmUgY3VycmVudCBicmFuY2guXCIpO1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cblxuICBjb25zdCBicmFuY2ggPSByZXN1bHQudHJpbSgpO1xuICByZXR1cm4gYnJhbmNoIHx8IHZvaWQgMDtcbn1cbiIsCiAgImltcG9ydCB7IGV4ZWNTeW5jUmVzdWx0IH0gZnJvbSBcIi4uL2V4ZWMvZXhlYy1zeW5jLXJlc3VsdC5qc1wiO1xuaW1wb3J0IHsgZ2l0Q3VycmVudEJyYW5jaCB9IGZyb20gXCIuL2dpdC1jdXJyZW50LWJyYW5jaC5qc1wiO1xuXG4vKipcbiAqIFRoaXMgc3dpdGNoZXMgdG8gdGhlIGJyYW5jaCBzcGVjaWZpZWQsIHRoZW4gcmVzZXQgLS1oYXJkIG9yaWdpbi9icmFuY2ggdG9cbiAqIG1ha2Ugc3VyZSBpdCByZWZsZWN0cyB0aGUgcmVwbywgdGhlbiByZXR1cm5zIHRvIHRoZSBjdXJyZW50IGJyYW5jaC5cbiAqL1xuZXhwb3J0IGNvbnN0IGdpdFVwZGF0ZUJyYW5jaCA9IGFzeW5jIChyZW1vdGU6IHN0cmluZywgYnJhbmNoOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgYnJhbmNoQmFrID0gYXdhaXQgZ2l0Q3VycmVudEJyYW5jaCgpO1xuXG4gIGlmICghYnJhbmNoQmFrKSB7XG4gICAgY29uc29sZS53YXJuKFwiQ291bGQgbm90IGRldGVybWluZSBjdXJyZW50IGJyYW5jaC5cIik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gQ2hlY2tvdXQgdGhlIHNwZWNpZmllZCBicmFuY2hcbiAgaWYgKChhd2FpdCBleGVjU3luY1Jlc3VsdChgZ2l0YCwgW1wiY2hlY2tvdXRcIiwgYCR7YnJhbmNofWBdKSkgPT09IG51bGwpIHtcbiAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBjaGVja291dCBicmFuY2ggJHticmFuY2h9YCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gUGVyZm9ybSB0aGUgcmVzZXRcbiAgaWYgKFxuICAgIChhd2FpdCBleGVjU3luY1Jlc3VsdChgZ2l0YCwgW1xuICAgICAgXCJyZXNldFwiLFxuICAgICAgXCItLWhhcmRcIixcbiAgICAgIGAke3JlbW90ZX0vJHticmFuY2h9YCxcbiAgICBdKSkgPT09IG51bGxcbiAgKSB7XG4gICAgY29uc29sZS53YXJuKGBDb3VsZCBub3QgcmVzZXQgYnJhbmNoICR7YnJhbmNofWApO1xuXG4gICAgLy8gUmV0dXJuIHRvIHRoZSBvcmlnaW5hbCBicmFuY2hcbiAgICBpZiAoYXdhaXQgZXhlY1N5bmNSZXN1bHQoYGdpdGAsIFtcImNoZWNrb3V0XCIsIGAke2JyYW5jaEJha31gXSkpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQ291bGQgbm90IHJldHVybiB0byBvcmlnaW5hbCBicmFuY2ggJHticmFuY2hCYWt9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gUmV0dXJuIHRvIHRoZSBvcmlnaW5hbCBicmFuY2hcbiAgaWYgKChhd2FpdCBleGVjU3luY1Jlc3VsdChgZ2l0YCwgW1wiY2hlY2tvdXRcIiwgYCR7YnJhbmNoQmFrfWBdKSkgPT09IG51bGwpIHtcbiAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZXR1cm4gdG8gb3JpZ2luYWwgYnJhbmNoICR7YnJhbmNoQmFrfWApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0YXJnZXRQcm9qZWN0UmVwbygpIHtcbiAgY29uc3QgcGFja2FnZUpzb24gPSBmcy5yZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKTtcbiAgcmV0dXJuIHBhY2thZ2VKc29uLnJlcG9zaXRvcnkgfHwge307XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHJlbGVhc2VCdWlsZCBmcm9tIFwiLi9yZWxlYXNlLWJ1aWxkLmpzXCI7XG5pbXBvcnQgcmVsZWFzZU5vdGVzIGZyb20gXCIuL3JlbGVhc2Utdmlldy5qc1wiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vLi4vbGliL3V0aWwvY2hhbGsuanNcIjtcbmltcG9ydCB7IGRlc2NyaXB0aW9uIH0gZnJvbSBcIi4uLy4uL2xpYi91dGlsL2Rlc2NyaXB0aW9uLmpzXCI7XG5pbXBvcnQgeyBleGVjU2NyaXB0IH0gZnJvbSBcIi4uLy4uL2xpYi9leGVjL2V4ZWMtc2NyaXB0LmpzXCI7XG5pbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCIuLi8uLi9saWIvZXhlYy9leGVjLXN5bmMuanNcIjtcbmltcG9ydCB7IGV4ZWNTeW5jUmVzdWx0IH0gZnJvbSBcIi4uLy4uL2xpYi9leGVjL2V4ZWMtc3luYy1yZXN1bHQuanNcIjtcbmltcG9ydCB7IGdpdENhbkFjY2Vzc1JlbW90ZSB9IGZyb20gXCIuLi8uLi9saWIvZ2l0L2dpdC1jYW4tYWNjZXNzLXJlbW90ZS5qc1wiO1xuaW1wb3J0IHsgZ2l0RW5zdXJlUmVtb3RlIH0gZnJvbSBcIi4uLy4uL2xpYi9naXQvZ2l0LWVuc3VyZS1yZW1vdGUuanNcIjtcbmltcG9ydCB7IGdpdEhhc0NoYW5nZXMgfSBmcm9tIFwiLi4vLi4vbGliL2dpdC9naXQtaGFzLWNoYW5nZXMuanNcIjtcbmltcG9ydCB7IGdpdFJldHVyblRvRGV2IH0gZnJvbSBcIi4uLy4uL2xpYi9naXQvZ2l0LXJldHVybi10by1kZXYuanNcIjtcbmltcG9ydCB7IGdpdFVwZGF0ZUJyYW5jaCB9IGZyb20gXCIuLi8uLi9saWIvZ2l0L2dpdC11cGRhdGUtYnJhbmNoLmpzXCI7XG5pbXBvcnQgeyBwcm9tcHRDb25maXJtIH0gZnJvbSBcIi4uLy4uL2xpYi9wcm9tcHQvcHJvbXB0LWNvbmZpcm0uanNcIjtcbmltcG9ydCB7IHRhcmdldFByb2plY3RSZXBvIH0gZnJvbSBcIi4uLy4uL2xpYi90YXJnZXQtcHJvamVjdC90YXJnZXQtcHJvamVjdC1yZXBvLmpzXCI7XG5pbXBvcnQgeyB0YXJnZXRQcm9qZWN0VmVyc2lvbiB9IGZyb20gXCIuLi8uLi9saWIvdGFyZ2V0LXByb2plY3QvdGFyZ2V0LXByb2plY3QtdmVyc2lvbi5qc1wiO1xuXG4vKipcbiAqIFRoaXMgaXMgdGhlIHJlcXVpcmVkIHJlbW90ZSBuYW1lIHRoYXQgbXVzdCBiZSBwcmVzZW50IGZvciB0aGUgcmVsZWFzZSBzY3JpcHRcbiAqIHRvIHdvcmtcbiAqL1xuY29uc3QgRU5TVVJFX1JFTU9URSA9IFwib3JpZ2luXCI7XG5cbi8qKlxuICogVGhpcyBtZXRob2QgY2hlY2tzIGFsbCBvZiB0aGUgcGFja2FnZSBqc29uIHNldHRpbmdzIGFuZCBlbnN1cmVzIHRoZVxuICogcmVwb3NpdG9yaWVzIGxpc3RlZCBhcmUgdmFsaWQgZm9yIHVzZSB3aXRoaW4gdGhpcyBjb250ZXh0LlxuICovXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVJlcG9zaXRvcnkoKSB7XG4gIGNvbnN0IHByb2plY3RSZXBvID0gYXdhaXQgdGFyZ2V0UHJvamVjdFJlcG8oKTtcbiAgY29uc3QgRU5TVVJFX1JFTU9URV9QUk9KRUNUID0gcHJvamVjdFJlcG8udXJsO1xuXG4gIGlmIChcbiAgICAhcHJvamVjdFJlcG8gfHxcbiAgICAhKFxuICAgICAgcHJvamVjdFJlcG8udHlwZSAhPT0gXCJnaXRsYWJcIiB8fFxuICAgICAgcHJvamVjdFJlcG8udHlwZSAhPT0gXCJnaXRcIiB8fFxuICAgICAgcHJvamVjdFJlcG8udHlwZSAhPT0gXCJiaXRidWNrZXRcIiB8fFxuICAgICAgcHJvamVjdFJlcG8udHlwZSAhPT0gXCJzdGFzaFwiXG4gICAgKVxuICApIHtcbiAgICBjb25zb2xlLndhcm4oYFxuICAgICAgWW91IE1VU1QgaGF2ZSBhIHJlcG9zaXRvcnkgc3BlY2lmaWVkIGluIHlvdXIgcGFja2FnZSBqc29uIHRvIHVzZSB0aGVcbiAgICAgIHJlbGVhc2Ugc2NyaXB0LiBJdCBtdXN0IGJlIG9mICd0eXBlOiBnaXQnIGFuZCBoYXZlIGEgdmFsaWQgc3NoIHVybCB0b1xuICAgICAgeW91ciBnaXQgcmVwby5cblxuICAgICAgQWRkaXRpb25hbGx5LCB5b3UgTVVTVCBoYXZlIGEgcmVtb3RlIGNvbmZpZ3VyZWQgZm9yIHlvdXIgcHJvamVjdCBvZlxuICAgICAgJ29yaWdpbicgdGhhdCBtYXRjaGVzIHRoZSByZXBvIHVybCBsaXN0ZWQgaW4geW91ciBwYWNrYWdlLmpzb24uXG5cbiAgICAgIFRodXM6IFwiZ2l0IHJlbW90ZSAtdlwiIFNIT1VMRCBvdXRwdXQgYSBsaW5lIHdpdGhcbiAgICAgIG9yaWdpbiA8dXJsIGluIHlvdXIgcGFja2FnZSBqc29uIHJlcG9zaXRvcnkgZmllbGQ+IChwdXNoKVxuICAgIGApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIC8vIFdlIGNoZWNrIG91ciByZW1vdGUgdG8gZW5zdXJlIHdlIGhhdmUgYSBwcm9qZWN0IHdpdGggZXhwZWN0ZWQgdmFsdWVzXG4gIGNvbnN0IHJlbW90ZUxpc3RQcm9jZXNzID0gYXdhaXQgZXhlY1N5bmNSZXN1bHQoXCJnaXRcIiwgW1wicmVtb3RlXCIsIFwiLXZcIl0pO1xuXG4gIGlmIChyZW1vdGVMaXN0UHJvY2VzcyA9PT0gbnVsbCkge1xuICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBsaXN0IHJlbW90ZXMgZm9yIHRoZSBnaXQgcHJvamVjdC5cIik7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgY29uc3QgcmVtb3RlcyA9IHJlbW90ZUxpc3RQcm9jZXNzLnNwbGl0KC9cXHI/XFxuL2cpO1xuXG4gIGNvbnN0IGZvdW5kUmVtb3RlID0gcmVtb3Rlcy5maW5kKFxuICAgIChyb3cpID0+XG4gICAgICByb3cuaW5kZXhPZihFTlNVUkVfUkVNT1RFKSA+PSAwICYmIHJvdy5pbmRleE9mKEVOU1VSRV9SRU1PVEVfUFJPSkVDVCkgPj0gMFxuICApO1xuXG4gIGlmICghZm91bmRSZW1vdGUpIHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBcIkNvdWxkIG5vdCBtYXRjaCBwYWNrYWdlIGpzb24gcmVwb3NpdG9yeSB0byBhbiBvcmlnaW4gcmVtb3RlIGluIGdpdCBDTElcIixcbiAgICAgIHsgcmVtb3RlTGlzdFByb2Nlc3MsIHJlbW90ZXMsIEVOU1VSRV9SRU1PVEUsIEVOU1VSRV9SRU1PVEVfUFJPSkVDVCB9XG4gICAgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cblxuICAvLyBOb3cgY2hlY2sgdG8gbWFrZSBzdXJlIHRoZSByZXBvIHNwZWNpZmllZCBleGlzdHMgaW4gZ2l0IGFuZCBpcyBhdmFpbGFibGUgdG9cbiAgLy8gdGhlIHVzZXJcbiAgaWYgKCFnaXRDYW5BY2Nlc3NSZW1vdGUoRU5TVVJFX1JFTU9URV9QUk9KRUNUKSkge1xuICAgIGNvbnNvbGUud2FybihgXG4gICAgICBZb3UgZG8gbm90IHNlZW0gdG8gaGF2ZSBhY2Nlc3MgdG8gdGhlIHJlcG8gbGlzdGVkIGluIHRoZSBwYWNrYWdlIGpzb24gb2ZcbiAgICAgIHRoaXMgcHJvamVjdC4gUGxlYXNlIGVuc3VyZSB5b3UgaGF2ZSB3cml0ZSBhY2Nlc3MgdG8gdGhlIHJlcG86XG4gICAgICAke0VOU1VSRV9SRU1PVEVfUFJPSkVDVH1cbiAgICAgIGFuZCB0aGVuIHRyeSB0byBydW4gdGhlIHJlbGVhc2UgYWdhaW4uXG4gICAgYCk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgLy8gV2UgY2FuIG9ubHkgZG8gdGhpcyBvcGVyYXRpb24gaWYgdGhlcmUgaXMgbm90aGluZyB0byBjb21taXQgb3IgcHVzaFxuICAvLyBUaGlzIG9ubHkgd29ya3MgaWYgbm8gY2hhbmdlcyBhcmUgcHJlc2VudFxuICBpZiAoYXdhaXQgZ2l0SGFzQ2hhbmdlcygpKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiWW91IGhhdmUgdW5jb21taXR0ZWQgY2hhbmdlcyBvciB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgcHJvamVjdCBjYW4gbm90IGJlIGRldGVybWluZWQuIFBsZWFzZSBjb21taXQgb3Igc3Rhc2ggdGhlbSBiZWZvcmUgY29udGludWluZy5cIlxuICAgICk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgY29uc29sZS53YXJuKFwiUmVwb3NpdG9yeSB2YWxpZGF0aW9uIGNvbXBsZXRlXCIpO1xufVxuXG4vKipcbiAqIE1ha2VzIHN1cmUgd2UgYXJlIG9uIHRoZSByZWxlYXNlIGJyYW5jaCBhbmQgY29tcGxldGVseSB1cGRhdGVkIHdpdGggdGhlXG4gKiBjb250ZW50cyBvZiBkZXYuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrb3V0UmVsZWFzZSgpIHtcbiAgLy8gTWFrZSBzdXJlIHdlJ3JlIG9uIGEgcmVsZWFzZSBicmFuY2ggdGhhdCBtYXRjaGVzIGRldlxuICBpZiAoIShhd2FpdCBhd2FpdCBleGVjU3luYyhcImdpdFwiLCBbXCJjaGVja291dFwiLCBcInJlbGVhc2VcIl0pKSkge1xuICAgIGlmICghKGF3YWl0IGV4ZWNTeW5jKFwiZ2l0XCIsIFtcImNoZWNrb3V0XCIsIFwiLWJcIiwgXCJyZWxlYXNlXCJdKSkpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJDb3VsZCBub3Qgc3dpdGNoIHRvIHRoZSByZWxlYXNlIGJyYW5jaC4gTWFrZSBzdXJlIHRoZSBicmFuY2ggZXhpc3RzIGxvY2FsbHkuXCJcbiAgICAgICk7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuICB9XG5cbiAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgdGhlIGxhdGVzdCBmcm9tIHRoZSByZW1vdGVcbiAgaWYgKCEoYXdhaXQgZXhlY1N5bmMoYGdpdGAsIFtcImZldGNoXCIsIGAke0VOU1VSRV9SRU1PVEV9YF0pKSkge1xuICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBmZXRjaCBmcm9tIHJlbW90ZSBzZXJ2ZXJzLlwiKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cblxuICAvLyBNYWtlIHN1cmUgd2UgYXJlIGV4YWN0bHkgd2hhdCBpcyBpbiBkZXZcbiAgaWYgKCEoYXdhaXQgZXhlY1N5bmMoYGdpdGAsIFtcInJlc2V0XCIsIFwiLS1oYXJkXCIsIGAke0VOU1VSRV9SRU1PVEV9L2RldmBdKSkpIHtcbiAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCByZXNldCBicmFuY2ggdG8gZGV2YCk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgY29uc29sZS53YXJuKFwiQ2hlY2tlZCBvdXQgcmVsZWFzZSBicmFuY2ggYW5kIHVwZGF0ZWQgdG8gZGV2XCIpO1xufVxuXG4vKipcbiAqIERldGVybWluZXMgdGhlIGxhc3QgcmVsZWFzZSB0eXBlIGJhc2VkIG9uIHRoZSBjb250ZW50cyBwbGFjZWQgd2l0aGluIHRoZVxuICogcmVsZWFzZSBub3RlcyBmaWxlLlxuICovXG5mdW5jdGlvbiBnZXRSZWxlYXNlVHlwZSgpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBub3Rlczogc3RyaW5nID0gZnMucmVhZEZpbGVTeW5jKFxuICAgICAgcGF0aC5yZXNvbHZlKFwiUkVMRUFTRV9OT1RFUy5tZFwiKSxcbiAgICAgIFwidXRmOFwiXG4gICAgKTtcbiAgICBjb25zdCBncm91cHMgPSBub3Rlc1xuICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgIC5zcGxpdChcIlxcblwiKVxuICAgICAgLm1hcCgobGluZSkgPT4gKGxpbmUubWF0Y2goLyMjIChcXHcrKS8pIHx8IFtdKVsxXSlcbiAgICAgIC5maWx0ZXIoQm9vbGVhbik7XG4gICAgaWYgKGdyb3Vwcy5pbmNsdWRlcyhcImJyZWFraW5nXCIpKSByZXR1cm4gXCJtYWpvclwiO1xuICAgIGlmIChncm91cHMuaW5jbHVkZXMoXCJhZGRlZFwiKSkgcmV0dXJuIFwibWlub3JcIjtcbiAgICByZXR1cm4gXCJwYXRjaFwiO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiQ291bGQgbm90IGRldGVybWluZSByZWxlYXNlIHR5cGUgYWZ0ZXIgcmVsZWFzZSB3YXMgY3JlYXRlZFwiKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGUgb3VyIHJlbGVhc2Ugbm90ZXMgYW5kIGRldGVybWluZSB3aGF0IG91ciBuZXh0IHZlcnNpb24gaXMgZ29pbmcgdG8gYmVcbiAqIGJhc2VkIG9uIGNvbW1pdCBtZXNzYWdlcy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVmVyc2lvbihhbHRlcm5hdGU/OiBzdHJpbmcpIHtcbiAgLy8gR2V0IG91ciBjdXJyZW50IHZlcnNpb24gc28gd2UgY2FuIGVuc3VyZSBvdXIgdmVyc2lvbiBjaGFuZ2VkLlxuICBjb25zdCBjdXJyZW50VmVyc2lvbiA9IGF3YWl0IHRhcmdldFByb2plY3RWZXJzaW9uKCk7XG5cbiAgLy8gRW5zdXJlIGFsbCBmcmFnbWVudHMgYXJlIGdvaW5nIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBjb21taXRcbiAgaWYgKCEoYXdhaXQgZXhlY1N5bmMoXCJnaXRcIiwgW1wiYWRkXCIsIFwiLUFcIl0pKSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiQ291bGQgbm90IGVuc3VyZSBhbGwgZnJhZ21lbnRzIGFyZSBhZGRlZCBmb3IgdGhlIG5leHQgY29tbWl0LlwiXG4gICAgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cblxuICAvLyBIYXZlIHRoaXMgZXhlY3V0ZSB0aGUgcmVsZWFzZS1ub3RlcyBzY3JpcHRcbiAgYXdhaXQgcmVsZWFzZU5vdGVzKHtcbiAgICBmaWxlOiBcIlJFTEVBU0VfTk9URVMubWRcIixcbiAgICB1cGRhdGVQYWNrYWdlOiB0cnVlLFxuICB9KTtcblxuICAvLyBHZXQgdGhlIHZlcnNpb24gcnVubmVyIHNob3VsZCBoYXZlIHVwZGF0ZWQgdG9cbiAgY29uc3QgbmV3VmVyc2lvbiA9IGF3YWl0IHRhcmdldFByb2plY3RWZXJzaW9uKCk7XG5cbiAgLy8gSWYgb3VyIHZlcnNpb24gaGFzIG5vdCBjaGFuZ2VkLCB0aGVuIHRoZXJlIHdlcmUgbm8gY29tbWl0cyB3aXRoIHJlbGVhc2VcbiAgLy8gbm90ZXNcbiAgaWYgKGN1cnJlbnRWZXJzaW9uID09PSBuZXdWZXJzaW9uKSB7XG4gICAgY29uc29sZS53YXJuKGBcbiAgICAgIFRoZSByZWxlYXNlIHNjcmlwdCBkaWQgbm90IGRldGVjdCBhbnkgY2hhbmdlcyBmb3IgYSByZWxlYXNlLiBJZiB5b3UgZmluZFxuICAgICAgdGhpcyB0byBiZSBpbiBlcnJvciBvciB5b3Ugd2FudCB0byBmb3JjZSBhIG5ldyByZWxlYXNlLiBNYWtlIHNvbWUgY29tbWl0c1xuICAgICAgd2l0aCBwcm9wZXIgcmVsZWFzZSBub3RlIGZvcm1hdHRlZCBtZXNzYWdlcyB0byB0cmlnZ2VyIGEgcmVsZWFzZS5cbiAgICBgKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cblxuICBpZiAoYWx0ZXJuYXRlKSB7XG4gICAgaWYgKGdldFJlbGVhc2VUeXBlKCkgIT09IFwicGF0Y2hcIikge1xuICAgICAgY29uc29sZS5lcnJvcihgXG4gICAgICAgIENhbm5vdCBjcmVhdGUgYSByZWxlYXNlIGZvciBhbiBhbHRlcm5hdGUgYnJhbmNoIHRoYXQgaXMgbm90IGEgc2ltcGxlXG4gICAgICAgIHBhdGNoLiBGZWF0dXJlcyBhbmQgYnJlYWtpbmcgY2hhbmdlcyBjYW4gT05MWSBiZSBtYWRlIG9uIHRoZSBtYWluIGJyYW5jaCBvZlxuICAgICAgICBkZXZlbG9wbWVudC5cbiAgICAgIGApO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEdldCB0aGUgdmVyc2lvbiBnZW5lcmF0ZWQgYnkgdGhlIHJ1bm5lciByZWxlYXNlIG5vdGVzIGNvbW1pdFxuICBjb25zdCBsYXN0Q29tbWl0UHJvY2VzcyA9IGF3YWl0IGV4ZWNTeW5jUmVzdWx0KFwiZ2l0XCIsIFtcbiAgICBcImxvZ1wiLFxuICAgIFwiLTFcIixcbiAgICBcIi0tcHJldHR5PSVCXCIsXG4gIF0pO1xuXG4gIGlmIChsYXN0Q29tbWl0UHJvY2VzcyA9PT0gbnVsbCkge1xuICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCByZWFkIHRoZSBsYXN0IGNvbW1pdCB2ZXJzaW9uIGluZm9ybWF0aW9uXCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnN0IHZlcnNpb24gPSAoXG4gICAgbGFzdENvbW1pdFByb2Nlc3MudHJpbSgpLnRvTG93ZXJDYXNlKCkuc3BsaXQoXCJyZWxlYXNlIFwiKVsxXSB8fCBcIlwiXG4gICkudHJpbSgpO1xuXG4gIGlmICghdmVyc2lvbikge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiQ291bGQgbm90IGRldGVybWluZSByZWxlYXNlIHZlcnNpb24gZnJvbSB0aGUgbGFzdCBjb21taXQ6XFxuXFxuXCIsXG4gICAgICBsYXN0Q29tbWl0UHJvY2Vzcy50b1N0cmluZygpLFxuICAgICAgXCJcXG5cXG5cIlxuICAgICk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgLy8gVXBkYXRlIHRoZSByZWxlYXNlIHZlcnNpb24ganNvbiBpbiB0aGUgc291cmNlXG4gIGlmIChmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShcInVpL3JlbGVhc2UuanNvblwiKSkpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGVudHMgPSBmcy5yZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwidWkvcmVsZWFzZS5qc29uXCIpKTtcbiAgICAgIGNvbnRlbnRzLnZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgZnMud3JpdGVKU09OU3luYyhwYXRoLnJlc29sdmUoXCJ1aS9yZWxlYXNlLmpzb25cIiksIGNvbnRlbnRzKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJDb3VsZCBub3QgdXBkYXRlIHRoZSByZWxlYXNlLmpzb24gZmlsZSB3aXRoIGN1cnJlbnQgbGlicmFyeSB2ZXJzaW9uLlwiXG4gICAgICApO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cblxuICAgIC8vIEFkZCB0aGUgY2hhbmdlcyB0byB0aGUgcmVsZWFzZSBqc29uIGZpbGVcbiAgICBpZiAoIShhd2FpdCBleGVjU3luYyhcImdpdFwiLCBbXCJhZGRcIiwgXCItQVwiXSkpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiQ291bGQgbm90IGVuc3VyZSB0aGUgcmVsZWFzZSBqc29uIHdhcyB1cGRhdGVkIGZvciB0aGUgbmV3IHZlcnNpb24uXCJcbiAgICAgICk7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuXG4gICAgLy8gQW1lbmQgdGhlIHJlbGVhc2UgY29tbWl0XG4gICAgaWYgKCEoYXdhaXQgZXhlY1N5bmMoXCJnaXRcIiwgW1wiY29tbWl0XCIsIFwiLS1hbWVuZFwiLCBcIi0tbm8tZWRpdFwiXSkpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiQ291bGQgbm90IGFtZW5kIHRoZSByZWxlYXNlIGNvbW1pdCB0byBpbmNsdWRlIHRoZSByZWxlYXNlIGpzb24gZmlsZS5cIlxuICAgICAgKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG4gIH1cblxuICBpZiAodmVyc2lvbi5pbmNsdWRlcygnXCInKSkge1xuICAgIGNvbnNvbGUud2FybihcbiAgICAgIFwiVGhlIHVwZGF0ZSB2ZXJzaW9uIGdlbmVyYXRlZCBpcyBpbnZhbGlkIGFzIGl0IGNvbnRhaW5zIGludmFsaWQgY2hhcmFjdGVyc1wiLFxuICAgICAgeyB2ZXJzaW9uIH1cbiAgICApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnNvbGUud2FybihcIlVwZGF0aW5nIHZlcnNpb24gdG9cIiwgeyB2ZXJzaW9uIH0pO1xuICByZXR1cm4gdmVyc2lvbjtcbn1cblxuLyoqXG4gKiBUaGlzIGdlbmVyYXRlcyBhIHRhZyBmb3IgdGhlIGdpdmVuIHJlbGVhc2VcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVGFnKHZlcnNpb246IHN0cmluZykge1xuICAvLyBUYWcgdGhlIGNvbW1pdCB3aXRoIHRoZSB2ZXJzaW9uIG51bWJlclxuICBpZiAoXG4gICAgIShhd2FpdCBleGVjU3luYyhgZ2l0YCwgW2B0YWdgLCBcIi1hXCIsIHZlcnNpb24sIFwiLW1cIiwgYFJlbGVhc2UgJHt2ZXJzaW9ufWBdKSlcbiAgKSB7XG4gICAgY29uc29sZS53YXJuKFwiQ291bGQgbm90IG1ha2UgdGFnIGZvciBnaXQgY29tbWl0XCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgcGVyZm9ybXMgYWxsIGFjdGlvbnMgdG8gcHVzaGluZyB0aGUgZ2VuZXJhdGVkIHJlc3VsdHMgdG8gdGhlIHJlbW90ZVxuICogcmVwb3NpdG9yeVxuICovXG5hc3luYyBmdW5jdGlvbiBwdXNoVG9SZW1vdGUoXG4gIHJlbW90ZTogc3RyaW5nLFxuICB2ZXJzaW9uOiBzdHJpbmcsXG4gIGZyb21CcmFuY2g6IHN0cmluZyxcbiAgdG9CcmFuY2g6IHN0cmluZyxcbiAgZm9yY2U6IGJvb2xlYW5cbikge1xuICAvLyBQdXNoIHRoZSBjb21taXQgdG8gcmVtb3RlIHJlbGVhc2UgYnJhbmNoXG4gIGlmIChcbiAgICAhKGF3YWl0IGV4ZWNTeW5jKGBnaXRgLCBbXG4gICAgICBcInB1c2hcIixcbiAgICAgIGZvcmNlID8gXCItZlwiIDogdm9pZCAwLFxuICAgICAgcmVtb3RlLFxuICAgICAgYCR7ZnJvbUJyYW5jaH06JHt0b0JyYW5jaH1gLFxuICAgIF0pKVxuICApIHtcbiAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBwdXNoIHJlbGVhc2UgY29tbWl0IHRvICR7cmVtb3RlfWApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIC8vIFB1c2ggdGhlIHRhZyB0byByZW1vdGVcbiAgaWYgKCEoYXdhaXQgZXhlY1N5bmMoYGdpdGAsIFtcInB1c2hcIiwgcmVtb3RlLCB2ZXJzaW9uXSkpKSB7XG4gICAgY29uc29sZS53YXJuKFwiQ291bGQgbm90IHB1c2ggdGFnIHRvIHRoZSByZW1vdGUgcmVwb3NpdG9yeVwiKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cbn1cblxuLyoqXG4gKiBUaGlzIHdpbGwgZW5zdXJlIGVhY2ggcmVtb3RlIGlzIGFjY2Vzc2libGUgYnkgdGhlIHVzZXIgYW5kIHdpbGwgcHVzaCB0aGVcbiAqIHJlbGVhc2UgYnJhbmNoIHRvIGVhY2ggb2YgdGhlIHNwZWNpZmllZCByZW1vdGVzIGF0IHRoZSBwb3RlbnRpYWwgdGFyZ2V0XG4gKiBicmFuY2g6XG4gKlxuICogcmVtb3RlOmZyb21CcmFuY2g6dG9CcmFuY2g6Zm9yY2VcbiAqXG4gKiBJZiB0aGUgYnJhbmNoIGlzIG5vdCBzcGVjaWZpZWQsIHRoZSBicmFuY2ggc3BlY2lmaWVkIGZvciB0aGlzIHByb2plY3Qgd2lsbFxuICogYmUgdXNlZC5cbiAqXG4gKiBUaGUgXCJmb3JjZVwiIG9wdGlvbiBpcyBsaXRlcmFsLiBVc2UgdGhlIHdvcmQgXCJmb3JjZVwiIHRvIHRyaWdnZXIgYSBmb3JjZSBwdXNoLlxuICovXG5hc3luYyBmdW5jdGlvbiByZWxlYXNlQWRkaXRpb25hbFJlbW90ZXMoYWRkUmVtb3Rlczogc3RyaW5nW10sIHZlcnNpb246IHN0cmluZykge1xuICBpZiAoYWRkUmVtb3RlcyAmJiBhZGRSZW1vdGVzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBzaG91bGRSZWxlYXNlUmVtb3RlcyA9IGF3YWl0IHByb21wdENvbmZpcm0oXG4gICAgICBkZXNjcmlwdGlvbmBcbiAgICAgICAgVGhlIGJ1aWxkIGFuZCByZWxlYXNlIHdhcyBzdWNjZXNzZnVsLCB3b3VsZCB5b3UgbGlrZSB0byByZWxlYXNlIHRvIHRoZVxuICAgICAgICBzcGVjaWZpZWQgYWRkaXRpb25hbCByZW1vdGVzP1xuXG4gICAgICAgICR7Y2hhbGsuY3lhbkJyaWdodEJvbGQoYWRkUmVtb3Rlcy5qb2luKFwiXFxuXCIpKX1cbiAgICAgIGBcbiAgICApO1xuXG4gICAgaWYgKCFzaG91bGRSZWxlYXNlUmVtb3RlcykgcmV0dXJuO1xuICB9XG5cbiAgLy8gRG8gYSBmZXRjaCBhZ2FpbiB0byBlbnN1cmUgd2UgaGF2ZSB0aGUgbGF0ZXN0IGZyb20gdGhlIHJlbW90ZVxuICBpZiAoIShhd2FpdCBleGVjU3luYyhgZ2l0YCwgW1wiZmV0Y2hcIiwgRU5TVVJFX1JFTU9URV0pKSkge1xuICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBmZXRjaCBmcm9tIHJlbW90ZSBzZXJ2ZXJzLlwiKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH1cblxuICBmb3IgKGNvbnN0IHJlbW90ZUluZm8gb2YgYWRkUmVtb3Rlcykge1xuICAgIC8vIFB1c2ggdGhlIHJlbGVhc2UgdG8gdGhlIHNwZWNpZmllZCByZW1vdGVzXG4gICAgY29uc3QgW3JlbW90ZSwgZnJvbUJyYW5jaCwgdG9CcmFuY2gsIGZvcmNlXSA9IHJlbW90ZUluZm8uc3BsaXQoXCI6XCIpO1xuICAgIC8vIE1ha2Ugc3VyZSB0aGUgZGV2IGhhcyBhY2Nlc3MgdG8gdGhlIHNwZWNpZmllZCByZW1vdGVcbiAgICBhd2FpdCBnaXRFbnN1cmVSZW1vdGUocmVtb3RlKTtcbiAgICAvLyBSZXNldCB0aGUgZnJvbUJyYW5jaCB0byBpdCdzIGxhdGVzdCBmcm9tIG9yaWdpblxuICAgIGF3YWl0IGdpdFVwZGF0ZUJyYW5jaChFTlNVUkVfUkVNT1RFLCBmcm9tQnJhbmNoIHx8IFwibWFzdGVyXCIpO1xuICAgIC8vIERlcGxveSB0byB0aGUgY29uZmlndXJlZCBicmFuY2ggb3IgdG8gbWFzdGVyXG4gICAgYXdhaXQgcHVzaFRvUmVtb3RlKFxuICAgICAgcmVtb3RlLFxuICAgICAgdmVyc2lvbixcbiAgICAgIGZyb21CcmFuY2ggfHwgXCJtYXN0ZXJcIixcbiAgICAgIHRvQnJhbmNoIHx8IFwibWFzdGVyXCIsXG4gICAgICBmb3JjZSA9PT0gXCJmb3JjZVwiXG4gICAgKTtcbiAgfVxufVxuXG4vKipcbiAqIFRoaXMgcGVyZm9ybXMgYWxsIG9mIHRoZSBidWlsZCBhY3Rpb25zIHRvIGdlbmVyYXRlIGFsbCBmcmFnbWVudHMgdGhlIHByb2plY3RcbiAqIHdpbGwgZ2VuZXJhdGUgZm9yIGRpc3RyaWJ1dGlvbnMgYW5kIHRoZW4gd2lsbCBwdXNoIHRob3NlIGZyYWdtZW50cyBpbnRvIHRoZVxuICogcmVwby5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gYnVpbGRBbmRQdXNoKGFkZFJlbW90ZXM6IHN0cmluZ1tdKSB7XG4gIC8vIFByb2Nlc3MgYW5kIHNldCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPSBcInByb2R1Y3Rpb25cIjtcblxuICAvLyBNYWtlIHN1cmUgd2UgY2FuIG1ha2UgY2FsbHMgdG8gdGhlIHJlcG9cbiAgYXdhaXQgdmFsaWRhdGVSZXBvc2l0b3J5KCk7XG4gIC8vIE1vdmUgb3VyIGdpdCBjb250ZXh0IHRvIHRoZSByZWxlYXNlIGJyYW5jaFxuICBhd2FpdCBjaGVja291dFJlbGVhc2UoKTtcbiAgLy8gQnVpbGQgdGhlIHByb2plY3QgZnJhZ21lbnRzXG4gIGF3YWl0IHJlbGVhc2VCdWlsZCgpO1xuICAvLyBHZXQgdGhlIG5ldyB2ZXJzaW9uIHRoaXMgcmVsZWFzZSBpcyBnb2luZyB0byBiZWNvbWUuXG4gIGNvbnN0IHZlcnNpb24gPSBhd2FpdCB1cGRhdGVWZXJzaW9uKCk7XG4gIC8vIFRhZyB0aGUgcmVsZWFzZSBjb21taXQgd2l0aCB0aGUgbGF0ZXN0IHZlcnNpb25cbiAgYXdhaXQgdXBkYXRlVGFnKHZlcnNpb24pO1xuICAvLyBQdXNoIGV2ZXJ5dGhpbmcgd2UgaGF2ZSB1cGRhdGVkIHdpdGggZ2l0IHRvIHRoZSByZW1vdGUgcmVwb1xuICBhd2FpdCBwdXNoVG9SZW1vdGUoRU5TVVJFX1JFTU9URSwgdmVyc2lvbiwgXCJyZWxlYXNlXCIsIFwicmVsZWFzZVwiLCB0cnVlKTtcblxuICAvLyBBc2sgdG8gcnVuIHRoZSBwciByZWxlYXNlIHNjcmlwdFxuICBjb25zdCBzaG91bGRQciA9IGF3YWl0IHByb21wdENvbmZpcm0oXCJXb3VsZCB5b3UgbGlrZSB0byBydW4gcHIgcmVsZWFzZT9cIik7XG5cbiAgaWYgKHNob3VsZFByKSB7XG4gICAgLy8gQXR0ZW1wdCB0byBydW4gcHIgcmVsZWFzZS4gV2UgZG9uJ3QgY2FyZSBpZiBpdCB3b3JrcyBvciBub3QgYXMgdGhpcyBpcyBhblxuICAgIC8vIG9wdGlvbmFsIGJyYW5jaCB0YWtlbiBieSB0aGUgdXNlciBhbnl3aG8uXG4gICAgYXdhaXQgZXhlY1NjcmlwdChcInByXCIsIFtcInJlbGVhc2VcIl0pO1xuICB9XG5cbiAgLy8gQXNrIHRvIGRlcGxveSBhZGRpdGlvbmFsIHNwZWNpZmllZCByZW1vdGVzXG4gIGF3YWl0IHJlbGVhc2VBZGRpdGlvbmFsUmVtb3RlcyhhZGRSZW1vdGVzLCB2ZXJzaW9uKTtcbiAgLy8gTm93IHdlIGFzayB0byByZXR1cm4gdG8gb3JpZ2luYWwgYnJhbmNoXG4gIGF3YWl0IGdpdFJldHVyblRvRGV2KHRydWUpO1xufVxuXG4vKipcbiAqIEVudHJ5IG1ldGhvZCBmb3IgdGhlIHJlbGVhc2UgcHJvY2Vzc1xuICovXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBydW4oYWRkUmVtb3Rlczogc3RyaW5nW10pIHtcbiAgY29uc29sZS53YXJuKFwiRXhlY3V0aW5nIHJlbGVhc2Ugc2NyaXB0XCIpO1xuICBidWlsZEFuZFB1c2goYWRkUmVtb3Rlcyk7XG59XG4iLAogICJpbXBvcnQgeyByZWxlYXNlTGlicmFyeVR5cGVzIH0gZnJvbSBcIi4uLy4uL2xpYi9idWlsZC9saWJyYXJ5L3ZpdGUvcmVsZWFzZS1saWJyYXJ5LXR5cGVzLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIHJ1bigpIHtcbiAgYXdhaXQgcmVsZWFzZUxpYnJhcnlUeXBlcygpO1xufVxuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IElnbm9yZSBmcm9tIFwiaWdub3JlXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiLi4vbGliL2V4ZWMvZXhlYy1zeW5jLmpzXCI7XG5pbXBvcnQgeyB3YWl0IH0gZnJvbSBcIi4uL2xpYi91dGlsL3dhaXQuanNcIjtcblxuY29uc3QgZ2l0SWdub3JlUGF0aCA9IHBhdGgucmVzb2x2ZShcIi5naXRpZ25vcmVcIik7XG5sZXQgaWdub3JlID0gSWdub3JlLmRlZmF1bHQoKTtcblxuaWYgKGZzLmV4aXN0c1N5bmMoZ2l0SWdub3JlUGF0aCkpIHtcbiAgaWdub3JlID0gaWdub3JlLmFkZChmcy5yZWFkRmlsZVN5bmMoZ2l0SWdub3JlUGF0aCkudG9TdHJpbmcoKSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdHlwZXNjcmlwdCB0eXBlIGNvbXBpbGF0aW9uIHdpdGhvdXQgZW1pdHRpbmcgYW55dGhpbmcuIFRoaXMgY2FuIGJlXG4gKiB1c2VkIHRvIGZpbmQgZXJyb3JzIGluIHRoZSBwcm9qZWN0IGJlZm9yZSBhIHJlbGVhc2UgaXMgYXR0ZW1wdGVkLiBPciB5b3UgY2FuXG4gKiBydW4gdGhpcyBhcyBub2RlbW9uIHByb2Nlc3MgdG8gZmluZCBlcnJvcnMgYXMgZGV2ZWxvcG1lbnQgaGFwcGVucy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gcnVuVHlwZXNjcmlwdChtb2RlOiBzdHJpbmcpIHtcbiAgLy8gQnVpbGQgZGVjbGFyYXRpb24gZmlsZXMgZm9yIHRoZSBsaWJyYXJ5IG9ubHlcbiAgY29uc3QgdHNDb25maWcgPSBmcy5yZWFkSlNPTlN5bmMocGF0aC5yZXNvbHZlKFwidHNjb25maWcuanNvblwiKSk7XG4gIHRzQ29uZmlnLmV4Y2x1ZGUgPSB0c0NvbmZpZy5leGNsdWRlIHx8IFtdO1xuICB0c0NvbmZpZy5pbmNsdWRlID0gKHRzQ29uZmlnPy5pbmNsdWRlIHx8IFtdKS5maWx0ZXIoXG4gICAgKHA6IHN0cmluZykgPT4gIWlnbm9yZS5pZ25vcmVzKHBhdGgucmVsYXRpdmUoXCIuL1wiLCBwKSlcbiAgKTtcbiAgLy8gdHNDb25maWcuZXhjbHVkZS5wdXNoKFwibGliL3NlcnZlclwiKTtcbiAgZnMud3JpdGVKU09OU3luYyhwYXRoLnJlc29sdmUoXCJ0c2NvbmZpZy50ZW1wLmpzb25cIiksIHRzQ29uZmlnKTtcbiAgLy8gRW5zdXJlIHRoZSBmaWxlIHN5c3RlbSBoYXMgZmx1c2hlZCB0aGUgdGVtcCBmaWxlIHRvIGRpc2tcbiAgYXdhaXQgd2FpdCg1MDApO1xuXG4gIC8vIE1ha2UgYSBjbGVhbiB1cCByb3V0aW5lIGZvciB3YXRjaCBtb2RlXG4gIGlmIChtb2RlID09PSBcIndhdGNoXCIpIHtcbiAgICBjb25zdCBoYW5kbGVFeGl0ID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc29sZS53YXJuKFwiRXhpdCBUUyBwcm9jZXNzXCIpO1xuXG4gICAgICB0cnkge1xuICAgICAgICBmcy5yZW1vdmVTeW5jKHBhdGgucmVzb2x2ZShcInRzY29uZmlnLnRlbXAuanNvblwiKSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgLy8gTk9PUFxuICAgICAgfVxuXG4gICAgICBwcm9jZXNzLmV4aXQoMCk7XG4gICAgfTtcblxuICAgIC8vIENhdGNoIHdoZW4gYXBwIGlzIGNsb3NpbmdcbiAgICBwcm9jZXNzLm9uKFwiZXhpdFwiLCBoYW5kbGVFeGl0KTtcbiAgICAvLyBDYXRjaCBjdHJsK2MgZXZlbnRcbiAgICBwcm9jZXNzLm9uKFwiU0lHSU5UXCIsIGhhbmRsZUV4aXQpO1xuICAgIC8vIENhdGNoIFwia2lsbCBwaWRcIiAoZm9yIGV4YW1wbGU6IG5vZGVtb24gcmVzdGFydClcbiAgICBwcm9jZXNzLm9uKFwiU0lHVVNSMVwiLCBoYW5kbGVFeGl0KTtcbiAgICBwcm9jZXNzLm9uKFwiU0lHVVNSMlwiLCBoYW5kbGVFeGl0KTtcbiAgICBwcm9jZXNzLm9uKFwiU0lHVEVSTVwiLCBoYW5kbGVFeGl0KTtcbiAgICAvLyBDYXRjaCB1bmNhdWdodCBleGNlcHRpb25zXG4gICAgcHJvY2Vzcy5vbihcInVuY2F1Z2h0RXhjZXB0aW9uXCIsIGhhbmRsZUV4aXQpO1xuICB9XG4gIGlmIChcbiAgICAhZXhlY1N5bmMoXCJ0c2NcIiwgW1xuICAgICAgXCItZFwiLFxuICAgICAgbW9kZSA9PT0gXCJ3YXRjaFwiID8gXCItLXdhdGNoXCIgOiBcIlwiLFxuICAgICAgXCItLWluY3JlbWVudGFsXCIsXG4gICAgICBcIi0tbm9lbWl0XCIsXG4gICAgICBcIi0tcHJldHR5XCIsXG4gICAgICBcIi0tdHNCdWlsZEluZm9GaWxlXCIsXG4gICAgICBwYXRoLnJlc29sdmUoXCJub2RlX21vZHVsZXMvLmNhY2hlL3RzYy90c2MudHNidWlsZGluZm9cIiksXG4gICAgICBcIi0tb3V0RGlyXCIsXG4gICAgICBwYXRoLnJlc29sdmUoXCJkaXN0XCIpLFxuICAgICAgXCItLXByb2plY3RcIixcbiAgICAgIHBhdGgucmVzb2x2ZShcInRzY29uZmlnLnRlbXAuanNvblwiKSxcbiAgICBdKVxuICApIHtcbiAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gY29tcGlsZSB0eXBlIGRlY2xhcmF0aW9uc1wiKTtcbiAgICBmcy5yZW1vdmVTeW5jKHBhdGgucmVzb2x2ZShcInRzY29uZmlnLnRlbXAuanNvblwiKSk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgY29uc3QgZXNsaW50VGFyZ2V0cyA9ICh0c0NvbmZpZz8uaW5jbHVkZSB8fCBbXSlcbiAgICAuZmlsdGVyKChwOiBzdHJpbmcpID0+ICFpZ25vcmUuaWdub3JlcyhwYXRoLnJlbGF0aXZlKFwiLi9cIiwgcCkpKVxuICAgIC5tYXAoKHA6IHN0cmluZykgPT4gcGF0aC5yZXNvbHZlKHApKVxuICAgIC5maWx0ZXIoKHA6IHN0cmluZykgPT4gZnMuZXhpc3RzU3luYyhwKSAmJiAhcC5pbmNsdWRlcyhcIm5vZGVfbW9kdWxlc1wiKSk7XG5cbiAgaWYgKGVzbGludFRhcmdldHMubGVuZ3RoID4gMCkge1xuICAgIGlmIChcbiAgICAgICFleGVjU3luYyhcbiAgICAgICAgLy8gYGVzbGludCAke2VzbGludFRhcmdldHMuam9pbihcIiBcIil9IC1jICR7cGF0aC5yZXNvbHZlKFxuICAgICAgICAvLyAgIFwiLmVzbGludHJjXCJcbiAgICAgICAgLy8gKX0gLS1leHQgLnRzIC0tZXh0IC50c3hgXG4gICAgICAgIFwiZXNsaW50XCIsXG4gICAgICAgIFtcbiAgICAgICAgICAuLi5lc2xpbnRUYXJnZXRzLFxuICAgICAgICAgIFwiLWNcIixcbiAgICAgICAgICBwYXRoLnJlc29sdmUoXCIuZXNsaW50cmNcIiksXG4gICAgICAgICAgXCItLWV4dFwiLFxuICAgICAgICAgIFwiLnRzXCIsXG4gICAgICAgICAgXCItLWV4dFwiLFxuICAgICAgICAgIFwiLnRzeFwiLFxuICAgICAgICBdXG4gICAgICApXG4gICAgKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgZXNsaW50IGNoZWNrcy5cIik7XG4gICAgICBmcy5yZW1vdmVTeW5jKHBhdGgucmVzb2x2ZShcInRzY29uZmlnLnRlbXAuanNvblwiKSk7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuICB9XG5cbiAgZnMucmVtb3ZlU3luYyhwYXRoLnJlc29sdmUoXCJ0c2NvbmZpZy50ZW1wLmpzb25cIikpO1xufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBydW4obW9kZTogc3RyaW5nKSB7XG4gIGF3YWl0IHJ1blR5cGVzY3JpcHQobW9kZSk7XG59XG4iLAogICJpbXBvcnQgcnVuQXBwU2VydmVyIGZyb20gXCIuLi8uLi9saWIvYnVpbGQvd2ViLWFwcC92aXRlL3J1bi1hcHAtc2VydmVyLmpzXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuLi8uLi9saWIvdXRpbC9jaGFsay5qc1wiO1xuXG4vKipcbiAqIFRoaXMgc2ltcGx5IGZpcmVzIHVwIHRoZSBhcHAgc2VydmVyIHRvIHJ1bi5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKCkge1xuICBjb25zb2xlLndhcm4oY2hhbGsueWVsbG93QnJpZ2h0Qm9sZChcIlN0YXJ0aW5nIHNlcnZlci4uLlwiKSk7XG4gIGF3YWl0IHJ1bkFwcFNlcnZlcigpO1xufVxuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSBcIi4uL2xpYi9leGVjL2V4ZWMtc3luYy5qc1wiO1xuXG4vKipcbiAqIFN0YXJ0cyBhIHNlcnZlciB3aXRoIGEgZ2l2ZW4gZW50cnkgcG9pbnQuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0U2VydmVyKHBhdGhUb1NlcnZlcjogc3RyaW5nKSB7XG4gIGlmICghZnMuZXhpc3RzU3luYyhwYXRoVG9TZXJ2ZXIpKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgXCJBdHRlbXB0ZWQgdG8gc3RhcnQgYSBzZXJ2ZXIgYnV0IG5vIHNlcnZlciBkaXN0cmlidXRpb24gd2FzIGZvdW5kIGF0XCIsXG4gICAgICBwYXRoVG9TZXJ2ZXJcbiAgICApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGF3YWl0IGV4ZWNTeW5jKGBidW5gLCBbYCR7cGF0aFRvU2VydmVyfWBdKTtcbiAgcmV0dXJuIHRydWU7XG59XG5cbi8qKlxuICogU3RhcnRzIHRoZSBEZXZvcHMgQVBJIGhvc3RpbmcgaWYgYSBEZXZvcHMgYXBwIGRpc3RyaWJ1dGlvbiBpcyBhdmFpbGFibGVcbiAqL1xuYXN5bmMgZnVuY3Rpb24gc3RhcnREZXZvcHNBUEkoKSB7XG4gIGNvbnN0IHBhdGhUb1NlcnZlciA9IHBhdGgucmVzb2x2ZShcImRvY3MvaW5kZXguanNcIik7XG4gIHJldHVybiBhd2FpdCBzdGFydFNlcnZlcihwYXRoVG9TZXJ2ZXIpO1xufVxuXG4vKipcbiAqIFN0YXJ0cyB0aGUgd2ViIGFwcCBpZiBhIHdlYiBhcHAgc2VydmVyIGlzIGF2YWlsYWJsZVxuICovXG5hc3luYyBmdW5jdGlvbiBzdGFydFdlYkFwcCgpIHtcbiAgLy8gVGVsbCB0aGUgcHJvY2VzcyB3aGVyZSB0byBmaW5kIGl0J3MgcmVzb3VyY2VzIHRoYXQgd2VyZSBzcGVjaWZpZWQgaW4gY2xpZW50XG4gIHByb2Nlc3MuZW52LlJFU09VUkNFX1BBVEggPSBwYXRoLnJlc29sdmUoXCJkaXN0L2FwcC9jbGllbnRcIik7XG4gIC8vIEdldCB0aGUgcGF0aCB0byBvdXIgc2VydmVyIGJ1bmRsZVxuICBjb25zdCBwYXRoVG9TZXJ2ZXIgPSBwYXRoLnJlc29sdmUoXCJkaXN0L2FwcC9zZXJ2ZXIvaW5kZXguanNcIik7XG4gIC8vIFN0YXJ0IHRoZSBzZXJ2ZXIgZGlzdHJpYnV0aW9uXG4gIHJldHVybiBhd2FpdCBzdGFydFNlcnZlcihwYXRoVG9TZXJ2ZXIpO1xufVxuXG4vKipcbiAqIEVudHJ5IG1ldGhvZCBmb3IgdGhlIHN0YXJ0IGNvbW1hbmRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKHRhcmdldDogc3RyaW5nLCBfb3B0aW9uczogYW55KSB7XG4gIC8vIERlZmF1bHQgb3VyIHBvcnQgdG8gYSBwcm9wZXIgSFRUUCBwb3J0IHByb3RvY29sXG4gIGNvbnN0IHsgUE9SVCA9IFwiODBcIiB9ID0gcHJvY2Vzcy5lbnY7XG4gIHByb2Nlc3MuZW52LlBPUlQgPSBQT1JUO1xuXG4gIGxldCBzZXJ2ZXJSdW5uaW5nID0gZmFsc2U7XG5cbiAgc3dpdGNoICh0YXJnZXQpIHtcbiAgICBjYXNlIFwiYXBwXCI6XG4gICAgICBzZXJ2ZXJSdW5uaW5nID0gYXdhaXQgc3RhcnRXZWJBcHAoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBcImRldm9wc1wiOlxuICAgICAgc2VydmVyUnVubmluZyA9IGF3YWl0IHN0YXJ0RGV2b3BzQVBJKCk7XG4gICAgICBicmVhaztcblxuICAgIC8vIERvIG5vdGhpbmcgaWYgYSBwcm9wZXIgdGFyZ2V0IHdhcyBub3QgcGlja2VkXG4gICAgZGVmYXVsdDpcbiAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiSW52YWxpZCB0YXJnZXQgZm9yIHN0YXJ0IHNjcmlwdCBzcGVjaWZpZWRcIiwgdGFyZ2V0KTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICB9XG5cbiAgLy8gSWYgd2UgaGF2bid0IGJlZW4gYWJsZSB0byBwaWNrIGEgc2VydmVyIGJhc2VkIG9uIHRhcmdldCwgdGhlbiB3ZSBhdHRlbXB0IHRvIHN0YXJ0IHRoZSBzZXJ2ZXIgdmlhIGRlZmF1bHQgYmVoYXZpb3JcbiAgaWYgKCFzZXJ2ZXJSdW5uaW5nKSB7XG4gICAgc2VydmVyUnVubmluZyA9IGF3YWl0IHN0YXJ0V2ViQXBwKCk7XG4gICAgaWYgKHNlcnZlclJ1bm5pbmcpIHJldHVybjtcbiAgICBzZXJ2ZXJSdW5uaW5nID0gYXdhaXQgc3RhcnREZXZvcHNBUEkoKTtcbiAgICBpZiAoc2VydmVyUnVubmluZykgcmV0dXJuO1xuICB9XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi4vdXRpbC9jaGFsay5qc1wiO1xuaW1wb3J0IHsgZXhlY1NjcmlwdFggfSBmcm9tIFwiLi4vZXhlYy9leGVjLXNjcmlwdHguanNcIjtcbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSBcIi4uL2V4ZWMvZXhlYy1zeW5jLmpzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW5UZXN0cygpIHtcbiAgY29uc3QgdHNjb25maWdQYXRoID0gcGF0aC5yZXNvbHZlKFwidHNjb25maWcuanNvblwiKTtcblxuICBpZiAoIWZzLmV4aXN0c1N5bmModHNjb25maWdQYXRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlRhcmdldCBwcm9qZWN0IGRvZXMgbm90IGhhdmUgYSBUU0NvbmZpZ1wiKTtcbiAgfVxuXG4gIC8vIFNlZSBpZiB3ZSBhcmUgcnVubmluZyB0aGUgdW5pdCB0ZXN0cyB3aXRoIHRoZSBuZWVkIHRvIGF0dGFjaCBhIGRlYnVnIGNvbnNvbGVcbiAgY29uc3QgZGVidWcgPSBCb29sZWFuKHByb2Nlc3MuZW52LkRFQlVHKTtcbiAgY29uc3QgcGF0dGVybiA9IHByb2Nlc3MuZW52LlBBVFRFUk47XG4gIGNvbnN0IHdhdGNoID0gcHJvY2Vzcy5lbnYuV0FUQ0g7XG4gIGNvbnN0IGxlc3MgPSBwcm9jZXNzLmVudi5MRVNTO1xuICAvLyBSdW4gcHJldHRpZXIgb25jZVxuICBjb25zdCBqZXN0Q29uZmlnID0gcGF0aC5yZXNvbHZlKFwiamVzdC5jb25maWcuanNcIik7XG4gIC8vIFN0b3AgZXhlY1N5bmMgY2F1Z2h0IGVycm9ycy4gV2Ugd2FudCBqZXN0IHRvIGhhbmRsZSB0aG9zZSBsb2dzIGZvciB1c1xuICBleGVjU3luYy5zaWxlbnQgPSB0cnVlO1xuXG4gIHRyeSB7XG4gICAgaWYgKGRlYnVnKSB7XG4gICAgICBleGVjU3luYyhcIm5vZGVcIiwgW1xuICAgICAgICBcIi0taW5zcGVjdC1icmtcIixcbiAgICAgICAgcGF0aC5yZXNvbHZlKFwibm9kZV9tb2R1bGVzLy5iaW4vamVzdFwiKSxcbiAgICAgICAgXCItLXJ1bkluQmFuZFwiLFxuICAgICAgICB3YXRjaCA/IFwiLS13YXRjaEFsbFwiIDogXCJcIixcbiAgICAgICAgXCItLXZlcmJvc2VcIixcbiAgICAgICAgbGVzcyA9PT0gXCJ0cnVlXCIgPyBcImZhbHNlXCIgOiB2b2lkIDAsXG4gICAgICAgIFwiLS1jb2xvcnNcIixcbiAgICAgICAgXCItLWNvbmZpZ1wiLFxuICAgICAgICBqZXN0Q29uZmlnLFxuICAgICAgICBwYXR0ZXJuID8gYC0tdGVzdE5hbWVQYXR0ZXJuICR7cGF0dGVybn1gIDogXCJcIixcbiAgICAgIF0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBleGVjU2NyaXB0WChbXG4gICAgICAgIFwiamVzdFwiLFxuICAgICAgICB3YXRjaCA/IFwiLS13YXRjaEFsbFwiIDogXCJcIixcbiAgICAgICAgXCItLXZlcmJvc2VcIixcbiAgICAgICAgbGVzcyA9PT0gXCJ0cnVlXCIgPyBcImZhbHNlXCIgOiB2b2lkIDAsXG4gICAgICAgIFwiLS1jb2xvcnNcIixcbiAgICAgICAgXCItLWNvbmZpZ1wiLFxuICAgICAgICBqZXN0Q29uZmlnLFxuICAgICAgICBwYXR0ZXJuID8gYC0tdGVzdE5hbWVQYXR0ZXJuPSR7cGF0dGVybn1gIDogXCJcIixcbiAgICAgIF0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgXCJUZXN0cyBmYWlsZWQuIFBsZWFzZSBsb29rIGF0IGxvZ3MgdG8gc2VlIHRoZSBlcnJvcnMgZGlzY292ZXJlZFwiXG4gICAgKTtcbiAgfVxuXG4gIGNvbnNvbGUud2FybihjaGFsay5jeWFuQnJpZ2h0KFwiVGVzdHMgY29tcGxldGVcIikpO1xufVxuIiwKICAiaW1wb3J0IHsgcnVuVGVzdHMgfSBmcm9tIFwiLi4vLi4vbGliL3VuaXQtdGVzdC9ydW4tdGVzdHMuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gcnVuKCkge1xuICBjb25zb2xlLndhcm4oXCJSdW5uaW5nIHVuaXQgdGVzdHMuLi5cIik7XG4gIC8vIEV4ZWN1dGUgdGhlIHRlc3RzXG4gIGF3YWl0IHJ1blRlc3RzKCk7XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHJtcmYgZnJvbSBcInJpbXJhZlwiO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiLi4vLi4vbGliL2V4ZWMvZXhlYy1zeW5jLmpzXCI7XG5cbi8qKlxuICogVGhpcyBzY3JpcHQgY2xlYW5zIG91dCBzdG9yeWJvb2sgY2FjaGluZyB0aGF0IGNhdXNlcyB1cGRhdGVzIHRvIGJlIGhpZGRlblxuICogd2hlbiBlZGl0aW5nIHN0b3J5Ym9vayBjb25maWd1cmF0aW9uLlxuICovXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBydW4oKSB7XG4gIGNvbnN0IGNhY2hlID0gcGF0aC5yZXNvbHZlKFwiLi9ub2RlX21vZHVsZXMvLmNhY2hlL1wiKTtcbiAgY29uc3QgYnVpbGQgPSBwYXRoLnJlc29sdmUoXCIuL2J1aWxkXCIpO1xuXG4gIGlmIChmcy5leGlzdHNTeW5jKGNhY2hlKSkge1xuICAgIHJtcmYuc3luYyhjYWNoZSk7XG4gICAgY29uc29sZS53YXJuKFwiQ2FjaGU6IENsZWFuIGNvbXBsZXRlXCIpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUud2FybihcIkNhY2hlOiBBbHJlYWR5IGNsZWFuXCIpO1xuICB9XG5cbiAgaWYgKGZzLmV4aXN0c1N5bmMoYnVpbGQpKSB7XG4gICAgcm1yZi5zeW5jKGJ1aWxkKTtcbiAgICBjb25zb2xlLndhcm4oXCJCdWlsZDogQ2xlYW4gY29tcGxldGVcIik7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS53YXJuKFwiQnVpbGQ6IEFscmVhZHkgY2xlYW5cIik7XG4gIH1cblxuICBpZiAoYXdhaXQgZXhlY1N5bmMoXCJidW5cIiwgW1wicG1cIiwgXCJjYWNoZVwiLCBcInJtXCJdKSkge1xuICAgIGNvbnNvbGUud2FybihcIkJ1bjogQ2xlYW4gY29tcGxldGVcIik7XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS53YXJuKFwiQnVuOiBBbHJlYWR5IGNsZWFuXCIpO1xuICB9XG59XG4iLAogICJpbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgY3JlYXRlUmVxdWlyZSB9IGZyb20gXCJtb2R1bGVcIjtcblxuLyoqXG4gKiBHZXQgdGhlIHBhdGggdG8gdGhlIG5vZGVfbW9kdWxlcy8uY2FjaGUgZm9sZGVyIGZvciBhIGdpdmVuIHBhY2thZ2UuXG4gKlxuICogQHBhcmFtIHBhY2thZ2VOYW1lIFJlcXVpcmVkIG5hbWUgb2YgdGhlIG5wbSBwYWNrYWdlIHRvIGlkZW50aWZ5XG4gKiBAcGFyYW0gZm9sZGVyIFJlcXVpcmVkIG5hbWUgb2YgdGhlIGZvbGRlciB0byBwbGFjZSBpbnNpZGUgdGhlIG5vZGVfbW9kdWxlcy8uY2FjaGUgZm9sZGVyXG4gKiBAcmV0dXJucyBGdWxsIHBhdGggdG8gdGhlIGNhY2hlIGZvbGRlclxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFja2FnZUNhY2hlUGF0aChcbiAgcGFja2FnZU5hbWU6IHN0cmluZyxcbiAgZm9sZGVyOiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHJlcXVpcmUgPSBjcmVhdGVSZXF1aXJlKGltcG9ydC5tZXRhLnVybCk7XG4gIGNvbnN0IG1vZHVsZVBhdGggPSByZXF1aXJlLnJlc29sdmUocGFja2FnZU5hbWUpO1xuXG4gIC8vIEdldCBwdXBwZXRlZXIncyBub2RlX21vZHVsZSBwYXRoXG4gIGNvbnN0IHBhcnRzID0gbW9kdWxlUGF0aC5zcGxpdChcIm5vZGVfbW9kdWxlc1wiKTtcbiAgY29uc3QgbW9kdWxlUm9vdCA9IHBhcnRzWzBdO1xuICBjb25zdCBtb2R1bGVEaXIgPSBwYXJ0c1sxXS5zcGxpdChwYXRoLnNlcClbMV07XG5cbiAgLy8gQ3JlYXRlIGEgcGF0aCB0byB0aGUgZGVzaXJlZCBjYWNoZSBsb2NhdGlvblxuICBjb25zdCBtb2R1bGVDYWNoZVBhdGggPSBwYXRoLmpvaW4oXG4gICAgbW9kdWxlUm9vdCxcbiAgICBcIm5vZGVfbW9kdWxlc1wiLFxuICAgIG1vZHVsZURpcixcbiAgICBcIm5vZGVfbW9kdWxlc1wiLFxuICAgIFwiLmNhY2hlXCIsXG4gICAgZm9sZGVyXG4gICk7XG5cbiAgcmV0dXJuIG1vZHVsZUNhY2hlUGF0aDtcbn1cbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgdXJsIGZyb20gXCJ1cmxcIjtcbmltcG9ydCB7IGdldFBhY2thZ2VDYWNoZVBhdGggfSBmcm9tIFwiLi4vLi4vbGliL3V0aWwvcGFja2FnZS1jYWNoZS1wYXRoLmpzXCI7XG5pbXBvcnQgeyBnaXRIYXNDaGFuZ2VzIH0gZnJvbSBcIi4uLy4uL2xpYi9naXQvZ2l0LWhhcy1jaGFuZ2VzLmpzXCI7XG5cbmNvbnN0IF9fZGlybmFtZSA9IHVybC5maWxlVVJMVG9QYXRoKG5ldyBVUkwoXCIuXCIsIGltcG9ydC5tZXRhLnVybCkpO1xuXG4vKipcbiAqIFRvIG9wZW4gdXAgZ2l0bGFiIG1lcmdlIHJlcXVlc3QsIHdlIG5lZWQgdG8gZmV0Y2ggdGhlIHByb2plY3QgSUQuIFRoZSBwcm9qZWN0XG4gKiBJRCBpcyBhdmFpbGFibGUgb24gdGhlIGJvZHkgb2YgdGhlIHBhZ2UgbG9hZGVkIGZvciB0aGUgcmVwby5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gb3BlbkdpdGxhYlBSKFxuICByZXBvVXJsOiBzdHJpbmcsXG4gIHJlbGVhc2VWZXJzaW9uOiBzdHJpbmcsXG4gIG1hc3RlckJyYW5jaDogc3RyaW5nXG4pIHtcbiAgY29uc3QgcHVwcGV0ZWVyID0gYXdhaXQgaW1wb3J0KFwicHVwcGV0ZWVyXCIpO1xuICBjb25zdCBjYWNoZVBhdGggPSBhd2FpdCBnZXRQYWNrYWdlQ2FjaGVQYXRoKFwicHVwcGV0ZWVyXCIsIFwicHItcmVsZWFzZVwiKTtcbiAgY29uc3QgYnJvd3NlciA9IGF3YWl0IHB1cHBldGVlci5sYXVuY2goe1xuICAgIC8vIElmIHNob3dMb2dJbiwgdGhlbiB3ZSBtdXN0IHByZXNlbnQgdGhlIGJyb3dzZXIgc28gdGhlIHVzZXIgY2FuIGVudGVyXG4gICAgLy8gdGhlaXIgY3JlZGVudGlhbHMuXG4gICAgaGVhZGxlc3M6IGZhbHNlLFxuICAgIHVzZXJEYXRhRGlyOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBjYWNoZVBhdGgpLFxuICAgIGRlZmF1bHRWaWV3cG9ydDogbnVsbCxcbiAgfSk7XG5cbiAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuICBjb25zb2xlLndhcm4oXCJPcGVuaW5nIHByb2plY3QgdXJsLi4uXCIpO1xuICBhd2FpdCBwYWdlLmdvdG8ocmVwb1VybCk7XG5cbiAgLy8gVGhlIHByb2plY3QgSUQgaXMgbG9jYXRlZCBvbiB0aGUgYm9keSB3aXRoaW4gYXR0cmlidXRlXG4gIC8vIGRhdGEtcHJvamVjdC1pZD1cIjcyMlwiXG4gIGNvbnN0IHByb2plY3RJZCA9IGF3YWl0IHBhZ2UuZXZhbHVhdGUoKCkgPT5cbiAgICBkb2N1bWVudC5ib2R5LmdldEF0dHJpYnV0ZShcImRhdGEtcHJvamVjdC1pZFwiKVxuICApO1xuXG4gIGlmICghcHJvamVjdElkKSB7XG4gICAgY29uc29sZS53YXJuKFwiTm8gcHJvamVjdCBpZCBmb3VuZCwgVXNlciBsb2dpbiByZXF1aXJlZC4uLlwiKTtcbiAgICBsZXQgc2hvdWxkRXhpdCA9IHRydWU7XG5cbiAgICBicm93c2VyLm9uKFwiZGlzY29ubmVjdGVkXCIsICgpID0+IHtcbiAgICAgIGlmICghc2hvdWxkRXhpdCkgcmV0dXJuO1xuICAgICAgY29uc29sZS53YXJuKFwiQnJvd3NlciB3YXMgY2xvc2VkIG9yIGNyYXNoZWQuIFRyeSB0aGUgY29tbWFuZCBhZ2Fpbi5cIik7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfSk7XG5cbiAgICBhd2FpdCBwYWdlLmdvdG8ocmVwb1VybCk7XG4gICAgYXdhaXQgcGFnZS53YWl0Rm9yRnVuY3Rpb24oXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2plY3RJZCA9IGRvY3VtZW50Py5ib2R5Py5nZXRBdHRyaWJ1dGUoXCJkYXRhLXByb2plY3QtaWRcIik7XG4gICAgICAgIHJldHVybiBwcm9qZWN0SWQgIT09IG51bGwgJiYgcHJvamVjdElkICE9PSB2b2lkIDA7XG4gICAgICB9LFxuICAgICAgeyB0aW1lb3V0OiAwIH1cbiAgICApO1xuXG4gICAgYXdhaXQgcGFnZS5jbG9zZSgpO1xuICAgIHNob3VsZEV4aXQgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICBhd2FpdCBwYWdlLmNsb3NlKCk7XG4gIH1cblxuICBjb25zb2xlLndhcm4oXCJQcm9qZWN0IElEIGZvdW5kOlwiLCBwcm9qZWN0SWQsIFwiXFxuT3BlbmluZyBtZXJnZSByZXF1ZXN0Li4uXCIpO1xuXG4gIGNvbnN0IG1ha2VQUiA9IGFzeW5jIChcbiAgICBzb3VyY2U6IHN0cmluZyxcbiAgICB0YXJnZXQ6IHN0cmluZyxcbiAgICBpbmNsdWRlVXRmPzogYm9vbGVhblxuICApID0+IHtcbiAgICBjb25zdCBwYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XG5cbiAgICAvLyBVc2UgdGhlIHByb3BlciBVUkwgc3RydWN0dXJlIHRvIGdlbmVyYXRlIHRoZSBwYWdlIHdpdGggdGhlIGNvcnJlY3QgbWVyZ2UgcmVxdWVzdFxuICAgIGF3YWl0IHBhZ2UuZ290byhcbiAgICAgIGAke3JlcG9Vcmx9Ly0vbWVyZ2VfcmVxdWVzdHMvbmV3PyR7XG4gICAgICAgIGluY2x1ZGVVdGYgPyBcInV0Zjg9JUUyJTlDJTkzJlwiIDogXCJcIlxuICAgICAgfW1lcmdlX3JlcXVlc3QlNUJzb3VyY2VfcHJvamVjdF9pZCU1RD0ke3Byb2plY3RJZH0mbWVyZ2VfcmVxdWVzdCU1QnNvdXJjZV9icmFuY2glNUQ9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgIHNvdXJjZVxuICAgICAgKX0mbWVyZ2VfcmVxdWVzdCU1QnRhcmdldF9wcm9qZWN0X2lkJTVEPSR7cHJvamVjdElkfSZtZXJnZV9yZXF1ZXN0JTVCdGFyZ2V0X2JyYW5jaCU1RD0ke3RhcmdldH1gXG4gICAgKTtcblxuICAgIC8vIFdhaXQgZm9yIHRoZSBlbGVtZW50cyB0byBiZSBhdmFpbGFibGUgdG8gbWFuaXB1bGF0ZVxuICAgIGF3YWl0IHBhZ2Uud2FpdEZvckZ1bmN0aW9uKFxuICAgICAgKCkgPT4ge1xuICAgICAgICBjb25zdCBub2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtZXJnZV9yZXF1ZXN0X3RpdGxlXCIpO1xuICAgICAgICByZXR1cm4gbm9kZSAhPT0gbnVsbCAmJiBub2RlICE9PSB2b2lkIDA7XG4gICAgICB9LFxuICAgICAgeyB0aW1lb3V0OiAwIH1cbiAgICApO1xuXG4gICAgLy8gUG9wdWxhdGUgdGhlIGVsZW1lbnRzIHdpdGggZXhwZWN0ZWQgY29uZmlndXJhdGlvblxuICAgIGF3YWl0IHBhZ2UuZXZhbHVhdGUoKHJlbGVhc2VWZXJzaW9uKSA9PiB7XG4gICAgICAvLyBQb3B1bGF0ZSB0aGUgdGl0bGVcbiAgICAgIGxldCBub2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MSW5wdXRFbGVtZW50PihcbiAgICAgICAgXCIjbWVyZ2VfcmVxdWVzdF90aXRsZVwiXG4gICAgICApO1xuICAgICAgaWYgKG5vZGUpIG5vZGUudmFsdWUgPSBgUmVsZWFzZSAke3JlbGVhc2VWZXJzaW9ufWA7XG5cbiAgICAgIC8vIFBvcHVsYXRlIGRlc2NyaXB0aW9uXG4gICAgICBub2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MSW5wdXRFbGVtZW50PihcbiAgICAgICAgXCIjbWVyZ2VfcmVxdWVzdF9kZXNjcmlwdGlvblwiXG4gICAgICApO1xuICAgICAgaWYgKG5vZGUpIG5vZGUudmFsdWUgPSBgUmVsZWFzZSAke3JlbGVhc2VWZXJzaW9ufWA7XG5cbiAgICAgIC8vIFVuY2hlY2sgZGVsZXRlIGJyYW5jaFxuICAgICAgbm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTElucHV0RWxlbWVudD4oXG4gICAgICAgIFwiI21lcmdlX3JlcXVlc3RfZm9yY2VfcmVtb3ZlX3NvdXJjZV9icmFuY2hcIlxuICAgICAgKTtcbiAgICAgIGlmIChub2RlKSB7XG4gICAgICAgIG5vZGUuY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICBub2RlLnZhbHVlID0gXCIwXCI7XG4gICAgICB9XG4gICAgfSwgcmVsZWFzZVZlcnNpb24pO1xuXG4gICAgLy8gV2FpdCBmb3IgdGhlIHBhZ2UgdG8gY2xvc2VcbiAgICBhd2FpdCBuZXcgUHJvbWlzZSgocikgPT4ge1xuICAgICAgcGFnZS5vbihcImNsb3NlXCIsICgpID0+IHtcbiAgICAgICAgcih2b2lkIDApO1xuICAgICAgICBjb25zb2xlLndhcm4oXCJHaXRsYWIgdGlja2V0IHByb2Nlc3MgZmluaXNoZWRcXG5cXG5cIik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBXYWl0IGZvciBib3RoIFBScyB0byBjb21lIHRvIGNvbXBsZXRpb25cbiAgY29uc29sZS53YXJuKFwiXFxuXFxuV2FpdGluZyBmb3IgYnJvd3NlciB3aW5kb3dzIHRvIGJlIGNsb3NlZC4uLlxcblxcblwiKTtcbiAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgIG1ha2VQUihcInJlbGVhc2VcIiwgXCJkZXZcIiksXG4gICAgbWFrZVBSKFwicmVsZWFzZVwiLCBtYXN0ZXJCcmFuY2gpLFxuICBdKTtcblxuICAvLyBDbG9zZSBhZnRlciBhbGwgcGFnZXMgY2xvc2VkXG4gIGJyb3dzZXIuY2xvc2UoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gb3BlbkdpdFBSKFxuICByZXBvVXJsOiBzdHJpbmcsXG4gIHJlbGVhc2VWZXJzaW9uOiBzdHJpbmcsXG4gIG1hc3RlckJyYW5jaDogc3RyaW5nLFxuICBzaG93TG9nSW4/OiBib29sZWFuXG4pIHtcbiAgY29uc3QgcHVwcGV0ZWVyID0gYXdhaXQgaW1wb3J0KFwicHVwcGV0ZWVyXCIpO1xuICBjb25zdCBjYWNoZVBhdGggPSBhd2FpdCBnZXRQYWNrYWdlQ2FjaGVQYXRoKFwicHVwcGV0ZWVyXCIsIFwicHItcmVsZWFzZVwiKTtcbiAgbGV0IGJyb3dzZXIgPSBhd2FpdCBwdXBwZXRlZXIubGF1bmNoKHtcbiAgICAvLyBJZiBzaG93TG9nSW4sIHRoZW4gd2UgbXVzdCBwcmVzZW50IHRoZSBicm93c2VyIHNvIHRoZSB1c2VyIGNhbiBlbnRlclxuICAgIC8vIHRoZWlyIGNyZWRlbnRpYWxzLlxuICAgIGhlYWRsZXNzOiAhc2hvd0xvZ0luLFxuICAgIHVzZXJEYXRhRGlyOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBjYWNoZVBhdGgpLFxuICAgIGRlZmF1bHRWaWV3cG9ydDogbnVsbCxcbiAgfSk7XG5cbiAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuXG4gIGlmIChzaG93TG9nSW4pIHtcbiAgICBjb25zb2xlLndhcm4oXCJVc2VyIGxvZ2luIHJlcXVpcmVkLi4uXCIpO1xuICAgIGxldCBzaG91bGRFeGl0ID0gdHJ1ZTtcblxuICAgIGJyb3dzZXIub24oXCJkaXNjb25uZWN0ZWRcIiwgKCkgPT4ge1xuICAgICAgaWYgKCFzaG91bGRFeGl0KSByZXR1cm47XG4gICAgICBjb25zb2xlLndhcm4oXCJCcm93c2VyIHdhcyBjbG9zZWQgb3IgY3Jhc2hlZC4gVHJ5IHRoZSBjb21tYW5kIGFnYWluLlwiKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGxvZ2luVXJsID0gXCJodHRwczovL2dpdGh1Yi5jb20vbG9naW5cIjtcbiAgICBjb25zb2xlLndhcm4oXCJPcGVuaW5nIGdpdGh1YiBsb2dpbiBwYWdlOiBcIiwgbG9naW5VcmwpO1xuICAgIGF3YWl0IHBhZ2UuZ290byhsb2dpblVybCk7XG4gICAgYXdhaXQgcGFnZS53YWl0Rm9yRnVuY3Rpb24oXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2plY3RJZCA9IGRvY3VtZW50Py5ib2R5XG4gICAgICAgICAgPy5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKVxuICAgICAgICAgID8uc3BsaXQoXCIgXCIpXG4gICAgICAgICAgLmZpbmQoKGMpID0+IGMuc3RhcnRzV2l0aChcImxvZ2dlZC1pblwiKSk7XG4gICAgICAgIHJldHVybiBwcm9qZWN0SWQgIT09IG51bGwgJiYgcHJvamVjdElkICE9PSB2b2lkIDA7XG4gICAgICB9LFxuICAgICAgeyB0aW1lb3V0OiAwIH1cbiAgICApO1xuXG4gICAgc2hvdWxkRXhpdCA9IGZhbHNlO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUud2FybihcIk9wZW5pbmcgcHJvamVjdCB1cmw6IFwiLCByZXBvVXJsKTtcbiAgICBhd2FpdCBwYWdlLmdvdG8ocmVwb1VybCk7XG4gIH1cblxuICAvLyBUaGUgcHJvamVjdCBJRCBpcyBsb2NhdGVkIG9uIHRoZSBib2R5IHdpdGhpbiBhdHRyaWJ1dGVcbiAgLy8gZGF0YS1wcm9qZWN0LWlkPVwiNzIyXCJcbiAgY29uc29sZS53YXJuKFwiQ2hlY2tpbmcgZm9yIGxvZ2dlZC1pbiBhdHRyaWJ1dGUgb24gYm9keS4uLlwiKTtcbiAgY29uc3QgbG9nZ2VkSW4gPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBcImxvZ2dlZC1pbiBjaGVjazpcIixcbiAgICAgIGRvY3VtZW50Py5ib2R5XG4gICAgICAgID8uZ2V0QXR0cmlidXRlKFwiY2xhc3NcIilcbiAgICAgICAgPy5zcGxpdChcIiBcIilcbiAgICAgICAgLmZpbmQoKGMpID0+IGMuc3RhcnRzV2l0aChcImxvZ2dlZC1pblwiKSlcbiAgICApO1xuICAgIHJldHVybiBkb2N1bWVudD8uYm9keVxuICAgICAgPy5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKVxuICAgICAgPy5zcGxpdChcIiBcIilcbiAgICAgIC5maW5kKChjKSA9PiBjLnN0YXJ0c1dpdGgoXCJsb2dnZWQtaW5cIikpO1xuICB9KTtcblxuICBjb25zb2xlLndhcm4oXCJMb2dnaW4gaW4gY2hlY2s6XCIsIGxvZ2dlZEluKTtcblxuICAvLyBJRiB3ZSBhdHRlbXB0ZWQgYSBsb2dpbiBBTkQgdGhlcmUgaXMgbm8gcHJvamVjdCBJRCBhdmFpbGFibGUsIHRoZW4gd2UgYXJlXG4gIC8vIHVuYWJsZSB0byBkZXRlcm1pbmUgdGhlIHByb2plY3QgSUQuXG4gIGlmICghbG9nZ2VkSW4gJiYgc2hvd0xvZ0luKSB7XG4gICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9nIGluIHRoZSB1c2VyIGZvciBnaXRodWIuXCIpO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIC8vIElmIHdlIGNvdWxkIG5vdCBnZXQgYSBwcm9qZWN0IElELCBwcmVzZW50IGEgbm9uLWhlYWRsZXNzIGJyb3dzZXIgdG8gYWxsb3dcbiAgLy8gdGhlIHVzZXIgdG8gbG9naW4uXG4gIGVsc2UgaWYgKCFsb2dnZWRJbikge1xuICAgIGNvbnNvbGUud2FybihcIkxvZ2dlZC1pbiBub3QgZm91bmQgb24gYm9keSwgbG9naW4gbWlnaHQgYmUgbmVlZGVkLi4uXCIpO1xuICAgIGF3YWl0IGJyb3dzZXIuY2xvc2UoKTtcbiAgICBvcGVuR2l0UFIocmVwb1VybCwgcmVsZWFzZVZlcnNpb24sIG1hc3RlckJyYW5jaCwgdHJ1ZSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gTG9nIGluIHZhbGlkYXRlZCwgY2xvc2UgdGhlIGxvZyBpbiBicm93c2VyIGFzIGl0IG1heSBiZSBpbiBoZWFkbGVzcyBtb2RlXG4gIGVsc2Uge1xuICAgIGJyb3dzZXIuY2xvc2UoKTtcbiAgfVxuXG4gIGNvbnN0IHB1cHBldGVlckRhdGEgPSB7XG4gICAgaGVhZGxlc3M6IGZhbHNlLFxuICAgIHVzZXJEYXRhRGlyOiBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBjYWNoZVBhdGgpLFxuICAgIGRlZmF1bHRWaWV3cG9ydDogbnVsbCxcbiAgfTtcblxuICAvLyBSZW9wZW4gdGhlIGJyb3dzZXIgYnV0IGVuc3VyZSB3ZSdyZSBub3QgaGVhZGxlc3MgYW55bW9yZVxuICBicm93c2VyID0gYXdhaXQgcHVwcGV0ZWVyLmxhdW5jaChwdXBwZXRlZXJEYXRhKTtcblxuICBjb25zdCBtYWtlUFIgPSBhc3luYyAoc291cmNlOiBzdHJpbmcsIHRhcmdldDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL0RpbmlkZW4vc2ltcGxlLWRhdGEtcHJvdmlkZXIvY29tcGFyZS9tYXN0ZXIuLi5yZWxlYXNlXG4gICAgLy8gVXNlIHRoZSBwcm9wZXIgVVJMIHN0cnVjdHVyZSB0byBnZW5lcmF0ZSB0aGUgcGFnZSB3aXRoIHRoZSBjb3JyZWN0IG1lcmdlIHJlcXVlc3RcbiAgICBhd2FpdCBwYWdlLmdvdG8oYCR7cmVwb1VybH0vY29tcGFyZS8ke3RhcmdldH0uLi4ke3NvdXJjZX1gKTtcblxuICAgIC8vIFdhaXQgZm9yIHRoZSBlbGVtZW50cyB0byBiZSBhdmFpbGFibGUgdG8gbWFuaXB1bGF0ZVxuICAgIGF3YWl0IHBhZ2Uud2FpdEZvckZ1bmN0aW9uKCgpID0+IHtcbiAgICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxCdXR0b25FbGVtZW50PihcbiAgICAgICAgXCIjcmVwby1jb250ZW50LXBqYXgtY29udGFpbmVyID4gZGl2ID4gZGl2LmpzLWRldGFpbHMtY29udGFpbmVyLkRldGFpbHMuanMtY29tcGFyZS1wciA+IGRpdiA+IGJ1dHRvblwiXG4gICAgICApO1xuICAgICAgbm9kZT8uY2xpY2soKTtcbiAgICAgIHJldHVybiBub2RlICE9PSBudWxsICYmIG5vZGUgIT09IHZvaWQgMDtcbiAgICB9KTtcblxuICAgIC8vIENsaWNrIHRoZSBjcmVhdGUgUFIgYnV0dG9uIHRvIG9wZW4gbmV4dCBkaWFsb2dcbiAgICAvLyBhd2FpdCBwYWdlLmV2YWx1YXRlKGFzeW5jICgpID0+IHtcbiAgICAvLyAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNyZXBvLWNvbnRlbnQtcGpheC1jb250YWluZXIgPiBkaXYgPiBkaXYuanMtZGV0YWlscy1jb250YWluZXIuRGV0YWlscy5qcy1jb21wYXJlLXByID4gZGl2ID4gYnV0dG9uJykuY2xpY2soKTtcbiAgICAvLyB9KTtcblxuICAgIC8vIFBvcHVsYXRlIHRoZSBlbGVtZW50cyB3aXRoIGV4cGVjdGVkIGNvbmZpZ3VyYXRpb25cbiAgICBhd2FpdCBwYWdlLmV2YWx1YXRlKGFzeW5jIChyZWxlYXNlVmVyc2lvbikgPT4ge1xuICAgICAgbGV0IG5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KFxuICAgICAgICBcIiNwdWxsX3JlcXVlc3RfdGl0bGVcIlxuICAgICAgKTtcbiAgICAgIGlmIChub2RlKSBub2RlLnZhbHVlID0gYFJlbGVhc2UgJHtyZWxlYXNlVmVyc2lvbn1gO1xuICAgICAgbm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTElucHV0RWxlbWVudD4oXG4gICAgICAgICdbbmFtZT1cInB1bGxfcmVxdWVzdFtib2R5XVwiXSdcbiAgICAgICk7XG4gICAgICBpZiAobm9kZSkgbm9kZS52YWx1ZSA9IGBSZWxlYXNlICR7cmVsZWFzZVZlcnNpb259YDtcbiAgICB9LCByZWxlYXNlVmVyc2lvbik7XG5cbiAgICAvLyBXYWl0IGZvciB0aGUgcGFnZSB0byBjbG9zZVxuICAgIGF3YWl0IG5ldyBQcm9taXNlKChyKSA9PiB7XG4gICAgICBwYWdlLm9uKFwiY2xvc2VcIiwgKCkgPT4ge1xuICAgICAgICByKHZvaWQgMCk7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkdpdGh1YiB0aWNrZXQgcHJvY2VzcyBmaW5pc2hlZFxcblxcblwiKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIC8vIFdhaXQgZm9yIGJvdGggUFJzIHRvIGNvbWUgdG8gY29tcGxldGlvblxuICBjb25zb2xlLndhcm4oXCJcXG5cXG5XYWl0aW5nIGZvciBicm93c2VyIHdpbmRvd3MgdG8gYmUgY2xvc2VkLi4uXFxuXFxuXCIpO1xuICBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgbWFrZVBSKFwicmVsZWFzZVwiLCBcImRldlwiKSxcbiAgICBtYWtlUFIoXCJyZWxlYXNlXCIsIG1hc3RlckJyYW5jaCksXG4gIF0pO1xuXG4gIC8vIENsb3NlIGFmdGVyIGFsbCBwYWdlcyBjbG9zZWRcbiAgYnJvd3Nlci5jbG9zZSgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBvcGVuQXp1cmVQUihcbiAgcmVwb1VybDogc3RyaW5nLFxuICByZWxlYXNlVmVyc2lvbjogc3RyaW5nLFxuICBtYXN0ZXJCcmFuY2g6IHN0cmluZyxcbiAgc2hvd0xvZ0luPzogYm9vbGVhblxuKSB7XG4gIGNvbnN0IHB1cHBldGVlciA9IGF3YWl0IGltcG9ydChcInB1cHBldGVlclwiKTtcbiAgLy8gRXhhbXBsZSBVUkxcbiAgLy8gaHR0cHM6Ly9kZXYuYXp1cmUuY29tL3JldGlyZW9uZS9fZ2l0L1JldGlyZU9uZSUyMFJJUFAvcHVsbHJlcXVlc3RjcmVhdGU/c291cmNlUmVwb3NpdG9yeUlkPTQwNTA3NGJiLWIxYjEtNGZlYS04MzUyLWJkNGQ3ODg4YjFhZCZ0YXJnZXRSZXBvc2l0b3J5SWQ9NDA1MDc0YmItYjFiMS00ZmVhLTgzNTItYmQ0ZDc4ODhiMWFkJnNvdXJjZVJlZj1yZWxlYXNlJnRhcmdldFJlZj1tYWluXG4gIGNvbnN0IGNhY2hlUGF0aCA9IGF3YWl0IGdldFBhY2thZ2VDYWNoZVBhdGgoXCJwdXBwZXRlZXJcIiwgXCJwci1yZWxlYXNlXCIpO1xuICBsZXQgYnJvd3NlciA9IGF3YWl0IHB1cHBldGVlci5sYXVuY2goe1xuICAgIC8vIElmIHNob3dMb2dJbiwgdGhlbiB3ZSBtdXN0IHByZXNlbnQgdGhlIGJyb3dzZXIgc28gdGhlIHVzZXIgY2FuIGVudGVyXG4gICAgLy8gdGhlaXIgY3JlZGVudGlhbHMuXG4gICAgaGVhZGxlc3M6ICFzaG93TG9nSW4sXG4gICAgdXNlckRhdGFEaXI6IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIGNhY2hlUGF0aCksXG4gICAgZGVmYXVsdFZpZXdwb3J0OiBudWxsLFxuICB9KTtcblxuICBjb25zdCBwYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XG5cbiAgaWYgKHNob3dMb2dJbikge1xuICAgIGNvbnNvbGUud2FybihcIlVzZXIgbG9naW4gcmVxdWlyZWQuLi5cIik7XG4gICAgbGV0IHNob3VsZEV4aXQgPSB0cnVlO1xuXG4gICAgYnJvd3Nlci5vbihcImRpc2Nvbm5lY3RlZFwiLCAoKSA9PiB7XG4gICAgICBpZiAoIXNob3VsZEV4aXQpIHJldHVybjtcbiAgICAgIGNvbnNvbGUud2FybihcIkJyb3dzZXIgd2FzIGNsb3NlZCBvciBjcmFzaGVkLiBUcnkgdGhlIGNvbW1hbmQgYWdhaW4uXCIpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH0pO1xuXG4gICAgY29uc3QgbG9naW5VcmwgPSByZXBvVXJsO1xuICAgIGNvbnNvbGUud2FybihcIk9wZW5pbmcgYXp1cmUgcmVwbyBsb2dpbiBwYWdlOiBcIiwgbG9naW5VcmwpO1xuICAgIGF3YWl0IHBhZ2UuZ290byhsb2dpblVybCk7XG4gICAgYXdhaXQgcGFnZS53YWl0Rm9yRnVuY3Rpb24oXG4gICAgICAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1zSWQgPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UubXNhbWVpZDtcbiAgICAgICAgcmV0dXJuIG1zSWQgIT09IG51bGwgJiYgbXNJZCAhPT0gdm9pZCAwO1xuICAgICAgfSxcbiAgICAgIHsgdGltZW91dDogMCB9XG4gICAgKTtcblxuICAgIHNob3VsZEV4aXQgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLndhcm4oXCJPcGVuaW5nIHByb2plY3QgdXJsOiBcIiwgcmVwb1VybCk7XG4gICAgYXdhaXQgcGFnZS5nb3RvKHJlcG9VcmwpO1xuICB9XG5cbiAgLy8gVGhlIG1zaWQgaXMgbG9jYXRlZCBpbiBzZXNzaW9uU3RvcmFnZSBhdCB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UubXNhbWVpZFxuICBjb25zb2xlLndhcm4oXCJDaGVja2luZyBmb3IgbG9nZ2VkLWluIGF0dHJpYnV0ZSBvbiBib2R5Li4uXCIpO1xuICBjb25zdCBsb2dnZWRJbiA9IGF3YWl0IHBhZ2UuZXZhbHVhdGUoKCkgPT4ge1xuICAgIGNvbnNvbGUud2FybihcImxvZ2dlZC1pbiBjaGVjazpcIiwgd2luZG93LnNlc3Npb25TdG9yYWdlLm1zYW1laWQpO1xuICAgIHJldHVybiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UubXNhbWVpZDtcbiAgfSk7XG5cbiAgY29uc29sZS53YXJuKFwiTG9nZ2luIGluIGNoZWNrOlwiLCBsb2dnZWRJbik7XG5cbiAgLy8gSUYgd2UgYXR0ZW1wdGVkIGEgbG9naW4gQU5EIHRoZXJlIGlzIG5vIG1zIGlkIGF2YWlsYWJsZSwgdGhlbiB3ZSBhcmVcbiAgLy8gdW5hYmxlIHRvIGRldGVybWluZSB0aGUgbXMgaWQuXG4gIGlmICghbG9nZ2VkSW4gJiYgc2hvd0xvZ0luKSB7XG4gICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9nIGluIHRoZSB1c2VyIGZvciBhenVyZS5cIik7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG5cbiAgLy8gSWYgd2UgY291bGQgbm90IGdldCBhIG1zaWQsIHByZXNlbnQgYSBub24taGVhZGxlc3MgYnJvd3NlciB0byBhbGxvd1xuICAvLyB0aGUgdXNlciB0byBsb2dpbi5cbiAgZWxzZSBpZiAoIWxvZ2dlZEluKSB7XG4gICAgY29uc29sZS53YXJuKFwiTVMgaWQgbm90IGZvdW5kLCBsb2dpbiBtaWdodCBiZSBuZWVkZWQuLi5cIik7XG4gICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICAgIG9wZW5HaXRQUihyZXBvVXJsLCByZWxlYXNlVmVyc2lvbiwgbWFzdGVyQnJhbmNoLCB0cnVlKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBMb2cgaW4gdmFsaWRhdGVkLCBjbG9zZSB0aGUgbG9nIGluIGJyb3dzZXIgYXMgaXQgbWF5IGJlIGluIGhlYWRsZXNzIG1vZGVcbiAgZWxzZSB7XG4gICAgYnJvd3Nlci5jbG9zZSgpO1xuICB9XG5cbiAgLy8gUmVvcGVuIHRoZSBicm93c2VyIGJ1dCBlbnN1cmUgd2UncmUgbm90IGhlYWRsZXNzIGFueW1vcmVcbiAgY29uc3QgcHVwcGV0ZWVyRGF0YSA9IHtcbiAgICBoZWFkbGVzczogZmFsc2UsXG4gICAgdXNlckRhdGFEaXI6IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsIGNhY2hlUGF0aCksXG4gICAgZGVmYXVsdFZpZXdwb3J0OiBudWxsLFxuICB9O1xuXG4gIGJyb3dzZXIgPSBhd2FpdCBwdXBwZXRlZXIubGF1bmNoKHB1cHBldGVlckRhdGEpO1xuXG4gIC8vIE1ha2UgYSBjb21tb24gbWV0aG9kIGZvciBsYXVuY2hpbmcgYSBQUlxuICBjb25zdCBtYWtlUFIgPSBhc3luYyAoc291cmNlOiBzdHJpbmcsIHRhcmdldDogc3RyaW5nKSA9PiB7XG4gICAgY29uc3QgcGFnZSA9IGF3YWl0IGJyb3dzZXIubmV3UGFnZSgpO1xuXG4gICAgLy8gVXNlIHRoZSBwcm9wZXIgVVJMIHN0cnVjdHVyZSB0byBnZW5lcmF0ZSB0aGUgcGFnZSB3aXRoIHRoZSBjb3JyZWN0IG1lcmdlIHJlcXVlc3RcbiAgICBhd2FpdCBwYWdlLmdvdG8oYCR7cmVwb1VybH0mc291cmNlUmVmPSR7c291cmNlfSZ0YXJnZXRSZWY9JHt0YXJnZXR9YCk7XG5cbiAgICAvLyBXYWl0IGZvciB0aGUgZWxlbWVudHMgdG8gYmUgYXZhaWxhYmxlIHRvIG1hbmlwdWxhdGVcbiAgICBhd2FpdCBwYWdlLndhaXRGb3JGdW5jdGlvbigoKSA9PiB7XG4gICAgICBjb25zdCBub2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MQnV0dG9uRWxlbWVudD4oXCJidXR0b24ucHJpbWFyeVwiKTtcbiAgICAgIHJldHVybiBub2RlICE9PSBudWxsICYmIG5vZGUgIT09IHZvaWQgMDtcbiAgICB9KTtcblxuICAgIC8vIFBvcHVsYXRlIHRoZSBlbGVtZW50cyB3aXRoIGV4cGVjdGVkIGNvbmZpZ3VyYXRpb25cbiAgICBhd2FpdCBwYWdlLmV2YWx1YXRlKGFzeW5jIChyZWxlYXNlVmVyc2lvbikgPT4ge1xuICAgICAgLy8gR2V0IHRoZSBub2RlIHdpdGggdGFiIGluZGV4IDAgKHRoZSBpZCBvbiB0aGUgcGFnZSBjaGFuZ2VzIGVhY2ggdGltZSlcbiAgICAgIGxldCBub2RlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MSW5wdXRFbGVtZW50PihcbiAgICAgICAgJ1thcmlhLWxhYmVsPVwiRW50ZXIgYSB0aXRsZVwiXSdcbiAgICAgICk7XG4gICAgICBpZiAobm9kZSkgbm9kZS52YWx1ZSA9IGBSZWxlYXNlICR7cmVsZWFzZVZlcnNpb259YDtcblxuICAgICAgLy9cbiAgICAgIG5vZGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yPEhUTUxJbnB1dEVsZW1lbnQ+KFxuICAgICAgICAnW2FyaWEtbGFiZWw9XCJEZXNjcmlwdGlvblwiXSdcbiAgICAgICk7XG4gICAgICBpZiAobm9kZSkgbm9kZS52YWx1ZSA9IGBSZWxlYXNlICR7cmVsZWFzZVZlcnNpb259YDtcbiAgICB9LCByZWxlYXNlVmVyc2lvbik7XG5cbiAgICAvLyBXYWl0IGZvciB0aGUgcGFnZSB0byBjbG9zZVxuICAgIGF3YWl0IG5ldyBQcm9taXNlKChyKSA9PiB7XG4gICAgICBwYWdlLm9uKFwiY2xvc2VcIiwgKCkgPT4ge1xuICAgICAgICByKHZvaWQgMCk7XG4gICAgICAgIGNvbnNvbGUud2FybihcIkF6dXJlIHByb2plY3QgdGlja2V0IHByb2Nlc3MgZmluaXNoZWRcXG5cXG5cIik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBXYWl0IGZvciBib3RoIFBScyB0byBjb21lIHRvIGNvbXBsZXRpb25cbiAgY29uc29sZS53YXJuKFwiXFxuXFxuV2FpdGluZyBmb3IgYnJvd3NlciB3aW5kb3dzIHRvIGJlIGNsb3NlZC4uLlxcblxcblwiKTtcbiAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgIG1ha2VQUihcInJlbGVhc2VcIiwgXCJkZXZcIiksXG4gICAgbWFrZVBSKFwicmVsZWFzZVwiLCBtYXN0ZXJCcmFuY2gpLFxuICBdKTtcblxuICAvLyBDbG9zZSBhZnRlciBhbGwgcGFnZXMgY2xvc2VkXG4gIGJyb3dzZXIuY2xvc2UoKTtcbn1cblxuLyoqXG4gKiBUaGlzIGNvbW1hbmQgaXMgaW50ZW5kZWQgdG8gd29yayB3aXRoIHRoZSBjdXJyZW50IGJyYW5jaCBJRiB0aGUgYnJhbmNoIGhhc1xuICogYmVlbiBjcmVhdGVkIHVzaW5nIHRoZSBcIm5wbSBydW4gdGlja2V0XCIgY29tbWFuZC5cbiAqXG4gKiBUaGlzIHdpbGwgbG9vayBpbnRvIHRoZSBjdXJyZW50IGJyYW5jaCBhbmQgZmluZCB0aGUgY29tbWl0IHRoYXQgY29udGFpbnMgdGhlXG4gKiB0aWNrZXQgYnJhbmNoIG5hbWUgYW5kIHRpY2tldCBVUkwuIFRoaXMgd2lsbCBnZW5lcmF0ZSBhIGNvbW1pdCBhbmQgbWVyZ2VcbiAqIHJlcXVlc3QgdGhhdCBjb250YWlucyB0aGUgdGlja2V0IHRoYXQgaXMgbGlua2VkLlxuICovXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBydW4oXG4gIHJlcG9Vcmw6IHN0cmluZyxcbiAgcmVwb1R5cGU6IHN0cmluZyxcbiAgbWFzdGVyQnJhbmNoID0gXCJtYXN0ZXJcIixcbiAgLi4uX2FyZ3M6IGFueVtdXG4pIHtcbiAgLy8gVmFsaWRhdGUgd2UgaGF2ZSBpbXBsZW1lbnRlZCBhIHN0cmF0ZWd5IGZvciBhIGdpdmVuIHJlcG8gdHlwZS5cbiAgY29uc3QgdmFsaWRSZXBvcyA9IG5ldyBTZXQoW1wiZ2l0bGFiXCIsIFwiZ2l0XCIsIFwiZ2l0aHViXCIsIFwiYXp1cmVcIl0pO1xuXG4gIGlmICghdmFsaWRSZXBvcy5oYXMocmVwb1R5cGUpKSB7XG4gICAgY29uc29sZS5lcnJvcihgVW5zdXBwb3J0ZWQgcmVwbyB0eXBlOiAke3JlcG9UeXBlfWApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIC8vIFdlIGNhbiBvbmx5IGRvIHRoaXMgb3BlcmF0aW9uIGlmIHRoZXJlIGlzIG5vdGhpbmcgdG8gY29tbWl0IG9yIHB1c2hcbiAgLy8gVGhpcyBvbmx5IHdvcmtzIGlmIG5vIGNoYW5nZXMgYXJlIHByZXNlbnRcbiAgaWYgKGF3YWl0IGdpdEhhc0NoYW5nZXMoKSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICBcIllvdSBoYXZlIHVuY29tbWl0dGVkIGNoYW5nZXMgb3IgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHByb2plY3QgY2FuIG5vdCBiZSBkZXRlcm1pbmVkLiBQbGVhc2UgY29tbWl0IG9yIHN0YXNoIHRoZW0gYmVmb3JlIGNvbnRpbnVpbmcuXCJcbiAgICApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIC8vIGNvbnN0IGNoZWNrQnJhbmNoID0gc2hlbGwuZXhlYyhcImdpdCBzeW1ib2xpYy1yZWYgLS1zaG9ydCBIRUFEXCIsIHsgc2lsZW50OiB0cnVlIH0pO1xuICAvLyBpZiAoY2hlY2tCcmFuY2ggIT09IFwicmVsZWFzZVwiKSB7XG4gIC8vICAgY29uc29sZS5lcnJvcihcIllvdSBtdXN0IGJlIG9uIHRoZSByZWxlYXNlIGJyYW5jaCB0byBjcmVhdGUgYSByZWxlYXNlIFBSXCIpO1xuICAvLyAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgLy8gfVxuXG4gIC8vIEdldCB0aGUgY3VycmVudCBwcm9qZWN0IHZlcnNpb24gZnJvbSB0aGUgcGFja2FnZS5qc29uIGZpbGVcbiAgY29uc3QgcGFja2FnZUpzb24gPSBmcy5yZWFkSnNvblN5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKTtcbiAgY29uc3QgdmVyc2lvbiA9IHBhY2thZ2VKc29uLnZlcnNpb247XG5cbiAgLy8gTm93IHdlIG9wZW4gdGhlIHVybCB0byB0aGUgbmV3IG1lcmdlIHJlcXVlc3RcbiAgc3dpdGNoIChyZXBvVHlwZSkge1xuICAgIGNhc2UgXCJnaXRsYWJcIjpcbiAgICAgIGF3YWl0IG9wZW5HaXRsYWJQUihyZXBvVXJsLCB2ZXJzaW9uLCBtYXN0ZXJCcmFuY2gpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIFwiZ2l0XCI6XG4gICAgY2FzZSBcImdpdGh1YlwiOlxuICAgICAgYXdhaXQgb3BlbkdpdFBSKHJlcG9VcmwsIHZlcnNpb24sIG1hc3RlckJyYW5jaCk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgXCJhenVyZVwiOlxuICAgICAgYXdhaXQgb3BlbkF6dXJlUFIocmVwb1VybCwgdmVyc2lvbiwgbWFzdGVyQnJhbmNoKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIGNvbnNvbGUud2FybihcIk5vIHN1cHBvcnRlZCByZXBvIHR5cGUgZm91bmRcIik7XG4gIH1cbn1cbiIsCiAgIiMhL3Vzci9iaW4vZW52IGJ1blxuaW1wb3J0ICogYXMgY29tbWFuZGVyIGZyb20gXCJjb21tYW5kZXJcIjtcbmltcG9ydCBBdXRvQ29tcGxldGVQcm9tcHQgZnJvbSBcImlucXVpcmVyLWF1dG9jb21wbGV0ZS1wcm9tcHRcIjtcbmltcG9ydCBpbnF1aXJlciBmcm9tIFwiaW5xdWlyZXJcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeWFyZ3MgZnJvbSBcInlhcmdzXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuL2xpYi91dGlsL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyBjb25maWdFbnYgfSBmcm9tIFwiLi9saWIvdXRpbC9jb25maWctZW52LmpzXCI7XG5pbXBvcnQgeyBkZXNjcmlwdGlvbiB9IGZyb20gXCIuL2xpYi91dGlsL2Rlc2NyaXB0aW9uLmpzXCI7XG5pbXBvcnQgeyBlbnN1cmVEZXBlbmRlbmNpZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9lbnN1cmUtZGVwZW5kZW5jaWVzLmpzXCI7XG5pbXBvcnQgeyBleGVjSW5zdGFsbCB9IGZyb20gXCIuL2xpYi9leGVjL2V4ZWMtaW5zdGFsbC5qc1wiO1xuXG5pbnF1aXJlci5yZWdpc3RlclByb21wdChcImF1dG9jb21wbGV0ZVwiLCBBdXRvQ29tcGxldGVQcm9tcHQpO1xuXG5jb25zdCB7IENvbW1hbmQgfSA9IGNvbW1hbmRlcjtcbmNvbnN0IHByb2dyYW06IGFueSA9IG5ldyBDb21tYW5kKCk7XG5jb25zdCBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG5cbmZ1bmN0aW9uIGdldE9wdGlvbnMoKSB7XG4gIG9wdGlvbnMuZGVidWcgPSBwcm9ncmFtLmRlYnVnO1xuICBvcHRpb25zLnZlcmJvc2UgPSBwcm9ncmFtLnZlcmJvc2U7XG4gIG9wdGlvbnMucGF0dGVybiA9IHByb2dyYW0ucGF0dGVybjtcblxuICByZXR1cm4gb3B0aW9ucztcbn1cblxucHJvZ3JhbS52ZXJzaW9uKFwiMC4wLjFcIik7XG5wcm9ncmFtLm9wdGlvbihcbiAgXCItdiwgLS12ZXJib3NlXCIsXG4gIFwiT3V0cHV0cyBtb3JlIGRldGFpbGVkIGluZm9ybWF0aW9uIGR1cmluZyBjcmFzaGVzLlwiXG4pO1xucHJvZ3JhbS5vcHRpb24oXG4gIFwiLS1kZWJ1ZyBbcGFyYW1dXCIsXG4gIGRlc2NyaXB0aW9uYFxuICAgIFByb3ZpZGVzIGRlYnVnZ2luZyBjb250ZXh0dWFsIGluZm9ybWF0aW9uIHZhcmlvdXMgY29tbWFuZHMgbWlnaHQgdXNlIHRvXG4gICAgYWlkIGluIGRldmVsb3BpbmcgRGV2b3BzLlxuICBgXG4pO1xuXG5wcm9ncmFtLm9wdGlvbihcbiAgXCItcCwgLS1wYXR0ZXJuIFtwYXJhbV1cIixcbiAgZGVzY3JpcHRpb25gXG4gICAgUHJvdmlkZXMgYSBwYXR0ZXJuIGZvciBjZXJ0YWluIG9wZXJhdGlvbnMgdG8gdXRpbGl6ZS4gVGhpcyBpcyBwcmltYXJpbHlcbiAgICB1c2VkIGJ5IHVuaXQgdGVzdHMgdG8gZmlsdGVyIHRlc3RzIHRvIHNwZWNpZmllZCB0ZXN0cy5cbiAgYFxuKTtcblxuY29uc3QgZGV2ID0gcHJvZ3JhbS5jb21tYW5kKFwiZGV2XCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBUaGVzZSBhcmUgdGhlIGNvbW1hbmRzIGFzc29jaWF0ZWQgd2l0aCBzdGFydGluZyB1cCBkZXZlbG9wZXIgZW52aXJvbm1lbnRzXG4gICAgZm9yIHZhcmlvdXMgcHJvamVjdCB0eXBlcyBvciBwb3J0aW9ucyBvZiBhIHByb2plY3QuXG4gIGBcbik7XG5cbmRldlxuICAuY29tbWFuZChcInZpdGVcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgU3RhcnRzIHVwIGEgZGV2ZWxvcGVyIGVudmlyb25tZW50IHRoYXQgcGVyZm9ybXMgaW5jcmVtZW50YWwgYnVpbGRzIHdoaWxlXG4gICAgICBkZXZlbG9waW5nIHdpdGhpbiB0aGUgbGliIGFuZCBhcHAgZm9sZGVycy4gVXNlcyB2aXRlIGFuZCB2aXRlXG4gICAgICBjb25maWcuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL2Rldi9kZXYtdml0ZS5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJkZXYtdml0ZSBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmRldlxuICAuY29tbWFuZChcInN0b3J5Ym9va1wiKVxuICAub3B0aW9uKFxuICAgIFwiLWksIC0taW5jbHVkZSA8aW5jbHVkZS4uLj5cIixcbiAgICBcIkFkZGl0aW9uYWwgc3Rvcnlib29rIG1vZHVsZXMgdG8gbG9hZCBpbnRvIHN0b3J5Ym9vay4gVGhlc2UgYXJlIHRoZSBuYW1lcyBvZiBwcm9wZXJseSBmb3JtYXR0ZWQgZGVwZW5kZW5jaWVzIGluc3RhbGxlZCBpbnRvIG5vZGVfbW9kdWxlcy5cIlxuICApXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFN0YXJ0cyBhIHN0b3J5Ym9vayBpbnN0YW5jZSBmb3IgZGV2ZWxvcGluZyB0aGUgVUkgY29tcG9uZW50cyBvZiB0aGVcbiAgICAgIHByb2plY3QuIFRoaXMgbWFrZXMgdGhlIFwidWkvc3Rvcmllc1wiIGZvbGRlciBpbiB0aGUgcHJvamVjdCB0aGUgZXhwZWN0ZWRcbiAgICAgIGRldmVsb3BtZW50IHBvaW50LlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICh7IGluY2x1ZGUgfTogeyBpbmNsdWRlOiBzdHJpbmdbXSB9KSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvc3Rvcnlib29rLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoXCJcIiwgaW5jbHVkZSwgcGF0aC5yZXNvbHZlKHByb2Nlc3MuY3dkKCkpLCBnZXRPcHRpb25zKCkpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwic3Rvcnlib29rIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxuY29uc3Qgc3Rvcnlib29rID0gcHJvZ3JhbS5jb21tYW5kKFwic3Rvcnlib29rXCIpO1xuXG5zdG9yeWJvb2tcbiAgLmNvbW1hbmQoXCJydW5cIilcbiAgLm9wdGlvbihcbiAgICBcIi1pLCAtLWluY2x1ZGUgPGluY2x1ZGUuLi4+XCIsXG4gICAgXCJBZGRpdGlvbmFsIHN0b3J5Ym9vayBtb2R1bGVzIHRvIGxvYWQgaW50byBzdG9yeWJvb2suIFRoZXNlIGFyZSB0aGUgbmFtZXMgb2YgcHJvcGVybHkgZm9ybWF0dGVkIGRlcGVuZGVuY2llcyBpbnN0YWxsZWQgaW50byBub2RlX21vZHVsZXMuXCJcbiAgKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBTdGFydHMgYSBzdG9yeWJvb2sgaW5zdGFuY2UgZm9yIGRldmVsb3BpbmcgdGhlIFVJIGNvbXBvbmVudHMgb2YgdGhlXG4gICAgICBwcm9qZWN0LiBUaGlzIG1ha2VzIHRoZSBcInVpL3N0b3JpZXNcIiBmb2xkZXIgaW4gdGhlIHByb2plY3QgdGhlIGV4cGVjdGVkXG4gICAgICBkZXZlbG9wbWVudCBwb2ludC5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoeyBpbmNsdWRlIH06IHsgaW5jbHVkZTogc3RyaW5nW10gfSkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3N0b3J5Ym9vay5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KFwiXCIsIGluY2x1ZGUsIHBhdGgucmVzb2x2ZShwcm9jZXNzLmN3ZCgpKSwgZ2V0T3B0aW9ucygpKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcInN0b3J5Ym9vayBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbnByb2dyYW1cbiAgLmNvbW1hbmQoXCJ1cmwgW3VyaS4uLl1cIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgU2ltcGxlIGNvbW1hbmQgdG8gb3BlbiBhIHNwZWNpZmllZCBVUkwgaW4gdGhlIGJyb3dzZXIuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHVyaTogc3RyaW5nKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvdXJsLmpzXCIpKS5kZWZhdWx0KHVyaSkuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUud2FybihcInVybCBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHJlbGVhc2UgPSBwcm9ncmFtLmNvbW1hbmQoXCJyZWxlYXNlXCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBUaGVzZSBjb21tYW5kcyBhcmUgdXNlZCBmb3IgZmFjaWxpdGF0aW5nIGRpc3RyaWJ1dGlvbiByZWxlYXNlcyBvZlxuICAgIGFwcGxpY2F0aW9ucy4gVGhpcyBpbmNsdWRlcyB0b29scyBmb3IgYnVpbGRpbmcgdGggZGlzdCBmb2xkZXIgZnJhZ21lbnRzLFxuICAgIHZpZXdpbmcgdGhlIGV4cGVjdGVkIHJlbGVhc2Ugbm90ZXMsIGFuZCBhY3R1YWxseSBwZXJmb3JtaW5nIGEgY29tcGxldGVcbiAgICByZWxlYXNlIGN5Y2xlLlxuICBgXG4pO1xuXG5yZWxlYXNlXG4gIC5jb21tYW5kKFwiZGVwbG95IFthZGQtcmVtb3RlLi4uXVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBQZXJmb3JtcyBhY3Rpb25zIG5lY2Vzc2FyeSB0byB1cGRhdGUgdGhlIGRpc3RyaWJ1dGlvbiBvZiB0aGUgcHJvamVjdC5cbiAgICAgIFRoaXMgd2lsbCBhdXRvbWF0aWNhbGx5IHVwZGF0ZSByZWxlYXNlIG5vdGVzLCB0YWcgdGhlIHJlbGVhc2UsIGFuZFxuICAgICAgY29tbWl0IGFuZCBwdXNoIHRvIGEgJ3JlbGVhc2UnIGJyYW5jaCB3aGljaCB3aWxsIGJlIHJlYWR5IGZvciBtZXJnaW5nXG4gICAgICBpbnRvIG1hc3RlciBhbmQgZGV2LlxuXG4gICAgICBTcGVjaWZ5IGFkZGl0aW9uYWwgcmVtb3RlcyB0byBkZXBsb3kgdG8gdmlhIHRoZSBhZGQtcmVtb3RlIG9wdGlvbi5cbiAgICAgIFRoaXMgd2lsbCBkZXBsb3kgdGhlIHJlbGVhc2UgdG8gYWRkaXRpb25hbCByZW1vdGVzIChBRlRFUiBhbGwgb3RoZXIgbm9ybWFsXG4gICAgICBkZXBsb3kgb3BlcmF0aW9ucyBjb21wbGV0ZSkuIFRoaXMgdmFsdWUgaXMgdGhlIE5BTUUgb2YgdGhlIHJlbW90ZSBhcyBpdFxuICAgICAgYXBwZWFycyB3aGVuIHlvdSBwZXJmb3JtIGEgXCJnaXQgcmVtb3RlIC12XCIgY29tbWFuZC5cblxuICAgICAgWW91IGNhbiBzcGVjaWZ5IGEgc3BlY2lmaWMgdGFyZ2V0IGJyYW5jaCB2aWEgYSBjb2xvbjogcmVtb3RlOmJyYW5jaFxuICAgICAgT3RoZXJ3aXNlLCB0aGlzIHdpbGwgdXNlIHRoZSBzYW1lIG1haW4gYnJhbmNoIGFzIGNvbmZpZ3VyZWQgZm9yIHRoaXNcbiAgICAgIHByb2plY3QuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHJlbW90ZXM6IHN0cmluZ1tdKSA9PiB7XG4gICAgLy8gQmVmb3JlIHN0YXJ0aW5nIHRoZSByZWxlYXNlIHNjcmlwdCBtYWtlIHN1cmUgb3VyIHBhY2thZ2VzIGFyZSB1cCB0byBkYXRlIHRvIHRoZSBsYXRlc3RcbiAgICBleGVjSW5zdGFsbChbXSk7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLWRlcGxveS5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KHJlbW90ZXMpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIFwicmVsZWFzZS1kZXBsb3kgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XFxuXCIsXG4gICAgICAgICAgZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlXG4gICAgICAgICk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxucmVsZWFzZVxuICAuY29tbWFuZChcInR5cGVzXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFVwZGF0ZXMgSlVTVCB0aGUgdHlwZXMgaW4gdGhlIGRpc3QgZm9sZGVyLiBUaGVzZSBhcmUgdGhlIHNhbWUgdHlwZXNcbiAgICAgIGdlbmVyYXRlZCB3aGVuIGJ1aWxkaW5nIGEgcmVsZWFzZS5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgLy8gQmVmb3JlIHN0YXJ0aW5nIHRoZSByZWxlYXNlIHNjcmlwdCBtYWtlIHN1cmUgb3VyIHBhY2thZ2VzIGFyZSB1cCB0byBkYXRlIHRvIHRoZSBsYXRlc3RcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9yZWxlYXNlL3JlbGVhc2UtdHlwZXMuanNcIikpXG4gICAgICAuZGVmYXVsdCgpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIFwicmVsZWFzZS10eXBlcyBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcXG5cIixcbiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5yZWxlYXNlXG4gIC5jb21tYW5kKFwidmlld1wiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBUaGlzIHJ1bnMgdGhlIHJlbGVhc2UtdmlldyBzY3JpcHQuIEZvciB0aGlzIGNhc2UsIGl0IHdpbGwgb25seSBkaXNwbGF5XG4gICAgICB0aGUgcmVsZWFzZSBub3RlcyBpbiB0aGUgY29uc29sZS4gQWN0dWFsIGdlbmVyYXRlZCByZWxlYXNlIG5vdGVzIGFyZSBhXG4gICAgICBwYXJ0IG9mIHRoZSByZWxlYXNlIHByb2Nlc3MuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3RzLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoXCJcIilcbiAgICAgIC50aGVuKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGNoYWxrLmN5YW5CcmlnaHRCb2xkKFwiVFMgY2hlY2sgcGFzc2VkLCBnZW5lcmF0aW5nIG5vdGVzLi4uXCIpXG4gICAgICAgICk7XG4gICAgICAgIC8vIEJlZm9yZSBzdGFydGluZyB0aGUgcmVsZWFzZSBzY3JpcHQgbWFrZSBzdXJlIG91ciBwYWNrYWdlcyBhcmUgdXAgdG8gZGF0ZSB0byB0aGUgbGF0ZXN0XG4gICAgICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3JlbGVhc2UvcmVsZWFzZS12aWV3LmpzXCIpKVxuICAgICAgICAgIC5kZWZhdWx0KClcbiAgICAgICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgICAgXCJyZWxlYXNlLW5vdGVzIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiLFxuICAgICAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICAgICAgfSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICBjaGFsay5yZWRCcmlnaHRCb2xkKFxuICAgICAgICAgICAgZGVzY3JpcHRpb25gXG4gICAgICAgICAgICAgIEZhaWxlZCBUUyBjaGVjay4gUmVsZWFzZSBub3RlcyB3aWxsIG5vdCBiZSBwcm9kdWNlZCB1bnRpbCBhbGwgVFNcbiAgICAgICAgICAgICAgZXJyb3JzIGFyZSByZXNvbHZlZC5cbiAgICAgICAgICAgIGBcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbnJlbGVhc2VcbiAgLmNvbW1hbmQoXCJidWlsZFwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBUaGlzIHJ1bnMgdGhlIHJlbGVhc2UtYnVpbGQgc2NyaXB0LiBUaGlzIGdlbmVyYXRlcyBhbGwgb2YgdGhlIHJlbGVhc2VcbiAgICAgIGZyYWdtZW50cy4gVGhpcyBzaG91bGQgT05MWSBiZSB1c2VkIGZvciB0ZXN0aW5nIGFuZCBleHBlcmltZW50aW5nLiBBY3R1YWxcbiAgICAgIHJlbGVhc2UgZnJhZ21lbnRzIHNob3VsZCBiZSBwcm9wZXJseSBjcmVhdGVkIGFuZCBkZXBsb3llZCB1c2luZyB0aGVcbiAgICAgIHJlbGVhc2UgZGVwbG95IGNvbW1hbmQuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3JlbGVhc2UvcmVsZWFzZS1idWlsZC5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLWRlcGxveSBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcXG5cIixcbiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCByZWxlYXNlU3RhcnQgPSByZWxlYXNlLmNvbW1hbmQoXCJzdGFydFwiKS5kZXNjcmlwdGlvbihcbiAgZGVzY3JpcHRpb25gXG4gICAgICBUaGlzIHN0YXJ0cyB1cCByZWxlYXNlZCByZWxhdGVkIHByb2Nlc3Nlcy4gVGhpcyBpbmNsdWRlcyB0aGluZ3MgbGlrZVxuICAgICAgc3RhcnRpbmcgdXAgdGhlIGRldiBzZXJ2ZXIgd2l0aG91dCBhbnkgYWRkaXRpb25hbCBidWlsZHMgb3IgYXV0b1xuICAgICAgY29uZmlndXJhdGlvbiBmb3IgZGV2ZWxvcG1lbnQuXG4gICAgYFxuKTtcblxucmVsZWFzZVN0YXJ0XG4gIC5jb21tYW5kKFwic2VydmVyXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFN0YXJ0cyB1cCB0aGUgYXBwIHNlcnZlciB3aXRob3V0IGFueSBhZGRpdGlvbmFsIGJ1aWxkcyBldGMuIFVzZSB0aGVcbiAgICAgIGVudmlyb25tZW50czpcblxuICAgICAgICBCVUlMRF9NT0RFOiBUYXJnZXRzIGFuIGVudiB0byBydW4gdGhlIHNlcnZlciBmb3IuXG4gICAgICAgIFJFU09VUkNFX1BBVEg6IFRoZSBwYXRoIHRvIHRoZSBzdGF0aWMgZmlsZXMgdG8gc2VydmUuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3JlbGVhc2UvcmVsZWFzZS1zdGFydC1zZXJ2ZXIuanNcIikpXG4gICAgICAuZGVmYXVsdCgpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIFwicmVsZWFzZS1zdGFydC1zZXJ2ZXIgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XFxuXCIsXG4gICAgICAgICAgZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlXG4gICAgICAgICk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxucHJvZ3JhbVxuICAuY29tbWFuZChcInN0YXJ0IFt0YXJnZXRdXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgZmlyZXMgdXAgYSBzZXJ2ZXIgdG8gbWFrZSBhbnkgc3RhdGljIGNvbnRlbnQgYXZhaWxhYmxlIGZvciBiZWluZ1xuICAgICAgc2VydmVkLlxuICAgICAgVGhlcmUgYXJlIGEgZmV3IG9wdGlvbnMgZm9yIHdoYXQgY29udGVudCB3aWxsIGJlIHNlcnZlZCBieSB0aGlzIHNjcmlwdDpcblxuICAgICAgLSBUaGUgd2ViIGFwcFxuICAgICAgLSBEZXZvcHMgQVBJXG5cbiAgICAgIFRoZSBzdGFydCBzY3JpcHQgd2lsbCBhdXRvbWF0aWNhbGx5IHBpY2sgdGhlIHdlYiBhcHAgb3ZlciB0aGUgZGV2b3BzXG4gICAgICBmaWxlcywgYnV0IHlvdSBjYW4gc3BlY2lmeSBhIHRhcmdldCBpZiB5b3UgaGF2ZSBhIGRldm9wcyBBUEkgYW5kIGEgd2ViXG4gICAgICBhcHA6XG5cbiAgICAgIC0gYXBwXG4gICAgICAtIGRldm9wc1xuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICh0YXJnZXQ6IHN0cmluZykgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3N0YXJ0LmpzXCIpKVxuICAgICAgLmRlZmF1bHQodGFyZ2V0LCBnZXRPcHRpb25zKCkpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwic3RhcnQgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCB0ZXN0ID0gcHJvZ3JhbS5jb21tYW5kKFwidGVzdFwiKS5kZXNjcmlwdGlvbihcbiAgZGVzY3JpcHRpb25gXG4gICAgVGhlc2UgY29tbWFuZHMgYXJlIHVzZWQgZm9yIHJ1bm5pbmcgdGVzdHMuIFRoaXMgaW5jbHVkZXMgdG9vbHMgZm9yXG4gICAgcnVubmluZyB1bml0IHRlc3RzIGEgc2luZ2xlIHRpbWUgb3IgaW4gYSB3YXRjaCBtb2RlLlxuXG4gICAgVXNlIHRoZSBlbnZpcm9ubWVudCB2YXJpYWJsZXMgZm9yIG1vZGlmeWluZyBiZWhhdmlvcjpcblxuICAgICR7Y2hhbGsueWVsbG93QnJpZ2h0Qm9sZChcIlBBVFRFUk5cIil9IC0gVGhpcyBjYXVzZXMgdGhlIHRlc3RzIHRvIG9ubHkgcnVuIG9uXG4gICAgZmlsZXMgdGhhdCBtYXRjaCB0aGUgcGF0dGVyblxuXG4gICAgJHtjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiTEVTU1wiKX0gLSBUaGlzIHJlbW92ZXMgdGhlIHZlcmJvc2Ugb3V0cHV0IGxpc3Qgb2ZcbiAgICBhbGwgdGVzdHMgcmFuXG4gIGBcbik7XG5cbnRlc3RcbiAgLmNvbW1hbmQoXCJydW5cIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgUnVucyBhbGwgdW5pdCB0ZXN0cyBpbiB0aGUgdW5pdC10ZXN0IGZvbGRlciBvbmNlLlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICgpID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy90ZXN0L3Rlc3QtcnVuLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcInRlc3QtcnVuIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxuY29uc3QgY2xlYW4gPSBwcm9ncmFtLmNvbW1hbmQoXCJjbGVhblwiKS5kZXNjcmlwdGlvbihcbiAgZGVzY3JpcHRpb25gXG4gICAgQ29tbW9uIGNsZWFuaW5nIHRvb2xzIGZvciB2YXJpb3VzIGZyYWdtZW50cyB3aXRoaW4gdGhlIHByb2plY3QuXG4gIGBcbik7XG5cbmNsZWFuXG4gIC5jb21tYW5kKFwiY2FjaGVcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgQ2xlYW5zIG91dCBidWlsZCBhbmQgY2FjaGUgZmlsZXMgdG8gaGVscCBlbnN1cmUgYSBjb21wbGV0ZSByZWJ1aWxkIHRha2VzXG4gICAgICBwbGFjZS5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvY2xlYW4vY2xlYW4tY2FjaGUuanNcIikpXG4gICAgICAuZGVmYXVsdCgpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwiY2xlYW4tY2FjaGUgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCB0cyA9IHByb2dyYW0uY29tbWFuZChcInRzXCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBUaGVzZSBjb21tYW5kcyBhcmUgdXNlZCBmb3IgcnVubmluZyB0eXBlc2NyaXB0LiBUaGlzIGluY2x1ZGVzIHRvb2xzIGZvclxuICAgIHJ1bm5pbmcgdHlwZXNjcmlwdCBjb21waWxhdGlvbiBhIHNpbmdsZSB0aW1lIG9yIGluIGEgd2F0Y2ggbW9kZS5cbiAgYFxuKTtcblxudHMuY29tbWFuZChcInJ1blwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBSdW5zIHR5cGVzY3JpcHQgY29tcGlsYXRpb24gdG8gY2hlY2sgZm9yIGVycm9ycy4gRG9lcyBOT1QgZW1pdCBmaWxlcywgdGh1c1xuICAgICAgaXMgYSBnb29kIG1lY2hhbmlzbSBmb3IgY2hlY2tpbmcgYSBidWlsZCBiZWZvcmUgcnVubmluZyBhIHJlbGVhc2UuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3RzLmpzXCIpKS5kZWZhdWx0KFwiXCIpLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLndhcm4oXCJ0cyBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHByID0gcHJvZ3JhbVxuICAuY29tbWFuZChcInByXCIpXG4gIC5vcHRpb24oXG4gICAgXCItLXJlcG9VcmwgPHZhbHVlPlwiLFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgVGhlIGh0dHBzIFVSTCB0byB0aGUgcmVwbyB0byBtYWtlIHRoZSBQUiBpbnRvXG4gICAgYFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLXJlcG9UeXBlIDx2YWx1ZT5cIixcbiAgICBkZXNjcmlwdGlvbmBcbiAgICBUaGUgcmVwb3NpdG9yeSB0eXBlIHRvIG1ha2UgdGhlIFBSIGludG8uIFN1cHBvcnRlZCB0eXBlcyBhcmU6IGdpdCwgZ2l0bGFiXG4gIGBcbiAgKVxuICAub3B0aW9uKFxuICAgIFwiLS1tYXN0ZXJCcmFuY2ggPHZhbHVlPlwiLFxuICAgIGRlc2NyaXB0aW9uYFxuICAgIFRoaXMgaW5kaWNhdGVzIHdoaWNoIGJyYW5jaCBpcyB0aGUgbWFzdGVyL21haW4gb2YgdGhlIHJlcG9zaXRvcnkuXG4gIGBcbiAgKTtcblxucHIuY29tbWFuZChcInJlbGVhc2VcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgVGhpcyBjcmVhdGVzIHR3byBQUnMgdGhhdCBtZXJnZXMgdGhlIGN1cnJlbnQgcmVtb3RlIHJlbGVhc2UgYnJhbmNoIGludG9cbiAgICAgIHRoZSByZW1vdGUgZGV2IGFuZCBtYXN0ZXIgYnJhbmNoZXMuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHsgcmVwb1VybCwgcmVwb1R5cGUsIG1hc3RlckJyYW5jaCB9ID0geWFyZ3MocHJvY2Vzcy5hcmd2KS5hcmd2IGFzIHtcbiAgICAgIHJlcG9UeXBlPzogc3RyaW5nO1xuICAgICAgcmVwb1VybD86IHN0cmluZztcbiAgICAgIG1hc3RlckJyYW5jaD86IHN0cmluZztcbiAgICB9O1xuXG4gICAgaWYgKCFyZXBvVXJsIHx8ICFyZXBvVHlwZSB8fCAhbWFzdGVyQnJhbmNoKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIFwiWW91IG11c3Qgc3BlY2lmeSBib3RoIC0tcmVwb1VybCBhbmQgLS1yZXBvVHlwZSB0byB1c2UgdGhpcyBjb21tYW5kXCJcbiAgICAgICk7XG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuXG4gICAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgYW55IHJlcXVpcmVkIHBlZXIgZGVwZW5kZW5jaWVzIGZvciB0aGlzXG4gICAgYXdhaXQgZW5zdXJlRGVwZW5kZW5jaWVzKCkuY2F0Y2goKCkgPT4gcHJvY2Vzcy5leGl0KDEpKTtcbiAgICBjb25zb2xlLndhcm4oXCJEZXBlbmRlbmN5IGNoZWNrcyBwYXNzZWQsIGNvbnRpbnVpbmcuLi5cIik7XG5cbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9wci9wci1yZWxlYXNlLmpzXCIpKVxuICAgICAgLmRlZmF1bHQocmVwb1VybCwgcmVwb1R5cGUsIG1hc3RlckJyYW5jaClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJwci1yZWxlYXNlIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxuYXN5bmMgZnVuY3Rpb24gcnVuKCkge1xuICAvLyBMb2FkIGluIGVudmlyb25tZW50IGZyb20gZW52IGZpbGUgYW5kIGFsc28gZW5zdXJlIGNvbmZpZ3VyYXRpb24gbWF0Y2hlcyB0aGVcbiAgLy8gZW52aXJvbm1lbnQgY29uZmlndXJhdGlvbiBzcGVjaWZpZWQgaW4gZW52LmNvbmZpZy50c1xuICBhd2FpdCBjb25maWdFbnYocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKTtcbiAgcHJvZ3JhbS5wYXJzZShwcm9jZXNzLmFyZ3YpO1xufVxuXG5ydW4oKTtcbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyBkZXNjcmlwdGlvbiB9IGZyb20gXCIuL2Rlc2NyaXB0aW9uLmpzXCI7XG5pbXBvcnQgeyBkb3RlbnYgfSBmcm9tIFwiLi9kb3QtZW52LmpzXCI7XG5pbXBvcnQgeyBpc0RlZmluZWQsIGlzU3RyaW5nIH0gZnJvbSBcIi4vdHlwZXMuanNcIjtcbmltcG9ydCB7IHByb21wdENvbmZpcm0gfSBmcm9tIFwiLi4vcHJvbXB0L3Byb21wdC1jb25maXJtLmpzXCI7XG5pbXBvcnQgeyBwcm9tcHRPdmVycmlkZUZpbGUgfSBmcm9tIFwiLi4vcHJvbXB0L3Byb21wdC1vdmVycmlkZS1maWxlLmpzXCI7XG5cbnR5cGUgRW52Q29uZmlnT3B0aW9uID0ge1xuICByZXF1aXJlZDogYm9vbGVhbjtcbiAgd2Fybj86IGJvb2xlYW47XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgZGVmYXVsdD86IHN0cmluZyB8ICgoKSA9PiBQcm9taXNlPHN0cmluZz4pO1xufTtcblxuLyoqXG4gKiBNZXRob2QgdXNlZCB0byByZXRyaWV2ZSB0aGUgZW52aXJvbm1lbnQgY29uZmlndXJhdGlvbiBmaWxlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29uZmlnRW52KCkge1xuICBjb25zdCBlbnZDb25maWc6IEVudkNvbmZpZ09wdGlvbltdID0gKFxuICAgIGF3YWl0IGltcG9ydChwYXRoLnJlc29sdmUoXCJlbnYuY29uZmlnLnRzXCIpKVxuICApLmRlZmF1bHQ7XG4gIGlmICghZW52Q29uZmlnKSB0aHJvdyBuZXcgRXJyb3IoXCJObyBlbnYuY29uZmlnLnRzIGZpbGUgZm91bmQuXCIpO1xuXG4gIGlmICghQXJyYXkuaXNBcnJheShlbnZDb25maWcpKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiZW52LmNvbmZpZy50cyBpcyBub3QgZm9ybWF0dGVkIGNvcnJlY3RseS4gUGxlYXNlIGZvbGxvdyB0aGUgY29ycmVjdCB0eXBlIGNvbnZlbnRpb24uXCJcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIGVudkNvbmZpZztcbn1cblxuLyoqXG4gKiBUaGlzIGVuc3VyZXMgdGhlIGVudmlyb25tZW50IGhhcyBhbGwgb2YgdGhlIG5lY2Vzc2FyeSBjb25maWd1cmF0aW9uIHZhcmlhYmxlc1xuICogdG8gbWFrZSB0aGUgc3lzdGVtIHdvcmsuIFRoaXMgYWxzbyBleGVjdXRlcyB0aGUgZG90ZW52IGxpYnJhcnkgdG8gZW5hYmxlIGVudlxuICogY29uZmlndXJhdGlvbiB2aWEgZW52IGZpbGUuXG4gKlxuICogSWYgdGhlIGVudmlyb25tZW50IGRvZXMgbm90IG1lZXQgdGhlIHByb2NvbmZpZ3VyZWQgZW52aXJvbm1lbnQgbmVlZHMsIHRoZW5cbiAqIHRoaXMgc2NyaXB0IHdpbGwgZXJyb3IgYW5kIGxvZyB3aGF0IGlzIG1pc3NpbmcgYW5kIGRldGFpbHMgYWJvdXQgdGhlXG4gKiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgdGhhdCBhcmUgbWlzc2luZy5cbiAqXG4gKiBJZiByZXF1ZXN0RGVmYXVsdCBpcyB0cnVlLCB0aGlzIHdpbGwgcHJvbXB0IHRoZSB1c2VyIGlmIHRoZXkgd291bGQgbGlrZSB0b1xuICogZ2VuZXJhdGUgYSAuZW52IGZpbGUgd2l0aCBhbGwgb2YgdGhlIGVudmlyb25tZW50J3Mgc2V0IHRoYXQgaGF2ZSBhIGRlZmF1bHRcbiAqIHZhbHVlLiBJZiB0aGUgdXNlciBjaG9vc2VzIHRvIGNyZWF0ZSB0aGUgZW52IGZpbGUsIHRoZSBkZWZhdWx0cyB3aWxsIGdldFxuICogYXBwbGllZCB0byB0aGUgZW52IGFzIHdlbGwgYW5kIG5vdCBlcnJvci5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbmZpZ0VudihyZXF1ZXN0RGVmYXVsdD86IGJvb2xlYW4pIHtcbiAgLy8gVGVsbCBkb3RlbnYgdG8gbG9hZCB0aGUgLmVudiBmaWxlXG4gIGRvdGVudigpO1xuXG4gIC8vIFdlIGxvYWQgaW4gdGhlIGVudi5jb25maWcudHMgZmlsZSBmcm9tIHRoZSBwcm9qZWN0IHJvb3QgdG8gYW5hbHl6ZSBpdCBmb3JcbiAgLy8gY29tcGxpYW5jZSB3aXRoIHRoZSBlbnZpcm9ubWVudC5cbiAgdHJ5IHtcbiAgICBjb25zdCBlbnZDb25maWc6IEVudkNvbmZpZ09wdGlvbltdID0gYXdhaXQgZ2V0Q29uZmlnRW52KCk7XG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZW52Q29uZmlnLmZvckVhY2goKGVudjogRW52Q29uZmlnT3B0aW9uKSA9PiB7XG4gICAgICAvLyBTa2lwIGZhbHNleSB2YWx1ZXNcbiAgICAgIGlmICghZW52KSByZXR1cm47XG5cbiAgICAgIGlmIChlbnYucmVxdWlyZWQpIHtcbiAgICAgICAgaWYgKCFwcm9jZXNzLmVudltlbnYubmFtZV0pIHtcbiAgICAgICAgICBlcnJvcnMucHVzaChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgTWlzc2luZzogJHtlbnYubmFtZX1cXG5EZXNyaXB0aW9uOiAke2Vudi5kZXNjcmlwdGlvbn1cbiAgICAgICAgICAgIGApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXByb2Nlc3MuZW52W2Vudi5uYW1lXSAmJiBlbnYud2FybiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGRlc2NyaXB0aW9uYFxuICAgICAgICAgICAgICBNaXNzaW5nOiAke2Vudi5uYW1lfVxcbkRlc3JpcHRpb246ICR7ZW52LmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICh3YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGNoYWxrLnllbGxvd0JyaWdodEJvbGQoXG4gICAgICAgICAgXCJUaGUgZm9sbG93aW5nIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgcmVjb21tZW5kZWQgYnV0IG1pc3NpbmcgZnJvbSB5b3VyIGVudmlyb25tZW50OlxcblwiXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGNoYWxrLnllbGxvd0JyaWdodChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAke3dhcm5pbmdzLmpvaW4oXCJcXG5cIil9XG4gICAgICAgIGApXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgY2hhbGsucmVkQnJpZ2h0Qm9sZChcbiAgICAgICAgICBcIlRoZSBmb2xsb3dpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSByZXF1aXJlZCBidXQgbWlzc2luZyBmcm9tIHlvdXIgZW52aXJvbm1lbnQ6XFxuXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGNoYWxrLnJlZEJyaWdodChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAke2Vycm9ycy5qb2luKFwiXFxuXCIpfVxuICAgICAgICBgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBRdWl0IHRoZSBwcm9jZXNzIGlmIHJlcXVpcmVtZW50cyBhcmUgbm90IG1ldFxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKHJlcXVlc3REZWZhdWx0KSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb21wdENvbmZpcm0oZGVzY3JpcHRpb25gXG4gICAgICAgICAgVGhlcmUgc2VlbXMgdG8gYmUgc29tZSBtaXNzaW5nIGVudmlyb25tZW50IHZhcmlhYmxlcy4gV291bGQgeW91IGxpa2VcbiAgICAgICAgICB0byBnZW5lcmF0ZSBhIC5lbnYgZmlsZSB3aXRoIHRoZSBkZWZhdWx0IHZhbHVlcyBzcGVjaWZpZWQgaW4gdGhlXG4gICAgICAgICAgZW52LmNvbmZpZyBmaWxlP1xuICAgICAgICBgKTtcblxuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgY29uc3QgZGVmYXVsdHM6IFtzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZF1bXSA9IFtdO1xuXG4gICAgICAgICAgZm9yIChjb25zdCBlbnYgb2YgZW52Q29uZmlnKSB7XG4gICAgICAgICAgICBkZWZhdWx0cy5wdXNoKFtcbiAgICAgICAgICAgICAgZW52Lm5hbWUsXG4gICAgICAgICAgICAgIGlzU3RyaW5nKGVudi5kZWZhdWx0KVxuICAgICAgICAgICAgICAgID8gZW52LmRlZmF1bHRcbiAgICAgICAgICAgICAgICA6IGlzRGVmaW5lZChlbnYuZGVmYXVsdClcbiAgICAgICAgICAgICAgICA/IGF3YWl0IGVudi5kZWZhdWx0KClcbiAgICAgICAgICAgICAgICA6IHZvaWQgMCxcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGRlZmF1bHRFbnYgPSBkZWZhdWx0c1xuICAgICAgICAgICAgLmZpbHRlcigoZCkgPT4gZFsxXSlcbiAgICAgICAgICAgIC5tYXAoKGQpID0+IGAke2RbMF19PSR7ZFsxXX1gKVxuICAgICAgICAgICAgLmpvaW4oXCJcXG5cIik7XG5cbiAgICAgICAgICBpZiAoIWRlZmF1bHRFbnYpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgVGhlcmUgYXJlIG5vIGRlZmF1bHRzIGF2YWlsYWJsZSBmb3IgdGhpcyBlbnYuY29uZmlnLiBTbyB3ZSBjYW4gbm90XG4gICAgICAgICAgICAgIGdlbmVyYXRlIGFuIGVudiBmaWxlIHlvdS4gUGxlYXNlIHJldmlldyB0aGUgZW52LmNvbmZpZy50cyBmaWxlIGFuZFxuICAgICAgICAgICAgICBwcm9wZXJseSBzZXQgdGhlIGRlZmF1bHQgdmFsdWVzIGZvciB0aGUgcmVxdWlyZWQgZW52aXJvbm1lbnRcbiAgICAgICAgICAgICAgdmFyaWFibGVzLlxuICAgICAgICAgICAgYCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZW52RmlsZVBhdGggPSBwYXRoLnJlc29sdmUoXCIuZW52XCIpO1xuXG4gICAgICAgICAgY29uc3QgZGlkV3JpdGUgPSBhd2FpdCBwcm9tcHRPdmVycmlkZUZpbGUoXG4gICAgICAgICAgICBlbnZGaWxlUGF0aCxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uYFxuICAgICAgICAgICAgICBUaGVyZSBhcHBlYXJzIHRvIGFscmVhZHkgYmUgYSAuZW52IGZpbGUuXG4gICAgICAgICAgICAgIFdvdWxkIHlvdSBsaWtlIHRvIGFkZCB0aGUgbWlzc2luZyBkZWZhdWx0cyB0byBpdD9cbiAgICAgICAgICAgIGAsXG4gICAgICAgICAgICAoKSA9PiB7fSxcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBuZXcgZW52IGZpbGVcbiAgICAgICAgICAgICgpID0+IGZzLndyaXRlRmlsZShlbnZGaWxlUGF0aCwgZGVmYXVsdEVudiksXG5cbiAgICAgICAgICAgIC8vIFdlIHdpbGwgYWRkIHRoZSBlbnYgcGFyYW1zIHRvIHRoZSBleGlzdGluZyBlbnYgZmlsZSBpbnN0ZWFkIG9mXG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhlbnZGaWxlUGF0aCwgYFxcbiR7ZGVmYXVsdEVudn1gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAoIWRpZFdyaXRlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgICAgICBcIkRpZCBub3Qgd3JpdGUgdGhlIC5lbnYgZmlsZS4gUGxlYXNlIGNvcnJlY3QgdGhlIGVudiBhbmQgdHJ5IGFnYWluLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENvbnN1bWUgdGhlIC5lbnYgZmlsZSBhZ2FpbiBhbmQgc2VlIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZVxuICAgICAgICAgIC8vIGVudmlyb25tZW50XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgXCJBdHRlbXB0aW5nIHRvIGJ1aWxkIHRoZSBlbnYgYWdhaW4gYW5kIGNvbnRpbnVlIHdpdGggdGhlIGNvbW1hbmQuLi5cIlxuICAgICAgICAgICk7XG5cbiAgICAgICAgICByZXR1cm4gY29uZmlnRW52KGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS53YXJuKGRlc2NyaXB0aW9uYFxuICAgICAgTm8gJHtjaGFsay5jeWFuQnJpZ2h0Qm9sZChcbiAgICAgICAgXCJlbnYuY29uZmlnLnRzXCJcbiAgICAgICl9IGZpbGUgZm91bmQuIEVudmlyb25tZW50IHdpbGwgbm90IGJlIHZhbGlkYXRlZC5cbiAgICBgKTtcbiAgfVxufVxuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4vY2hhbGsuanNcIjtcbmltcG9ydCB7IHBhcnNlUHJvcHMgfSBmcm9tIFwiLi9wYXJzZS1wcm9wcy5qc1wiO1xuXG4vKipcbiAqIEN1c3RvbSBkb3RlbnYgcm91dGluZSB0byByZWR1Y2UgZGVwZW5kZW5jaWVzLlxuICpcbiAqIFRoaXMgdGFrZXMgaW4gdGhlIHByb2plY3QncyAuZW52IGZpbGUgYW5kIGFwcGxpZXMgdGhlIHZhbHVlcyB0aGVyZWluIHRvIHRoZVxuICogcHJvY2Vzcy5lbnYgb2JqZWN0LlxuICpcbiAqIFRoaXMgT05MWSBzdXBwb3J0cyBzaW1wbGUga2V5L3ZhbHVlIHBhaXJzIGFuZCBkb2VzIE5PVCBzdXBwb3J0IGFueSBjb21wbGV4XG4gKiBwcm9wcyBmaWxlIHN0cnVjdHVyZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkb3RlbnYodGFyZ2V0RmlsZT86IHN0cmluZykge1xuICB0cnkge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhwYXRoLnJlc29sdmUoXCIuZW52XCIpKSkgcmV0dXJuO1xuICAgIC8vIFJlYWQgdGhlIC5lbnYgZmlsZVxuICAgIGNvbnN0IGNvbnRlbnRzID0gZnMucmVhZEZpbGVTeW5jKFxuICAgICAgcGF0aC5yZXNvbHZlKHRhcmdldEZpbGUgfHwgXCIuZW52XCIpLFxuICAgICAgXCJ1dGY4XCJcbiAgICApO1xuICAgIC8vIFBhcnNlIHRoZSBmaWxlXG4gICAgY29uc3QgcHJvcHMgPSBwYXJzZVByb3BzKGNvbnRlbnRzKTtcblxuICAgIC8vIEFwcGx5IG9ubHkgc2ltcGxlIGtleSB2YWx1ZSBwYWlycyB0byBwcm9jZXNzLmVudlxuICAgIE9iamVjdC5lbnRyaWVzKHByb3BzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgY2hhbGsucmVkKFxuICAgICAgICAgIGBFcnJvciByZWFkaW5nIC5lbnYgZmlsZTpcXG5gLFxuICAgICAgICAgIGNoYWxrLnllbGxvdyhlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG4iLAogICJ0eXBlIFZhbHVlID0gc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbjtcbnR5cGUgUGFyc2VSZXN1bHQgPSBSZWNvcmQ8c3RyaW5nLCBWYWx1ZSB8IFJlY29yZDxzdHJpbmcsIFZhbHVlPj47XG5cbi8qKlxuICogVGhpcyBwYXJzZXMgYSBwcm9wcyBmaWxlIGludG8gYSBtYXAgb2Yga2V5L3ZhbHVlIHBhaXJzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VQcm9wcyhjb250ZW50czogc3RyaW5nKTogUGFyc2VSZXN1bHQge1xuICBjb25zdCBsaW5lcyA9IGNvbnRlbnRzLnNwbGl0KC9cXHI/XFxuLyk7XG5cbiAgY29uc3QgcmVzdWx0OiBQYXJzZVJlc3VsdCA9IHt9O1xuICBsZXQgY3VycmVudFNlY3Rpb246IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBsZXQgY3VycmVudE9iamVjdDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgbGluZXMuZm9yRWFjaCgobGluZSkgPT4ge1xuICAgIGxpbmUgPSBsaW5lLnRyaW0oKTtcblxuICAgIC8vIElnbm9yZSBlbXB0eSBsaW5lcyBhbmQgY29tbWVudHNcbiAgICBpZiAobGluZSA9PT0gXCJcIiB8fCBsaW5lLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGEgbmV3IHNlY3Rpb25cbiAgICBpZiAobGluZS5lbmRzV2l0aChcIntcIikpIHtcbiAgICAgIGNvbnN0IHNlY3Rpb25OYW1lID0gbGluZS5zcGxpdCgvXFxzKy8pWzBdO1xuICAgICAgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9uTmFtZTtcbiAgICAgIHJlc3VsdFtjdXJyZW50U2VjdGlvbl0gPSB7fTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBmb3IgdGhlIGVuZCBvZiBhIHNlY3Rpb25cbiAgICBpZiAobGluZSA9PT0gXCJ9XCIpIHtcbiAgICAgIGN1cnJlbnRTZWN0aW9uID0gbnVsbDtcbiAgICAgIGN1cnJlbnRPYmplY3QgPSBudWxsO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFBhcnNlIGtleS12YWx1ZSBwYWlyc1xuICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihbXFx3Ll0rKVxccyo9XFxzKiguKikkLyk7XG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXTtcbiAgICAgIGxldCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiA9IG1hdGNoWzJdO1xuXG4gICAgICAvLyBDb252ZXJ0IHZhbHVlcyB0byB0aGUgYXBwcm9wcmlhdGUgdHlwZVxuICAgICAgaWYgKCFpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkpIHtcbiAgICAgICAgdmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IFwidHJ1ZVwiKSB7XG4gICAgICAgIHZhbHVlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IFwiZmFsc2VcIikge1xuICAgICAgICB2YWx1ZSA9IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBBZGQgdGhlIGtleS12YWx1ZSBwYWlyIHRvIHRoZSByZXN1bHRcbiAgICAgIGlmIChjdXJyZW50T2JqZWN0KSB7XG4gICAgICAgIChcbiAgICAgICAgICByZXN1bHRbY3VycmVudFNlY3Rpb24gPz8gXCJudWxsXCJdIGFzIHVua25vd24gYXMgUmVjb3JkPFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgUmVjb3JkPHN0cmluZywgVmFsdWU+XG4gICAgICAgICAgPlxuICAgICAgICApW2N1cnJlbnRPYmplY3RdW2tleV0gPSB2YWx1ZTtcbiAgICAgIH0gZWxzZSBpZiAoY3VycmVudFNlY3Rpb24pIHtcbiAgICAgICAgKHJlc3VsdFtjdXJyZW50U2VjdGlvbl0gYXMgUmVjb3JkPHN0cmluZywgVmFsdWU+KVtrZXldID0gdmFsdWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIGEgbmV3IG9iamVjdCBpbiBhIHNlY3Rpb25cbiAgICBjb25zdCBvYmplY3RNYXRjaCA9IGxpbmUubWF0Y2goL14oW1xcdy5dKylcXC4oW1xcdy5dKylcXHMqPVxccyooLiopJC8pO1xuICAgIGlmIChvYmplY3RNYXRjaCkge1xuICAgICAgY29uc3Qgc2VjdGlvbk5hbWUgPSBvYmplY3RNYXRjaFsxXTtcbiAgICAgIGNvbnN0IG9iamVjdE5hbWUgPSBvYmplY3RNYXRjaFsyXTtcbiAgICAgIGNvbnN0IGtleSA9IG9iamVjdE1hdGNoWzNdO1xuXG4gICAgICBpZiAoIXJlc3VsdFtzZWN0aW9uTmFtZV0pIHtcbiAgICAgICAgcmVzdWx0W3NlY3Rpb25OYW1lXSA9IHt9O1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgICEoXG4gICAgICAgICAgcmVzdWx0W3NlY3Rpb25OYW1lXSBhcyB1bmtub3duIGFzIFJlY29yZDxcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIFJlY29yZDxzdHJpbmcsIFZhbHVlPlxuICAgICAgICAgID5cbiAgICAgICAgKVtvYmplY3ROYW1lXVxuICAgICAgKSB7XG4gICAgICAgIChcbiAgICAgICAgICByZXN1bHRbc2VjdGlvbk5hbWVdIGFzIHVua25vd24gYXMgUmVjb3JkPFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgUmVjb3JkPHN0cmluZywgVmFsdWU+XG4gICAgICAgICAgPlxuICAgICAgICApW29iamVjdE5hbWVdID0ge307XG4gICAgICB9XG5cbiAgICAgICgocmVzdWx0W3NlY3Rpb25OYW1lXSBhcyBhbnkpW29iamVjdE5hbWVdIGFzIGFueSlba2V5XSA9IG51bGw7XG4gICAgICBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb25OYW1lO1xuICAgICAgY3VycmVudE9iamVjdCA9IG9iamVjdE5hbWU7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zb2xlLmVycm9yKGBVbnJlY29nbml6ZWQgbGluZTogJHtsaW5lfWApO1xuICB9KTtcblxuICByZXR1cm4gcmVzdWx0O1xufVxuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4vY2hhbGsuanNcIjtcbmltcG9ydCB7IHBhcnNlUHJvcHMgfSBmcm9tIFwiLi9wYXJzZS1wcm9wcy5qc1wiO1xuXG4vKipcbiAqIEN1c3RvbSBkb3RlbnYgcm91dGluZSB0byByZWR1Y2UgZGVwZW5kZW5jaWVzLlxuICpcbiAqIFRoaXMgdGFrZXMgaW4gdGhlIHByb2plY3QncyAuZW52IGZpbGUgYW5kIGFwcGxpZXMgdGhlIHZhbHVlcyB0aGVyZWluIHRvIHRoZVxuICogcHJvY2Vzcy5lbnYgb2JqZWN0LlxuICpcbiAqIFRoaXMgT05MWSBzdXBwb3J0cyBzaW1wbGUga2V5L3ZhbHVlIHBhaXJzIGFuZCBkb2VzIE5PVCBzdXBwb3J0IGFueSBjb21wbGV4XG4gKiBwcm9wcyBmaWxlIHN0cnVjdHVyZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkb3RlbnYodGFyZ2V0RmlsZT86IHN0cmluZykge1xuICB0cnkge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhwYXRoLnJlc29sdmUoXCIuZW52XCIpKSkgcmV0dXJuO1xuICAgIC8vIFJlYWQgdGhlIC5lbnYgZmlsZVxuICAgIGNvbnN0IGNvbnRlbnRzID0gZnMucmVhZEZpbGVTeW5jKFxuICAgICAgcGF0aC5yZXNvbHZlKHRhcmdldEZpbGUgfHwgXCIuZW52XCIpLFxuICAgICAgXCJ1dGY4XCJcbiAgICApO1xuICAgIC8vIFBhcnNlIHRoZSBmaWxlXG4gICAgY29uc3QgcHJvcHMgPSBwYXJzZVByb3BzKGNvbnRlbnRzKTtcblxuICAgIC8vIEFwcGx5IG9ubHkgc2ltcGxlIGtleSB2YWx1ZSBwYWlycyB0byBwcm9jZXNzLmVudlxuICAgIE9iamVjdC5lbnRyaWVzKHByb3BzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgcHJvY2Vzcy5lbnZba2V5XSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgY2hhbGsucmVkKFxuICAgICAgICAgIGBFcnJvciByZWFkaW5nIC5lbnYgZmlsZTpcXG5gLFxuICAgICAgICAgIGNoYWxrLnllbGxvdyhlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG4iLAogICJpbXBvcnQgZnMgZnJvbSBcImZzLWV4dHJhXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHsgY2hhbGsgfSBmcm9tIFwiLi9jaGFsay5qc1wiO1xuaW1wb3J0IHsgZGVzY3JpcHRpb24gfSBmcm9tIFwiLi9kZXNjcmlwdGlvbi5qc1wiO1xuaW1wb3J0IHsgZG90ZW52IH0gZnJvbSBcIi4vZG90LWVudi5qc1wiO1xuaW1wb3J0IHsgaXNEZWZpbmVkLCBpc1N0cmluZyB9IGZyb20gXCIuL3R5cGVzLmpzXCI7XG5pbXBvcnQgeyBwcm9tcHRDb25maXJtIH0gZnJvbSBcIi4uL3Byb21wdC9wcm9tcHQtY29uZmlybS5qc1wiO1xuaW1wb3J0IHsgcHJvbXB0T3ZlcnJpZGVGaWxlIH0gZnJvbSBcIi4uL3Byb21wdC9wcm9tcHQtb3ZlcnJpZGUtZmlsZS5qc1wiO1xuXG50eXBlIEVudkNvbmZpZ09wdGlvbiA9IHtcbiAgcmVxdWlyZWQ6IGJvb2xlYW47XG4gIHdhcm4/OiBib29sZWFuO1xuICBuYW1lOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gIGRlZmF1bHQ/OiBzdHJpbmcgfCAoKCkgPT4gUHJvbWlzZTxzdHJpbmc+KTtcbn07XG5cbi8qKlxuICogTWV0aG9kIHVzZWQgdG8gcmV0cmlldmUgdGhlIGVudmlyb25tZW50IGNvbmZpZ3VyYXRpb24gZmlsZS5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbmZpZ0VudigpIHtcbiAgY29uc3QgZW52Q29uZmlnOiBFbnZDb25maWdPcHRpb25bXSA9IChcbiAgICBhd2FpdCBpbXBvcnQocGF0aC5yZXNvbHZlKFwiZW52LmNvbmZpZy50c1wiKSlcbiAgKS5kZWZhdWx0O1xuICBpZiAoIWVudkNvbmZpZykgdGhyb3cgbmV3IEVycm9yKFwiTm8gZW52LmNvbmZpZy50cyBmaWxlIGZvdW5kLlwiKTtcblxuICBpZiAoIUFycmF5LmlzQXJyYXkoZW52Q29uZmlnKSkge1xuICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICBcImVudi5jb25maWcudHMgaXMgbm90IGZvcm1hdHRlZCBjb3JyZWN0bHkuIFBsZWFzZSBmb2xsb3cgdGhlIGNvcnJlY3QgdHlwZSBjb252ZW50aW9uLlwiXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBlbnZDb25maWc7XG59XG5cbi8qKlxuICogVGhpcyBlbnN1cmVzIHRoZSBlbnZpcm9ubWVudCBoYXMgYWxsIG9mIHRoZSBuZWNlc3NhcnkgY29uZmlndXJhdGlvbiB2YXJpYWJsZXNcbiAqIHRvIG1ha2UgdGhlIHN5c3RlbSB3b3JrLiBUaGlzIGFsc28gZXhlY3V0ZXMgdGhlIGRvdGVudiBsaWJyYXJ5IHRvIGVuYWJsZSBlbnZcbiAqIGNvbmZpZ3VyYXRpb24gdmlhIGVudiBmaWxlLlxuICpcbiAqIElmIHRoZSBlbnZpcm9ubWVudCBkb2VzIG5vdCBtZWV0IHRoZSBwcm9jb25maWd1cmVkIGVudmlyb25tZW50IG5lZWRzLCB0aGVuXG4gKiB0aGlzIHNjcmlwdCB3aWxsIGVycm9yIGFuZCBsb2cgd2hhdCBpcyBtaXNzaW5nIGFuZCBkZXRhaWxzIGFib3V0IHRoZVxuICogZW52aXJvbm1lbnQgdmFyaWFibGVzIHRoYXQgYXJlIG1pc3NpbmcuXG4gKlxuICogSWYgcmVxdWVzdERlZmF1bHQgaXMgdHJ1ZSwgdGhpcyB3aWxsIHByb21wdCB0aGUgdXNlciBpZiB0aGV5IHdvdWxkIGxpa2UgdG9cbiAqIGdlbmVyYXRlIGEgLmVudiBmaWxlIHdpdGggYWxsIG9mIHRoZSBlbnZpcm9ubWVudCdzIHNldCB0aGF0IGhhdmUgYSBkZWZhdWx0XG4gKiB2YWx1ZS4gSWYgdGhlIHVzZXIgY2hvb3NlcyB0byBjcmVhdGUgdGhlIGVudiBmaWxlLCB0aGUgZGVmYXVsdHMgd2lsbCBnZXRcbiAqIGFwcGxpZWQgdG8gdGhlIGVudiBhcyB3ZWxsIGFuZCBub3QgZXJyb3IuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25maWdFbnYocmVxdWVzdERlZmF1bHQ/OiBib29sZWFuKSB7XG4gIC8vIFRlbGwgZG90ZW52IHRvIGxvYWQgdGhlIC5lbnYgZmlsZVxuICBkb3RlbnYoKTtcblxuICAvLyBXZSBsb2FkIGluIHRoZSBlbnYuY29uZmlnLnRzIGZpbGUgZnJvbSB0aGUgcHJvamVjdCByb290IHRvIGFuYWx5emUgaXQgZm9yXG4gIC8vIGNvbXBsaWFuY2Ugd2l0aCB0aGUgZW52aXJvbm1lbnQuXG4gIHRyeSB7XG4gICAgY29uc3QgZW52Q29uZmlnOiBFbnZDb25maWdPcHRpb25bXSA9IGF3YWl0IGdldENvbmZpZ0VudigpO1xuICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxuICAgIGVudkNvbmZpZy5mb3JFYWNoKChlbnY6IEVudkNvbmZpZ09wdGlvbikgPT4ge1xuICAgICAgLy8gU2tpcCBmYWxzZXkgdmFsdWVzXG4gICAgICBpZiAoIWVudikgcmV0dXJuO1xuXG4gICAgICBpZiAoZW52LnJlcXVpcmVkKSB7XG4gICAgICAgIGlmICghcHJvY2Vzcy5lbnZbZW52Lm5hbWVdKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goZGVzY3JpcHRpb25gXG4gICAgICAgICAgICAgIE1pc3Npbmc6ICR7ZW52Lm5hbWV9XFxuRGVzcmlwdGlvbjogJHtlbnYuZGVzY3JpcHRpb259XG4gICAgICAgICAgICBgKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFwcm9jZXNzLmVudltlbnYubmFtZV0gJiYgZW52Lndhcm4gIT09IGZhbHNlKSB7XG4gICAgICAgICAgd2FybmluZ3MucHVzaChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgTWlzc2luZzogJHtlbnYubmFtZX1cXG5EZXNyaXB0aW9uOiAke2Vudi5kZXNjcmlwdGlvbn1cbiAgICAgICAgICAgIGApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAod2FybmluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFxuICAgICAgICAgIFwiVGhlIGZvbGxvd2luZyBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXJlIHJlY29tbWVuZGVkIGJ1dCBtaXNzaW5nIGZyb20geW91ciBlbnZpcm9ubWVudDpcXG5cIlxuICAgICAgICApXG4gICAgICApO1xuICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICBjaGFsay55ZWxsb3dCcmlnaHQoZGVzY3JpcHRpb25gXG4gICAgICAgICAgJHt3YXJuaW5ncy5qb2luKFwiXFxuXCIpfVxuICAgICAgICBgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGNoYWxrLnJlZEJyaWdodEJvbGQoXG4gICAgICAgICAgXCJUaGUgZm9sbG93aW5nIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgcmVxdWlyZWQgYnV0IG1pc3NpbmcgZnJvbSB5b3VyIGVudmlyb25tZW50OlxcblwiXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBjaGFsay5yZWRCcmlnaHQoZGVzY3JpcHRpb25gXG4gICAgICAgICAgJHtlcnJvcnMuam9pbihcIlxcblwiKX1cbiAgICAgICAgYClcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gUXVpdCB0aGUgcHJvY2VzcyBpZiByZXF1aXJlbWVudHMgYXJlIG5vdCBtZXRcbiAgICBpZiAoZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChyZXF1ZXN0RGVmYXVsdCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm9tcHRDb25maXJtKGRlc2NyaXB0aW9uYFxuICAgICAgICAgIFRoZXJlIHNlZW1zIHRvIGJlIHNvbWUgbWlzc2luZyBlbnZpcm9ubWVudCB2YXJpYWJsZXMuIFdvdWxkIHlvdSBsaWtlXG4gICAgICAgICAgdG8gZ2VuZXJhdGUgYSAuZW52IGZpbGUgd2l0aCB0aGUgZGVmYXVsdCB2YWx1ZXMgc3BlY2lmaWVkIGluIHRoZVxuICAgICAgICAgIGVudi5jb25maWcgZmlsZT9cbiAgICAgICAgYCk7XG5cbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIGNvbnN0IGRlZmF1bHRzOiBbc3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWRdW10gPSBbXTtcblxuICAgICAgICAgIGZvciAoY29uc3QgZW52IG9mIGVudkNvbmZpZykge1xuICAgICAgICAgICAgZGVmYXVsdHMucHVzaChbXG4gICAgICAgICAgICAgIGVudi5uYW1lLFxuICAgICAgICAgICAgICBpc1N0cmluZyhlbnYuZGVmYXVsdClcbiAgICAgICAgICAgICAgICA/IGVudi5kZWZhdWx0XG4gICAgICAgICAgICAgICAgOiBpc0RlZmluZWQoZW52LmRlZmF1bHQpXG4gICAgICAgICAgICAgICAgPyBhd2FpdCBlbnYuZGVmYXVsdCgpXG4gICAgICAgICAgICAgICAgOiB2b2lkIDAsXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBkZWZhdWx0RW52ID0gZGVmYXVsdHNcbiAgICAgICAgICAgIC5maWx0ZXIoKGQpID0+IGRbMV0pXG4gICAgICAgICAgICAubWFwKChkKSA9PiBgJHtkWzBdfT0ke2RbMV19YClcbiAgICAgICAgICAgIC5qb2luKFwiXFxuXCIpO1xuXG4gICAgICAgICAgaWYgKCFkZWZhdWx0RW52KSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oZGVzY3JpcHRpb25gXG4gICAgICAgICAgICAgIFRoZXJlIGFyZSBubyBkZWZhdWx0cyBhdmFpbGFibGUgZm9yIHRoaXMgZW52LmNvbmZpZy4gU28gd2UgY2FuIG5vdFxuICAgICAgICAgICAgICBnZW5lcmF0ZSBhbiBlbnYgZmlsZSB5b3UuIFBsZWFzZSByZXZpZXcgdGhlIGVudi5jb25maWcudHMgZmlsZSBhbmRcbiAgICAgICAgICAgICAgcHJvcGVybHkgc2V0IHRoZSBkZWZhdWx0IHZhbHVlcyBmb3IgdGhlIHJlcXVpcmVkIGVudmlyb25tZW50XG4gICAgICAgICAgICAgIHZhcmlhYmxlcy5cbiAgICAgICAgICAgIGApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGVudkZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKFwiLmVudlwiKTtcblxuICAgICAgICAgIGNvbnN0IGRpZFdyaXRlID0gYXdhaXQgcHJvbXB0T3ZlcnJpZGVGaWxlKFxuICAgICAgICAgICAgZW52RmlsZVBhdGgsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgVGhlcmUgYXBwZWFycyB0byBhbHJlYWR5IGJlIGEgLmVudiBmaWxlLlxuICAgICAgICAgICAgICBXb3VsZCB5b3UgbGlrZSB0byBhZGQgdGhlIG1pc3NpbmcgZGVmYXVsdHMgdG8gaXQ/XG4gICAgICAgICAgICBgLFxuICAgICAgICAgICAgKCkgPT4ge30sXG4gICAgICAgICAgICAvLyBUaGlzIGlzIGEgbmV3IGVudiBmaWxlXG4gICAgICAgICAgICAoKSA9PiBmcy53cml0ZUZpbGUoZW52RmlsZVBhdGgsIGRlZmF1bHRFbnYpLFxuXG4gICAgICAgICAgICAvLyBXZSB3aWxsIGFkZCB0aGUgZW52IHBhcmFtcyB0byB0aGUgZXhpc3RpbmcgZW52IGZpbGUgaW5zdGVhZCBvZlxuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgaXRcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMoZW52RmlsZVBhdGgsIGBcXG4ke2RlZmF1bHRFbnZ9YCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgaWYgKCFkaWRXcml0ZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICAgICAgXCJEaWQgbm90IHdyaXRlIHRoZSAuZW52IGZpbGUuIFBsZWFzZSBjb3JyZWN0IHRoZSBlbnYgYW5kIHRyeSBhZ2Fpbi5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBDb25zdW1lIHRoZSAuZW52IGZpbGUgYWdhaW4gYW5kIHNlZSB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGVcbiAgICAgICAgICAvLyBlbnZpcm9ubWVudFxuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgIFwiQXR0ZW1wdGluZyB0byBidWlsZCB0aGUgZW52IGFnYWluIGFuZCBjb250aW51ZSB3aXRoIHRoZSBjb21tYW5kLi4uXCJcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgcmV0dXJuIGNvbmZpZ0VudihmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUud2FybihkZXNjcmlwdGlvbmBcbiAgICAgIE5vICR7Y2hhbGsuY3lhbkJyaWdodEJvbGQoXG4gICAgICAgIFwiZW52LmNvbmZpZy50c1wiXG4gICAgICApfSBmaWxlIGZvdW5kLiBFbnZpcm9ubWVudCB3aWxsIG5vdCBiZSB2YWxpZGF0ZWQuXG4gICAgYCk7XG4gIH1cbn1cbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBpbnF1aXJlciBmcm9tIFwiaW5xdWlyZXJcIjtcbmltcG9ydCB7IHN0cmlwSW5kZW50IH0gZnJvbSBcImNvbW1vbi10YWdzXCI7XG5cbi8qKlxuICogQ29udmVuaWVuY2Ugd3JhcHBlciBhcm91bmQgY3VycmVudCBwcm9tcHQgbGlicmFyeSBvZiBjaG9pY2UgdG8gcHJlc2VudCBhXG4gKiBjb25maXJtYXRpb24gZGlhbG9nIGZvciB3aGVuIGEgZmlsZSBwYXRoIGV4aXN0cy4gSWYgdGhlIGZpbGUgZG9lcyBub3QgZXhpc3QsXG4gKiB0aGVyZSB3aWxsIGJlIG5vIHByb21wdC5cbiAqXG4gKiBBcHBsaWVzIHN0cmlwSW5kZW50IHRvIHRoZSBpbnB1dCBtZXNzYWdlLlxuICpcbiAqIFJldHVybnMgdGhlIHRydWUgZmFsc2UgdmFsdWUgb2YgdGhlIHByb21wdC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb21wdE92ZXJyaWRlRmlsZShcbiAgZmlsZVBhdGg6IHN0cmluZyxcbiAgbWVzc2FnZTogc3RyaW5nLFxuICBvbldyaXRlOiAocGF0aDogc3RyaW5nKSA9PiB2b2lkLFxuICBvbk5ldz86IChwYXRoOiBzdHJpbmcpID0+IHZvaWQsXG4gIG9uT3ZlcnJpZGU/OiAocGF0aDogc3RyaW5nKSA9PiB2b2lkLFxuICBkZWZhdWx0VmFsdWU/OiBib29sZWFuXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgbGV0IG91dCA9IGRlZmF1bHRWYWx1ZSB8fCBmYWxzZTtcblxuICBpZiAoZnMuZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICBjb25zdCB7IHJlc3VsdCB9ID0gYXdhaXQgaW5xdWlyZXIucHJvbXB0PHtcbiAgICAgIHJlc3VsdDogYm9vbGVhbjtcbiAgICB9PihbXG4gICAgICB7XG4gICAgICAgIHR5cGU6IFwiY29uZmlybVwiLFxuICAgICAgICBuYW1lOiBcInJlc3VsdFwiLFxuICAgICAgICBtZXNzYWdlOiBzdHJpcEluZGVudGAke21lc3NhZ2V9YCxcbiAgICAgICAgZGVmYXVsdDogZGVmYXVsdFZhbHVlLFxuICAgICAgfSxcbiAgICBdKTtcblxuICAgIC8vIFdoZW4geWVzL3RydWUgaXMgc2VsZWN0ZWQsIHJ1biB0aGUgb25Db25maXJtZWQgY2FsbGJhY2tcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICBvbldyaXRlKGZpbGVQYXRoKTtcbiAgICAgIG9uT3ZlcnJpZGU/LihmaWxlUGF0aCk7XG4gICAgfVxuXG4gICAgb3V0ID0gcmVzdWx0O1xuICB9IGVsc2Uge1xuICAgIG9uV3JpdGUoZmlsZVBhdGgpO1xuICAgIG9uTmV3Py4oZmlsZVBhdGgpO1xuICB9XG5cbiAgcmV0dXJuIG91dDtcbn1cbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBjaGFsayB9IGZyb20gXCIuL2NoYWxrLmpzXCI7XG5pbXBvcnQgeyBkZXNjcmlwdGlvbiB9IGZyb20gXCIuL2Rlc2NyaXB0aW9uLmpzXCI7XG5pbXBvcnQgeyBkb3RlbnYgfSBmcm9tIFwiLi9kb3QtZW52LmpzXCI7XG5pbXBvcnQgeyBpc0RlZmluZWQsIGlzU3RyaW5nIH0gZnJvbSBcIi4vdHlwZXMuanNcIjtcbmltcG9ydCB7IHByb21wdENvbmZpcm0gfSBmcm9tIFwiLi4vcHJvbXB0L3Byb21wdC1jb25maXJtLmpzXCI7XG5pbXBvcnQgeyBwcm9tcHRPdmVycmlkZUZpbGUgfSBmcm9tIFwiLi4vcHJvbXB0L3Byb21wdC1vdmVycmlkZS1maWxlLmpzXCI7XG5cbnR5cGUgRW52Q29uZmlnT3B0aW9uID0ge1xuICByZXF1aXJlZDogYm9vbGVhbjtcbiAgd2Fybj86IGJvb2xlYW47XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgZGVmYXVsdD86IHN0cmluZyB8ICgoKSA9PiBQcm9taXNlPHN0cmluZz4pO1xufTtcblxuLyoqXG4gKiBNZXRob2QgdXNlZCB0byByZXRyaWV2ZSB0aGUgZW52aXJvbm1lbnQgY29uZmlndXJhdGlvbiBmaWxlLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29uZmlnRW52KCkge1xuICBjb25zdCBlbnZDb25maWc6IEVudkNvbmZpZ09wdGlvbltdID0gKFxuICAgIGF3YWl0IGltcG9ydChwYXRoLnJlc29sdmUoXCJlbnYuY29uZmlnLnRzXCIpKVxuICApLmRlZmF1bHQ7XG4gIGlmICghZW52Q29uZmlnKSB0aHJvdyBuZXcgRXJyb3IoXCJObyBlbnYuY29uZmlnLnRzIGZpbGUgZm91bmQuXCIpO1xuXG4gIGlmICghQXJyYXkuaXNBcnJheShlbnZDb25maWcpKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiZW52LmNvbmZpZy50cyBpcyBub3QgZm9ybWF0dGVkIGNvcnJlY3RseS4gUGxlYXNlIGZvbGxvdyB0aGUgY29ycmVjdCB0eXBlIGNvbnZlbnRpb24uXCJcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIGVudkNvbmZpZztcbn1cblxuLyoqXG4gKiBUaGlzIGVuc3VyZXMgdGhlIGVudmlyb25tZW50IGhhcyBhbGwgb2YgdGhlIG5lY2Vzc2FyeSBjb25maWd1cmF0aW9uIHZhcmlhYmxlc1xuICogdG8gbWFrZSB0aGUgc3lzdGVtIHdvcmsuIFRoaXMgYWxzbyBleGVjdXRlcyB0aGUgZG90ZW52IGxpYnJhcnkgdG8gZW5hYmxlIGVudlxuICogY29uZmlndXJhdGlvbiB2aWEgZW52IGZpbGUuXG4gKlxuICogSWYgdGhlIGVudmlyb25tZW50IGRvZXMgbm90IG1lZXQgdGhlIHByb2NvbmZpZ3VyZWQgZW52aXJvbm1lbnQgbmVlZHMsIHRoZW5cbiAqIHRoaXMgc2NyaXB0IHdpbGwgZXJyb3IgYW5kIGxvZyB3aGF0IGlzIG1pc3NpbmcgYW5kIGRldGFpbHMgYWJvdXQgdGhlXG4gKiBlbnZpcm9ubWVudCB2YXJpYWJsZXMgdGhhdCBhcmUgbWlzc2luZy5cbiAqXG4gKiBJZiByZXF1ZXN0RGVmYXVsdCBpcyB0cnVlLCB0aGlzIHdpbGwgcHJvbXB0IHRoZSB1c2VyIGlmIHRoZXkgd291bGQgbGlrZSB0b1xuICogZ2VuZXJhdGUgYSAuZW52IGZpbGUgd2l0aCBhbGwgb2YgdGhlIGVudmlyb25tZW50J3Mgc2V0IHRoYXQgaGF2ZSBhIGRlZmF1bHRcbiAqIHZhbHVlLiBJZiB0aGUgdXNlciBjaG9vc2VzIHRvIGNyZWF0ZSB0aGUgZW52IGZpbGUsIHRoZSBkZWZhdWx0cyB3aWxsIGdldFxuICogYXBwbGllZCB0byB0aGUgZW52IGFzIHdlbGwgYW5kIG5vdCBlcnJvci5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbmZpZ0VudihyZXF1ZXN0RGVmYXVsdD86IGJvb2xlYW4pIHtcbiAgLy8gVGVsbCBkb3RlbnYgdG8gbG9hZCB0aGUgLmVudiBmaWxlXG4gIGRvdGVudigpO1xuXG4gIC8vIFdlIGxvYWQgaW4gdGhlIGVudi5jb25maWcudHMgZmlsZSBmcm9tIHRoZSBwcm9qZWN0IHJvb3QgdG8gYW5hbHl6ZSBpdCBmb3JcbiAgLy8gY29tcGxpYW5jZSB3aXRoIHRoZSBlbnZpcm9ubWVudC5cbiAgdHJ5IHtcbiAgICBjb25zdCBlbnZDb25maWc6IEVudkNvbmZpZ09wdGlvbltdID0gYXdhaXQgZ2V0Q29uZmlnRW52KCk7XG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHdhcm5pbmdzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgZW52Q29uZmlnLmZvckVhY2goKGVudjogRW52Q29uZmlnT3B0aW9uKSA9PiB7XG4gICAgICAvLyBTa2lwIGZhbHNleSB2YWx1ZXNcbiAgICAgIGlmICghZW52KSByZXR1cm47XG5cbiAgICAgIGlmIChlbnYucmVxdWlyZWQpIHtcbiAgICAgICAgaWYgKCFwcm9jZXNzLmVudltlbnYubmFtZV0pIHtcbiAgICAgICAgICBlcnJvcnMucHVzaChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgTWlzc2luZzogJHtlbnYubmFtZX1cXG5EZXNyaXB0aW9uOiAke2Vudi5kZXNjcmlwdGlvbn1cbiAgICAgICAgICAgIGApO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIXByb2Nlc3MuZW52W2Vudi5uYW1lXSAmJiBlbnYud2FybiAhPT0gZmFsc2UpIHtcbiAgICAgICAgICB3YXJuaW5ncy5wdXNoKGRlc2NyaXB0aW9uYFxuICAgICAgICAgICAgICBNaXNzaW5nOiAke2Vudi5uYW1lfVxcbkRlc3JpcHRpb246ICR7ZW52LmRlc2NyaXB0aW9ufVxuICAgICAgICAgICAgYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICh3YXJuaW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGNoYWxrLnllbGxvd0JyaWdodEJvbGQoXG4gICAgICAgICAgXCJUaGUgZm9sbG93aW5nIGVudmlyb25tZW50IHZhcmlhYmxlcyBhcmUgcmVjb21tZW5kZWQgYnV0IG1pc3NpbmcgZnJvbSB5b3VyIGVudmlyb25tZW50OlxcblwiXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGNoYWxrLnllbGxvd0JyaWdodChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAke3dhcm5pbmdzLmpvaW4oXCJcXG5cIil9XG4gICAgICAgIGApXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgY2hhbGsucmVkQnJpZ2h0Qm9sZChcbiAgICAgICAgICBcIlRoZSBmb2xsb3dpbmcgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSByZXF1aXJlZCBidXQgbWlzc2luZyBmcm9tIHlvdXIgZW52aXJvbm1lbnQ6XFxuXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGNoYWxrLnJlZEJyaWdodChkZXNjcmlwdGlvbmBcbiAgICAgICAgICAke2Vycm9ycy5qb2luKFwiXFxuXCIpfVxuICAgICAgICBgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBRdWl0IHRoZSBwcm9jZXNzIGlmIHJlcXVpcmVtZW50cyBhcmUgbm90IG1ldFxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgaWYgKHJlcXVlc3REZWZhdWx0KSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb21wdENvbmZpcm0oZGVzY3JpcHRpb25gXG4gICAgICAgICAgVGhlcmUgc2VlbXMgdG8gYmUgc29tZSBtaXNzaW5nIGVudmlyb25tZW50IHZhcmlhYmxlcy4gV291bGQgeW91IGxpa2VcbiAgICAgICAgICB0byBnZW5lcmF0ZSBhIC5lbnYgZmlsZSB3aXRoIHRoZSBkZWZhdWx0IHZhbHVlcyBzcGVjaWZpZWQgaW4gdGhlXG4gICAgICAgICAgZW52LmNvbmZpZyBmaWxlP1xuICAgICAgICBgKTtcblxuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgY29uc3QgZGVmYXVsdHM6IFtzdHJpbmcsIHN0cmluZyB8IHVuZGVmaW5lZF1bXSA9IFtdO1xuXG4gICAgICAgICAgZm9yIChjb25zdCBlbnYgb2YgZW52Q29uZmlnKSB7XG4gICAgICAgICAgICBkZWZhdWx0cy5wdXNoKFtcbiAgICAgICAgICAgICAgZW52Lm5hbWUsXG4gICAgICAgICAgICAgIGlzU3RyaW5nKGVudi5kZWZhdWx0KVxuICAgICAgICAgICAgICAgID8gZW52LmRlZmF1bHRcbiAgICAgICAgICAgICAgICA6IGlzRGVmaW5lZChlbnYuZGVmYXVsdClcbiAgICAgICAgICAgICAgICA/IGF3YWl0IGVudi5kZWZhdWx0KClcbiAgICAgICAgICAgICAgICA6IHZvaWQgMCxcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGRlZmF1bHRFbnYgPSBkZWZhdWx0c1xuICAgICAgICAgICAgLmZpbHRlcigoZCkgPT4gZFsxXSlcbiAgICAgICAgICAgIC5tYXAoKGQpID0+IGAke2RbMF19PSR7ZFsxXX1gKVxuICAgICAgICAgICAgLmpvaW4oXCJcXG5cIik7XG5cbiAgICAgICAgICBpZiAoIWRlZmF1bHRFbnYpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgVGhlcmUgYXJlIG5vIGRlZmF1bHRzIGF2YWlsYWJsZSBmb3IgdGhpcyBlbnYuY29uZmlnLiBTbyB3ZSBjYW4gbm90XG4gICAgICAgICAgICAgIGdlbmVyYXRlIGFuIGVudiBmaWxlIHlvdS4gUGxlYXNlIHJldmlldyB0aGUgZW52LmNvbmZpZy50cyBmaWxlIGFuZFxuICAgICAgICAgICAgICBwcm9wZXJseSBzZXQgdGhlIGRlZmF1bHQgdmFsdWVzIGZvciB0aGUgcmVxdWlyZWQgZW52aXJvbm1lbnRcbiAgICAgICAgICAgICAgdmFyaWFibGVzLlxuICAgICAgICAgICAgYCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZW52RmlsZVBhdGggPSBwYXRoLnJlc29sdmUoXCIuZW52XCIpO1xuXG4gICAgICAgICAgY29uc3QgZGlkV3JpdGUgPSBhd2FpdCBwcm9tcHRPdmVycmlkZUZpbGUoXG4gICAgICAgICAgICBlbnZGaWxlUGF0aCxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uYFxuICAgICAgICAgICAgICBUaGVyZSBhcHBlYXJzIHRvIGFscmVhZHkgYmUgYSAuZW52IGZpbGUuXG4gICAgICAgICAgICAgIFdvdWxkIHlvdSBsaWtlIHRvIGFkZCB0aGUgbWlzc2luZyBkZWZhdWx0cyB0byBpdD9cbiAgICAgICAgICAgIGAsXG4gICAgICAgICAgICAoKSA9PiB7fSxcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgYSBuZXcgZW52IGZpbGVcbiAgICAgICAgICAgICgpID0+IGZzLndyaXRlRmlsZShlbnZGaWxlUGF0aCwgZGVmYXVsdEVudiksXG5cbiAgICAgICAgICAgIC8vIFdlIHdpbGwgYWRkIHRoZSBlbnYgcGFyYW1zIHRvIHRoZSBleGlzdGluZyBlbnYgZmlsZSBpbnN0ZWFkIG9mXG4gICAgICAgICAgICAvLyBvdmVycmlkZSBpdFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhlbnZGaWxlUGF0aCwgYFxcbiR7ZGVmYXVsdEVudn1gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBpZiAoIWRpZFdyaXRlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICAgICAgICBcIkRpZCBub3Qgd3JpdGUgdGhlIC5lbnYgZmlsZS4gUGxlYXNlIGNvcnJlY3QgdGhlIGVudiBhbmQgdHJ5IGFnYWluLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIENvbnN1bWUgdGhlIC5lbnYgZmlsZSBhZ2FpbiBhbmQgc2VlIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZVxuICAgICAgICAgIC8vIGVudmlyb25tZW50XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgXCJBdHRlbXB0aW5nIHRvIGJ1aWxkIHRoZSBlbnYgYWdhaW4gYW5kIGNvbnRpbnVlIHdpdGggdGhlIGNvbW1hbmQuLi5cIlxuICAgICAgICAgICk7XG5cbiAgICAgICAgICByZXR1cm4gY29uZmlnRW52KGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS53YXJuKGRlc2NyaXB0aW9uYFxuICAgICAgTm8gJHtjaGFsay5jeWFuQnJpZ2h0Qm9sZChcbiAgICAgICAgXCJlbnYuY29uZmlnLnRzXCJcbiAgICAgICl9IGZpbGUgZm91bmQuIEVudmlyb25tZW50IHdpbGwgbm90IGJlIHZhbGlkYXRlZC5cbiAgICBgKTtcbiAgfVxufVxuIiwKICAiIyEvdXNyL2Jpbi9lbnYgYnVuXG5pbXBvcnQgKiBhcyBjb21tYW5kZXIgZnJvbSBcImNvbW1hbmRlclwiO1xuaW1wb3J0IEF1dG9Db21wbGV0ZVByb21wdCBmcm9tIFwiaW5xdWlyZXItYXV0b2NvbXBsZXRlLXByb21wdFwiO1xuaW1wb3J0IGlucXVpcmVyIGZyb20gXCJpbnF1aXJlclwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB5YXJncyBmcm9tIFwieWFyZ3NcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4vbGliL3V0aWwvY2hhbGsuanNcIjtcbmltcG9ydCB7IGNvbmZpZ0VudiB9IGZyb20gXCIuL2xpYi91dGlsL2NvbmZpZy1lbnYuanNcIjtcbmltcG9ydCB7IGRlc2NyaXB0aW9uIH0gZnJvbSBcIi4vbGliL3V0aWwvZGVzY3JpcHRpb24uanNcIjtcbmltcG9ydCB7IGVuc3VyZURlcGVuZGVuY2llcyB9IGZyb20gXCIuL2NvbW1hbmRzL2Vuc3VyZS1kZXBlbmRlbmNpZXMuanNcIjtcbmltcG9ydCB7IGV4ZWNJbnN0YWxsIH0gZnJvbSBcIi4vbGliL2V4ZWMvZXhlYy1pbnN0YWxsLmpzXCI7XG5cbmlucXVpcmVyLnJlZ2lzdGVyUHJvbXB0KFwiYXV0b2NvbXBsZXRlXCIsIEF1dG9Db21wbGV0ZVByb21wdCk7XG5cbmNvbnN0IHsgQ29tbWFuZCB9ID0gY29tbWFuZGVyO1xuY29uc3QgcHJvZ3JhbTogYW55ID0gbmV3IENvbW1hbmQoKTtcbmNvbnN0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuZnVuY3Rpb24gZ2V0T3B0aW9ucygpIHtcbiAgb3B0aW9ucy5kZWJ1ZyA9IHByb2dyYW0uZGVidWc7XG4gIG9wdGlvbnMudmVyYm9zZSA9IHByb2dyYW0udmVyYm9zZTtcbiAgb3B0aW9ucy5wYXR0ZXJuID0gcHJvZ3JhbS5wYXR0ZXJuO1xuXG4gIHJldHVybiBvcHRpb25zO1xufVxuXG5wcm9ncmFtLnZlcnNpb24oXCIwLjAuMVwiKTtcbnByb2dyYW0ub3B0aW9uKFxuICBcIi12LCAtLXZlcmJvc2VcIixcbiAgXCJPdXRwdXRzIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb24gZHVyaW5nIGNyYXNoZXMuXCJcbik7XG5wcm9ncmFtLm9wdGlvbihcbiAgXCItLWRlYnVnIFtwYXJhbV1cIixcbiAgZGVzY3JpcHRpb25gXG4gICAgUHJvdmlkZXMgZGVidWdnaW5nIGNvbnRleHR1YWwgaW5mb3JtYXRpb24gdmFyaW91cyBjb21tYW5kcyBtaWdodCB1c2UgdG9cbiAgICBhaWQgaW4gZGV2ZWxvcGluZyBEZXZvcHMuXG4gIGBcbik7XG5cbnByb2dyYW0ub3B0aW9uKFxuICBcIi1wLCAtLXBhdHRlcm4gW3BhcmFtXVwiLFxuICBkZXNjcmlwdGlvbmBcbiAgICBQcm92aWRlcyBhIHBhdHRlcm4gZm9yIGNlcnRhaW4gb3BlcmF0aW9ucyB0byB1dGlsaXplLiBUaGlzIGlzIHByaW1hcmlseVxuICAgIHVzZWQgYnkgdW5pdCB0ZXN0cyB0byBmaWx0ZXIgdGVzdHMgdG8gc3BlY2lmaWVkIHRlc3RzLlxuICBgXG4pO1xuXG5jb25zdCBkZXYgPSBwcm9ncmFtLmNvbW1hbmQoXCJkZXZcIikuZGVzY3JpcHRpb24oXG4gIGRlc2NyaXB0aW9uYFxuICAgIFRoZXNlIGFyZSB0aGUgY29tbWFuZHMgYXNzb2NpYXRlZCB3aXRoIHN0YXJ0aW5nIHVwIGRldmVsb3BlciBlbnZpcm9ubWVudHNcbiAgICBmb3IgdmFyaW91cyBwcm9qZWN0IHR5cGVzIG9yIHBvcnRpb25zIG9mIGEgcHJvamVjdC5cbiAgYFxuKTtcblxuZGV2XG4gIC5jb21tYW5kKFwidml0ZVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBTdGFydHMgdXAgYSBkZXZlbG9wZXIgZW52aXJvbm1lbnQgdGhhdCBwZXJmb3JtcyBpbmNyZW1lbnRhbCBidWlsZHMgd2hpbGVcbiAgICAgIGRldmVsb3Bpbmcgd2l0aGluIHRoZSBsaWIgYW5kIGFwcCBmb2xkZXJzLiBVc2VzIHZpdGUgYW5kIHZpdGVcbiAgICAgIGNvbmZpZy5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvZGV2L2Rldi12aXRlLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcImRldi12aXRlIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxuZGV2XG4gIC5jb21tYW5kKFwic3Rvcnlib29rXCIpXG4gIC5vcHRpb24oXG4gICAgXCItaSwgLS1pbmNsdWRlIDxpbmNsdWRlLi4uPlwiLFxuICAgIFwiQWRkaXRpb25hbCBzdG9yeWJvb2sgbW9kdWxlcyB0byBsb2FkIGludG8gc3Rvcnlib29rLiBUaGVzZSBhcmUgdGhlIG5hbWVzIG9mIHByb3Blcmx5IGZvcm1hdHRlZCBkZXBlbmRlbmNpZXMgaW5zdGFsbGVkIGludG8gbm9kZV9tb2R1bGVzLlwiXG4gIClcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgU3RhcnRzIGEgc3Rvcnlib29rIGluc3RhbmNlIGZvciBkZXZlbG9waW5nIHRoZSBVSSBjb21wb25lbnRzIG9mIHRoZVxuICAgICAgcHJvamVjdC4gVGhpcyBtYWtlcyB0aGUgXCJ1aS9zdG9yaWVzXCIgZm9sZGVyIGluIHRoZSBwcm9qZWN0IHRoZSBleHBlY3RlZFxuICAgICAgZGV2ZWxvcG1lbnQgcG9pbnQuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHsgaW5jbHVkZSB9OiB7IGluY2x1ZGU6IHN0cmluZ1tdIH0pID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9zdG9yeWJvb2suanNcIikpXG4gICAgICAuZGVmYXVsdChcIlwiLCBpbmNsdWRlLCBwYXRoLnJlc29sdmUocHJvY2Vzcy5jd2QoKSksIGdldE9wdGlvbnMoKSlcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJzdG9yeWJvb2sgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCBzdG9yeWJvb2sgPSBwcm9ncmFtLmNvbW1hbmQoXCJzdG9yeWJvb2tcIik7XG5cbnN0b3J5Ym9va1xuICAuY29tbWFuZChcInJ1blwiKVxuICAub3B0aW9uKFxuICAgIFwiLWksIC0taW5jbHVkZSA8aW5jbHVkZS4uLj5cIixcbiAgICBcIkFkZGl0aW9uYWwgc3Rvcnlib29rIG1vZHVsZXMgdG8gbG9hZCBpbnRvIHN0b3J5Ym9vay4gVGhlc2UgYXJlIHRoZSBuYW1lcyBvZiBwcm9wZXJseSBmb3JtYXR0ZWQgZGVwZW5kZW5jaWVzIGluc3RhbGxlZCBpbnRvIG5vZGVfbW9kdWxlcy5cIlxuICApXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFN0YXJ0cyBhIHN0b3J5Ym9vayBpbnN0YW5jZSBmb3IgZGV2ZWxvcGluZyB0aGUgVUkgY29tcG9uZW50cyBvZiB0aGVcbiAgICAgIHByb2plY3QuIFRoaXMgbWFrZXMgdGhlIFwidWkvc3Rvcmllc1wiIGZvbGRlciBpbiB0aGUgcHJvamVjdCB0aGUgZXhwZWN0ZWRcbiAgICAgIGRldmVsb3BtZW50IHBvaW50LlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICh7IGluY2x1ZGUgfTogeyBpbmNsdWRlOiBzdHJpbmdbXSB9KSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvc3Rvcnlib29rLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoXCJcIiwgaW5jbHVkZSwgcGF0aC5yZXNvbHZlKHByb2Nlc3MuY3dkKCkpLCBnZXRPcHRpb25zKCkpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwic3Rvcnlib29rIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxucHJvZ3JhbVxuICAuY29tbWFuZChcInVybCBbdXJpLi4uXVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBTaW1wbGUgY29tbWFuZCB0byBvcGVuIGEgc3BlY2lmaWVkIFVSTCBpbiB0aGUgYnJvd3Nlci5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAodXJpOiBzdHJpbmcpID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy91cmwuanNcIikpLmRlZmF1bHQodXJpKS5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgY29uc29sZS53YXJuKFwidXJsIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH0pO1xuICB9KTtcblxuY29uc3QgcmVsZWFzZSA9IHByb2dyYW0uY29tbWFuZChcInJlbGVhc2VcIikuZGVzY3JpcHRpb24oXG4gIGRlc2NyaXB0aW9uYFxuICAgIFRoZXNlIGNvbW1hbmRzIGFyZSB1c2VkIGZvciBmYWNpbGl0YXRpbmcgZGlzdHJpYnV0aW9uIHJlbGVhc2VzIG9mXG4gICAgYXBwbGljYXRpb25zLiBUaGlzIGluY2x1ZGVzIHRvb2xzIGZvciBidWlsZGluZyB0aCBkaXN0IGZvbGRlciBmcmFnbWVudHMsXG4gICAgdmlld2luZyB0aGUgZXhwZWN0ZWQgcmVsZWFzZSBub3RlcywgYW5kIGFjdHVhbGx5IHBlcmZvcm1pbmcgYSBjb21wbGV0ZVxuICAgIHJlbGVhc2UgY3ljbGUuXG4gIGBcbik7XG5cbnJlbGVhc2VcbiAgLmNvbW1hbmQoXCJkZXBsb3kgW2FkZC1yZW1vdGUuLi5dXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFBlcmZvcm1zIGFjdGlvbnMgbmVjZXNzYXJ5IHRvIHVwZGF0ZSB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBwcm9qZWN0LlxuICAgICAgVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgdXBkYXRlIHJlbGVhc2Ugbm90ZXMsIHRhZyB0aGUgcmVsZWFzZSwgYW5kXG4gICAgICBjb21taXQgYW5kIHB1c2ggdG8gYSAncmVsZWFzZScgYnJhbmNoIHdoaWNoIHdpbGwgYmUgcmVhZHkgZm9yIG1lcmdpbmdcbiAgICAgIGludG8gbWFzdGVyIGFuZCBkZXYuXG5cbiAgICAgIFNwZWNpZnkgYWRkaXRpb25hbCByZW1vdGVzIHRvIGRlcGxveSB0byB2aWEgdGhlIGFkZC1yZW1vdGUgb3B0aW9uLlxuICAgICAgVGhpcyB3aWxsIGRlcGxveSB0aGUgcmVsZWFzZSB0byBhZGRpdGlvbmFsIHJlbW90ZXMgKEFGVEVSIGFsbCBvdGhlciBub3JtYWxcbiAgICAgIGRlcGxveSBvcGVyYXRpb25zIGNvbXBsZXRlKS4gVGhpcyB2YWx1ZSBpcyB0aGUgTkFNRSBvZiB0aGUgcmVtb3RlIGFzIGl0XG4gICAgICBhcHBlYXJzIHdoZW4geW91IHBlcmZvcm0gYSBcImdpdCByZW1vdGUgLXZcIiBjb21tYW5kLlxuXG4gICAgICBZb3UgY2FuIHNwZWNpZnkgYSBzcGVjaWZpYyB0YXJnZXQgYnJhbmNoIHZpYSBhIGNvbG9uOiByZW1vdGU6YnJhbmNoXG4gICAgICBPdGhlcndpc2UsIHRoaXMgd2lsbCB1c2UgdGhlIHNhbWUgbWFpbiBicmFuY2ggYXMgY29uZmlndXJlZCBmb3IgdGhpc1xuICAgICAgcHJvamVjdC5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAocmVtb3Rlczogc3RyaW5nW10pID0+IHtcbiAgICAvLyBCZWZvcmUgc3RhcnRpbmcgdGhlIHJlbGVhc2Ugc2NyaXB0IG1ha2Ugc3VyZSBvdXIgcGFja2FnZXMgYXJlIHVwIHRvIGRhdGUgdG8gdGhlIGxhdGVzdFxuICAgIGV4ZWNJbnN0YWxsKFtdKTtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9yZWxlYXNlL3JlbGVhc2UtZGVwbG95LmpzXCIpKVxuICAgICAgLmRlZmF1bHQocmVtb3RlcylcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLWRlcGxveSBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcXG5cIixcbiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5yZWxlYXNlXG4gIC5jb21tYW5kKFwidHlwZXNcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgVXBkYXRlcyBKVVNUIHRoZSB0eXBlcyBpbiB0aGUgZGlzdCBmb2xkZXIuIFRoZXNlIGFyZSB0aGUgc2FtZSB0eXBlc1xuICAgICAgZ2VuZXJhdGVkIHdoZW4gYnVpbGRpbmcgYSByZWxlYXNlLlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICgpID0+IHtcbiAgICAvLyBCZWZvcmUgc3RhcnRpbmcgdGhlIHJlbGVhc2Ugc2NyaXB0IG1ha2Ugc3VyZSBvdXIgcGFja2FnZXMgYXJlIHVwIHRvIGRhdGUgdG8gdGhlIGxhdGVzdFxuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3JlbGVhc2UvcmVsZWFzZS10eXBlcy5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLXR5cGVzIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVxcblwiLFxuICAgICAgICAgIGVyci5zdGFjayB8fCBlcnIubWVzc2FnZVxuICAgICAgICApO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbnJlbGVhc2VcbiAgLmNvbW1hbmQoXCJ2aWV3XCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgcnVucyB0aGUgcmVsZWFzZS12aWV3IHNjcmlwdC4gRm9yIHRoaXMgY2FzZSwgaXQgd2lsbCBvbmx5IGRpc3BsYXlcbiAgICAgIHRoZSByZWxlYXNlIG5vdGVzIGluIHRoZSBjb25zb2xlLiBBY3R1YWwgZ2VuZXJhdGVkIHJlbGVhc2Ugbm90ZXMgYXJlIGFcbiAgICAgIHBhcnQgb2YgdGhlIHJlbGVhc2UgcHJvY2Vzcy5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvdHMuanNcIikpXG4gICAgICAuZGVmYXVsdChcIlwiKVxuICAgICAgLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgY2hhbGsuY3lhbkJyaWdodEJvbGQoXCJUUyBjaGVjayBwYXNzZWQsIGdlbmVyYXRpbmcgbm90ZXMuLi5cIilcbiAgICAgICAgKTtcbiAgICAgICAgLy8gQmVmb3JlIHN0YXJ0aW5nIHRoZSByZWxlYXNlIHNjcmlwdCBtYWtlIHN1cmUgb3VyIHBhY2thZ2VzIGFyZSB1cCB0byBkYXRlIHRvIHRoZSBsYXRlc3RcbiAgICAgICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLXZpZXcuanNcIikpXG4gICAgICAgICAgLmRlZmF1bHQoKVxuICAgICAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICBcInJlbGVhc2Utbm90ZXMgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIsXG4gICAgICAgICAgICAgIGVyci5zdGFjayB8fCBlcnIubWVzc2FnZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGNoYWxrLnJlZEJyaWdodEJvbGQoXG4gICAgICAgICAgICBkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgRmFpbGVkIFRTIGNoZWNrLiBSZWxlYXNlIG5vdGVzIHdpbGwgbm90IGJlIHByb2R1Y2VkIHVudGlsIGFsbCBUU1xuICAgICAgICAgICAgICBlcnJvcnMgYXJlIHJlc29sdmVkLlxuICAgICAgICAgICAgYFxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxucmVsZWFzZVxuICAuY29tbWFuZChcImJ1aWxkXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgcnVucyB0aGUgcmVsZWFzZS1idWlsZCBzY3JpcHQuIFRoaXMgZ2VuZXJhdGVzIGFsbCBvZiB0aGUgcmVsZWFzZVxuICAgICAgZnJhZ21lbnRzLiBUaGlzIHNob3VsZCBPTkxZIGJlIHVzZWQgZm9yIHRlc3RpbmcgYW5kIGV4cGVyaW1lbnRpbmcuIEFjdHVhbFxuICAgICAgcmVsZWFzZSBmcmFnbWVudHMgc2hvdWxkIGJlIHByb3Blcmx5IGNyZWF0ZWQgYW5kIGRlcGxveWVkIHVzaW5nIHRoZVxuICAgICAgcmVsZWFzZSBkZXBsb3kgY29tbWFuZC5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLWJ1aWxkLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICBcInJlbGVhc2UtZGVwbG95IHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVxcblwiLFxuICAgICAgICAgIGVyci5zdGFjayB8fCBlcnIubWVzc2FnZVxuICAgICAgICApO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHJlbGVhc2VTdGFydCA9IHJlbGVhc2UuY29tbWFuZChcInN0YXJ0XCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgc3RhcnRzIHVwIHJlbGVhc2VkIHJlbGF0ZWQgcHJvY2Vzc2VzLiBUaGlzIGluY2x1ZGVzIHRoaW5ncyBsaWtlXG4gICAgICBzdGFydGluZyB1cCB0aGUgZGV2IHNlcnZlciB3aXRob3V0IGFueSBhZGRpdGlvbmFsIGJ1aWxkcyBvciBhdXRvXG4gICAgICBjb25maWd1cmF0aW9uIGZvciBkZXZlbG9wbWVudC5cbiAgICBgXG4pO1xuXG5yZWxlYXNlU3RhcnRcbiAgLmNvbW1hbmQoXCJzZXJ2ZXJcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgU3RhcnRzIHVwIHRoZSBhcHAgc2VydmVyIHdpdGhvdXQgYW55IGFkZGl0aW9uYWwgYnVpbGRzIGV0Yy4gVXNlIHRoZVxuICAgICAgZW52aXJvbm1lbnRzOlxuXG4gICAgICAgIEJVSUxEX01PREU6IFRhcmdldHMgYW4gZW52IHRvIHJ1biB0aGUgc2VydmVyIGZvci5cbiAgICAgICAgUkVTT1VSQ0VfUEFUSDogVGhlIHBhdGggdG8gdGhlIHN0YXRpYyBmaWxlcyB0byBzZXJ2ZS5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLXN0YXJ0LXNlcnZlci5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLXN0YXJ0LXNlcnZlciBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcXG5cIixcbiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5wcm9ncmFtXG4gIC5jb21tYW5kKFwic3RhcnQgW3RhcmdldF1cIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgVGhpcyBmaXJlcyB1cCBhIHNlcnZlciB0byBtYWtlIGFueSBzdGF0aWMgY29udGVudCBhdmFpbGFibGUgZm9yIGJlaW5nXG4gICAgICBzZXJ2ZWQuXG4gICAgICBUaGVyZSBhcmUgYSBmZXcgb3B0aW9ucyBmb3Igd2hhdCBjb250ZW50IHdpbGwgYmUgc2VydmVkIGJ5IHRoaXMgc2NyaXB0OlxuXG4gICAgICAtIFRoZSB3ZWIgYXBwXG4gICAgICAtIERldm9wcyBBUElcblxuICAgICAgVGhlIHN0YXJ0IHNjcmlwdCB3aWxsIGF1dG9tYXRpY2FsbHkgcGljayB0aGUgd2ViIGFwcCBvdmVyIHRoZSBkZXZvcHNcbiAgICAgIGZpbGVzLCBidXQgeW91IGNhbiBzcGVjaWZ5IGEgdGFyZ2V0IGlmIHlvdSBoYXZlIGEgZGV2b3BzIEFQSSBhbmQgYSB3ZWJcbiAgICAgIGFwcDpcblxuICAgICAgLSBhcHBcbiAgICAgIC0gZGV2b3BzXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHRhcmdldDogc3RyaW5nKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvc3RhcnQuanNcIikpXG4gICAgICAuZGVmYXVsdCh0YXJnZXQsIGdldE9wdGlvbnMoKSlcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJzdGFydCBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHRlc3QgPSBwcm9ncmFtLmNvbW1hbmQoXCJ0ZXN0XCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBUaGVzZSBjb21tYW5kcyBhcmUgdXNlZCBmb3IgcnVubmluZyB0ZXN0cy4gVGhpcyBpbmNsdWRlcyB0b29scyBmb3JcbiAgICBydW5uaW5nIHVuaXQgdGVzdHMgYSBzaW5nbGUgdGltZSBvciBpbiBhIHdhdGNoIG1vZGUuXG5cbiAgICBVc2UgdGhlIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3IgbW9kaWZ5aW5nIGJlaGF2aW9yOlxuXG4gICAgJHtjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiUEFUVEVSTlwiKX0gLSBUaGlzIGNhdXNlcyB0aGUgdGVzdHMgdG8gb25seSBydW4gb25cbiAgICBmaWxlcyB0aGF0IG1hdGNoIHRoZSBwYXR0ZXJuXG5cbiAgICAke2NoYWxrLnllbGxvd0JyaWdodEJvbGQoXCJMRVNTXCIpfSAtIFRoaXMgcmVtb3ZlcyB0aGUgdmVyYm9zZSBvdXRwdXQgbGlzdCBvZlxuICAgIGFsbCB0ZXN0cyByYW5cbiAgYFxuKTtcblxudGVzdFxuICAuY29tbWFuZChcInJ1blwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBSdW5zIGFsbCB1bml0IHRlc3RzIGluIHRoZSB1bml0LXRlc3QgZm9sZGVyIG9uY2UuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3Rlc3QvdGVzdC1ydW4uanNcIikpXG4gICAgICAuZGVmYXVsdCgpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwidGVzdC1ydW4gcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCBjbGVhbiA9IHByb2dyYW0uY29tbWFuZChcImNsZWFuXCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBDb21tb24gY2xlYW5pbmcgdG9vbHMgZm9yIHZhcmlvdXMgZnJhZ21lbnRzIHdpdGhpbiB0aGUgcHJvamVjdC5cbiAgYFxuKTtcblxuY2xlYW5cbiAgLmNvbW1hbmQoXCJjYWNoZVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBDbGVhbnMgb3V0IGJ1aWxkIGFuZCBjYWNoZSBmaWxlcyB0byBoZWxwIGVuc3VyZSBhIGNvbXBsZXRlIHJlYnVpbGQgdGFrZXNcbiAgICAgIHBsYWNlLlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICgpID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9jbGVhbi9jbGVhbi1jYWNoZS5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJjbGVhbi1jYWNoZSBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHRzID0gcHJvZ3JhbS5jb21tYW5kKFwidHNcIikuZGVzY3JpcHRpb24oXG4gIGRlc2NyaXB0aW9uYFxuICAgIFRoZXNlIGNvbW1hbmRzIGFyZSB1c2VkIGZvciBydW5uaW5nIHR5cGVzY3JpcHQuIFRoaXMgaW5jbHVkZXMgdG9vbHMgZm9yXG4gICAgcnVubmluZyB0eXBlc2NyaXB0IGNvbXBpbGF0aW9uIGEgc2luZ2xlIHRpbWUgb3IgaW4gYSB3YXRjaCBtb2RlLlxuICBgXG4pO1xuXG50cy5jb21tYW5kKFwicnVuXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFJ1bnMgdHlwZXNjcmlwdCBjb21waWxhdGlvbiB0byBjaGVjayBmb3IgZXJyb3JzLiBEb2VzIE5PVCBlbWl0IGZpbGVzLCB0aHVzXG4gICAgICBpcyBhIGdvb2QgbWVjaGFuaXNtIGZvciBjaGVja2luZyBhIGJ1aWxkIGJlZm9yZSBydW5uaW5nIGEgcmVsZWFzZS5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvdHMuanNcIikpLmRlZmF1bHQoXCJcIikuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUud2FybihcInRzIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH0pO1xuICB9KTtcblxuY29uc3QgcHIgPSBwcm9ncmFtXG4gIC5jb21tYW5kKFwicHJcIilcbiAgLm9wdGlvbihcbiAgICBcIi0tcmVwb1VybCA8dmFsdWU+XCIsXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBUaGUgaHR0cHMgVVJMIHRvIHRoZSByZXBvIHRvIG1ha2UgdGhlIFBSIGludG9cbiAgICBgXG4gIClcbiAgLm9wdGlvbihcbiAgICBcIi0tcmVwb1R5cGUgPHZhbHVlPlwiLFxuICAgIGRlc2NyaXB0aW9uYFxuICAgIFRoZSByZXBvc2l0b3J5IHR5cGUgdG8gbWFrZSB0aGUgUFIgaW50by4gU3VwcG9ydGVkIHR5cGVzIGFyZTogZ2l0LCBnaXRsYWJcbiAgYFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLW1hc3RlckJyYW5jaCA8dmFsdWU+XCIsXG4gICAgZGVzY3JpcHRpb25gXG4gICAgVGhpcyBpbmRpY2F0ZXMgd2hpY2ggYnJhbmNoIGlzIHRoZSBtYXN0ZXIvbWFpbiBvZiB0aGUgcmVwb3NpdG9yeS5cbiAgYFxuICApO1xuXG5wci5jb21tYW5kKFwicmVsZWFzZVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBUaGlzIGNyZWF0ZXMgdHdvIFBScyB0aGF0IG1lcmdlcyB0aGUgY3VycmVudCByZW1vdGUgcmVsZWFzZSBicmFuY2ggaW50b1xuICAgICAgdGhlIHJlbW90ZSBkZXYgYW5kIG1hc3RlciBicmFuY2hlcy5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXBvVXJsLCByZXBvVHlwZSwgbWFzdGVyQnJhbmNoIH0gPSB5YXJncyhwcm9jZXNzLmFyZ3YpLmFyZ3YgYXMge1xuICAgICAgcmVwb1R5cGU/OiBzdHJpbmc7XG4gICAgICByZXBvVXJsPzogc3RyaW5nO1xuICAgICAgbWFzdGVyQnJhbmNoPzogc3RyaW5nO1xuICAgIH07XG5cbiAgICBpZiAoIXJlcG9VcmwgfHwgIXJlcG9UeXBlIHx8ICFtYXN0ZXJCcmFuY2gpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJZb3UgbXVzdCBzcGVjaWZ5IGJvdGggLS1yZXBvVXJsIGFuZCAtLXJlcG9UeXBlIHRvIHVzZSB0aGlzIGNvbW1hbmRcIlxuICAgICAgKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG5cbiAgICAvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhbnkgcmVxdWlyZWQgcGVlciBkZXBlbmRlbmNpZXMgZm9yIHRoaXNcbiAgICBhd2FpdCBlbnN1cmVEZXBlbmRlbmNpZXMoKS5jYXRjaCgoKSA9PiBwcm9jZXNzLmV4aXQoMSkpO1xuICAgIGNvbnNvbGUud2FybihcIkRlcGVuZGVuY3kgY2hlY2tzIHBhc3NlZCwgY29udGludWluZy4uLlwiKTtcblxuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3ByL3ByLXJlbGVhc2UuanNcIikpXG4gICAgICAuZGVmYXVsdChyZXBvVXJsLCByZXBvVHlwZSwgbWFzdGVyQnJhbmNoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcInByLXJlbGVhc2UgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5hc3luYyBmdW5jdGlvbiBydW4oKSB7XG4gIC8vIExvYWQgaW4gZW52aXJvbm1lbnQgZnJvbSBlbnYgZmlsZSBhbmQgYWxzbyBlbnN1cmUgY29uZmlndXJhdGlvbiBtYXRjaGVzIHRoZVxuICAvLyBlbnZpcm9ubWVudCBjb25maWd1cmF0aW9uIHNwZWNpZmllZCBpbiBlbnYuY29uZmlnLnRzXG4gIGF3YWl0IGNvbmZpZ0Vudihwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpO1xuICBwcm9ncmFtLnBhcnNlKHByb2Nlc3MuYXJndik7XG59XG5cbnJ1bigpO1xuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IGlucXVpcmVyIGZyb20gXCJpbnF1aXJlclwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGV4ZWNJbnN0YWxsIH0gZnJvbSBcIi4uL2xpYi9leGVjL2V4ZWMtaW5zdGFsbC5qc1wiO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiLi4vbGliL2V4ZWMvZXhlYy1zeW5jLmpzXCI7XG5pbXBvcnQgeyBmdXp6eVNvdXJjZSB9IGZyb20gXCIuLi9saWIvdXRpbC9mdXp6eS1zb3VyY2UuanNcIjtcbmltcG9ydCB7IGdldFBhY2thZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uL2xpYi9leGVjL2dldC1wYWNrYWdlLW1hbmFnZXIuanNcIjtcbmltcG9ydCB7IGlzUGFja2FnZUF2YWlsYWJsZSB9IGZyb20gXCIuLi9saWIvdXRpbC9pcy1wYWNrYWdlLWF2YWlsYWJsZS5qc1wiO1xuaW1wb3J0IHsgd2FpdCB9IGZyb20gXCIuLi9saWIvdXRpbC93YWl0LmpzXCI7XG5cbmV4cG9ydCBlbnVtIERlcGVuZGVuY3lSZXNvbHV0aW9uIHtcbiAgSW5zdGFsbCA9IFwiSW5zdGFsbCB0byBjdXJyZW50IHByb2plY3RcIixcbiAgSW5zdGFsbE9uY2UgPSBcIkluc3RhbGwgb25jZSB0byBjdXJyZW50IHByb2plY3RcIixcbiAgSW5zdGFsbEFib3ZlID0gXCJJbnN0YWxsIGluIHBhcmVudCBkaXJlY3RvcnkgKE1ha2VzIHBhY2thZ2UgYXZhaWxhYmxlIHRvIGFsbCBwZWVyIHByb2plY3RzKVwiLFxuICBEb05vdGhpbmcgPSBcIkRvIE5vdGhpbmcgKHRoaXMgd2lsbCBlbmQgdGhpcyBjdXJyZW50IHByb2Nlc3MgYXMgdGhlIHBhY2thZ2UgaXMgcmVxdWlyZWQpXCIsXG59XG5cbi8qKlxuICogVGhpcyBjaGVja3MgdGhlIHRhcmdldCBwcm9qZWN0IGZvciB0aGUgcHJlc2VuY2Ugb2YgZGVwZW5kZW5jaWVzIHRoYXQgYXJlXG4gKiByZXF1aXJlZCBidXQgYXJlIGRldHJpbWVudGFsIHRvIGV4cGVyaWVuY2UgYW5kIHBlcmZvcm1hbmNlIHRvIGluY2x1ZGUgYXMgYVxuICogZGVwZW5kZW5jeSBvZiB0aGUgcGFja2FnZSBkaXJlY3RseS5cbiAqXG4gKiBBbiBleGFtcGxlIG9mIHN1Y2ggZGVwZW5kZW5jeSB3b3VsZCBiZSBwdXBwZXRlZXIgYXMgaGF2aW5nIGl0IGNhbiB0cmlnZ2VyXG4gKiBmdWxsIGluc3RhbGxzIGFuZCBjb21waWxhdGlvbiBvZiB0aGUgZGVwZW5kZW5jeSBwZXIgcHJvamVjdCB0aGF0IG5lZWRzIGl0LlxuICpcbiAqIFNvLCB0aGlzIHdpbGwgcmVxdWVzdCB0aGUgZGVwZW5kZW5jeSB0byBiZSBpbnN0YWxsZWQgYXMgYSBvbmUgdGltZSB0byB0aGVcbiAqIGN1cnJlbnQgcHJvamVjdCBvciByZXF1ZXN0IHRvIGJlIGluc3RhbGxlZCBhYm92ZSB0aGUgdGFyZ2V0IHByb2plY3QgdG8gY2F1c2VcbiAqIGl0IHRvIGJlIGF2YWlsYWJsZSB0byBwZWVyIHByb2plY3RzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGVwZW5kZW5jaWVzKFxuICBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXSxcbiAgZm9yY2VSZXNvbHV0aW9uPzogRGVwZW5kZW5jeVJlc29sdXRpb25cbikge1xuICBjb25zdCByZXF1aXJlZERlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcyB8fCBbXCJwdXBwZXRlZXJcIl07XG5cbiAgZm9yIChjb25zdCBkZXBlbmRlbmN5IG9mIHJlcXVpcmVkRGVwZW5kZW5jaWVzKSB7XG4gICAgY29uc29sZS53YXJuKFwiQ2hlY2tpbmcgb24gZGVwZW5kZW5jeSBhdmFpbGFiaWxpdHk6XCIsIGRlcGVuZGVuY3kpO1xuICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgaXNQYWNrYWdlQXZhaWxhYmxlKGRlcGVuZGVuY3kpO1xuXG4gICAgaWYgKCFpc0F2YWlsYWJsZSkge1xuICAgICAgbGV0IHJlc29sdXRpb24gPSBmb3JjZVJlc29sdXRpb247XG5cbiAgICAgIGlmICghcmVzb2x1dGlvbikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBpbnF1aXJlci5wcm9tcHQ8e1xuICAgICAgICAgIHJlc29sdXRpb246IERlcGVuZGVuY3lSZXNvbHV0aW9uO1xuICAgICAgICB9PihbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogXCJhdXRvY29tcGxldGVcIixcbiAgICAgICAgICAgIG5hbWU6IFwicmVzb2x1dGlvblwiLFxuICAgICAgICAgICAgbWVzc2FnZTogYEhvdyBkbyB5b3Ugd2FudCB0byByZXNvbHZlIHRoZSBtaXNzaW5nIHBhY2thZ2UgXCIke2RlcGVuZGVuY3l9XCI6YCxcbiAgICAgICAgICAgIHNvdXJjZTogZnV6enlTb3VyY2UoW1xuICAgICAgICAgICAgICBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsT25jZSxcbiAgICAgICAgICAgICAgRGVwZW5kZW5jeVJlc29sdXRpb24uSW5zdGFsbEFib3ZlLFxuICAgICAgICAgICAgICBEZXBlbmRlbmN5UmVzb2x1dGlvbi5Eb05vdGhpbmcsXG4gICAgICAgICAgICBdKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKTtcblxuICAgICAgICByZXNvbHV0aW9uID0gcmVzdWx0LnJlc29sdXRpb247XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAocmVzb2x1dGlvbikge1xuICAgICAgICBjYXNlIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGw6XG4gICAgICAgICAgYXdhaXQgZXhlY0luc3RhbGwoW2RlcGVuZGVuY3ldLCBcIkVcIik7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsT25jZTpcbiAgICAgICAgICBleGVjSW5zdGFsbChbZGVwZW5kZW5jeV0sIFwiRVwiLCB0cnVlKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGxBYm92ZToge1xuICAgICAgICAgIC8vIFNhdmUgdGhlIGN1cnJlbnQgY3dkXG4gICAgICAgICAgY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKTtcbiAgICAgICAgICAvLyBDaGFuZ2UgZGlyZWN0b3J5IHRvIHRoZSBwYXJlbnQgZGlyZWN0b3J5LlxuICAgICAgICAgIHByb2Nlc3MuY2hkaXIoXCIuLlwiKTtcbiAgICAgICAgICBjb25zdCBwYWNrYWdlTWFuYWdlciA9IGF3YWl0IGdldFBhY2thZ2VNYW5hZ2VyKCk7XG5cbiAgICAgICAgICAvLyBDaGVjayBmb3IgYSBwYWNrYWdlLmpzb25cbiAgICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKSkge1xuICAgICAgICAgICAgLy8gUGVyZm9ybSBhbiBpbml0IHRvIG1ha2UgdGhlIHBhY2thZ2VcbiAgICAgICAgICAgIGV4ZWNTeW5jKHBhY2thZ2VNYW5hZ2VyWzBdLCBbXCJpbml0XCIsIFwiLXlcIl0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEluc3RhbGwgdGhlIGRlcGVuZGVuY3lcbiAgICAgICAgICBhd2FpdCBleGVjSW5zdGFsbChbZGVwZW5kZW5jeV0sIFwiRVwiKTtcbiAgICAgICAgICAvLyBSZXR1cm4gdG8gb3JpZ2luYWwgY3dkXG4gICAgICAgICAgcHJvY2Vzcy5jaGRpcihjd2QpO1xuICAgICAgICAgIC8vIFBlcmZvcm0gYW4gYXdhaXQgdG8gbGV0IGZpbGUgc3lzdGVtIGZsdXNoXG4gICAgICAgICAgYXdhaXQgd2FpdCgxMDApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLAogICJpbXBvcnQgeyBleGVjU3luYyB9IGZyb20gXCIuL2V4ZWMtc3luYy5qc1wiO1xuaW1wb3J0IHsgZ2V0UGFja2FnZU1hbmFnZXIgfSBmcm9tIFwiLi9nZXQtcGFja2FnZS1tYW5hZ2VyLmpzXCI7XG5pbXBvcnQgeyBpc0RlZmluZWQgfSBmcm9tIFwiLi4vdXRpbC90eXBlcy5qc1wiO1xuXG4vKipcbiAqIEV4ZWN1dGVzIGFuIGBucG0gaW5zdGFsbCBbcGFja2FnZXMuLi5dYCBpbiB0aGUgY3VycmVudCBjb250ZXh0LlxuICpcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY29tbWFuZCBzdWNjZWVkZWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleGVjSW5zdGFsbChcbiAgcGFja2FnZXM6IHN0cmluZ1tdLFxuICBtb2RlPzogXCJEXCIgfCBcIkRFXCIgfCBcIkVcIixcbiAgbm9TYXZlPzogYm9vbGVhblxuKSB7XG4gIGNvbnN0IG1hbmFnZXIgPSBhd2FpdCBnZXRQYWNrYWdlTWFuYWdlcigpO1xuICBjb25zdCB0b0luc3RhbGwgPSBwYWNrYWdlcy5maWx0ZXIoaXNEZWZpbmVkKTtcblxuICByZXR1cm4gYXdhaXQgZXhlY1N5bmMobWFuYWdlclswXSwgW1xuICAgIFwiaVwiLFxuICAgIG5vU2F2ZSA/IFwiLS1uby1zYXZlXCIgOiBudWxsLFxuICAgIG1vZGUgPyBgLSR7bW9kZX1gIDogbnVsbCxcbiAgICAuLi50b0luc3RhbGwsXG4gIF0pO1xufVxuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IGlucXVpcmVyIGZyb20gXCJpbnF1aXJlclwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGV4ZWNJbnN0YWxsIH0gZnJvbSBcIi4uL2xpYi9leGVjL2V4ZWMtaW5zdGFsbC5qc1wiO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiLi4vbGliL2V4ZWMvZXhlYy1zeW5jLmpzXCI7XG5pbXBvcnQgeyBmdXp6eVNvdXJjZSB9IGZyb20gXCIuLi9saWIvdXRpbC9mdXp6eS1zb3VyY2UuanNcIjtcbmltcG9ydCB7IGdldFBhY2thZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uL2xpYi9leGVjL2dldC1wYWNrYWdlLW1hbmFnZXIuanNcIjtcbmltcG9ydCB7IGlzUGFja2FnZUF2YWlsYWJsZSB9IGZyb20gXCIuLi9saWIvdXRpbC9pcy1wYWNrYWdlLWF2YWlsYWJsZS5qc1wiO1xuaW1wb3J0IHsgd2FpdCB9IGZyb20gXCIuLi9saWIvdXRpbC93YWl0LmpzXCI7XG5cbmV4cG9ydCBlbnVtIERlcGVuZGVuY3lSZXNvbHV0aW9uIHtcbiAgSW5zdGFsbCA9IFwiSW5zdGFsbCB0byBjdXJyZW50IHByb2plY3RcIixcbiAgSW5zdGFsbE9uY2UgPSBcIkluc3RhbGwgb25jZSB0byBjdXJyZW50IHByb2plY3RcIixcbiAgSW5zdGFsbEFib3ZlID0gXCJJbnN0YWxsIGluIHBhcmVudCBkaXJlY3RvcnkgKE1ha2VzIHBhY2thZ2UgYXZhaWxhYmxlIHRvIGFsbCBwZWVyIHByb2plY3RzKVwiLFxuICBEb05vdGhpbmcgPSBcIkRvIE5vdGhpbmcgKHRoaXMgd2lsbCBlbmQgdGhpcyBjdXJyZW50IHByb2Nlc3MgYXMgdGhlIHBhY2thZ2UgaXMgcmVxdWlyZWQpXCIsXG59XG5cbi8qKlxuICogVGhpcyBjaGVja3MgdGhlIHRhcmdldCBwcm9qZWN0IGZvciB0aGUgcHJlc2VuY2Ugb2YgZGVwZW5kZW5jaWVzIHRoYXQgYXJlXG4gKiByZXF1aXJlZCBidXQgYXJlIGRldHJpbWVudGFsIHRvIGV4cGVyaWVuY2UgYW5kIHBlcmZvcm1hbmNlIHRvIGluY2x1ZGUgYXMgYVxuICogZGVwZW5kZW5jeSBvZiB0aGUgcGFja2FnZSBkaXJlY3RseS5cbiAqXG4gKiBBbiBleGFtcGxlIG9mIHN1Y2ggZGVwZW5kZW5jeSB3b3VsZCBiZSBwdXBwZXRlZXIgYXMgaGF2aW5nIGl0IGNhbiB0cmlnZ2VyXG4gKiBmdWxsIGluc3RhbGxzIGFuZCBjb21waWxhdGlvbiBvZiB0aGUgZGVwZW5kZW5jeSBwZXIgcHJvamVjdCB0aGF0IG5lZWRzIGl0LlxuICpcbiAqIFNvLCB0aGlzIHdpbGwgcmVxdWVzdCB0aGUgZGVwZW5kZW5jeSB0byBiZSBpbnN0YWxsZWQgYXMgYSBvbmUgdGltZSB0byB0aGVcbiAqIGN1cnJlbnQgcHJvamVjdCBvciByZXF1ZXN0IHRvIGJlIGluc3RhbGxlZCBhYm92ZSB0aGUgdGFyZ2V0IHByb2plY3QgdG8gY2F1c2VcbiAqIGl0IHRvIGJlIGF2YWlsYWJsZSB0byBwZWVyIHByb2plY3RzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGVwZW5kZW5jaWVzKFxuICBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXSxcbiAgZm9yY2VSZXNvbHV0aW9uPzogRGVwZW5kZW5jeVJlc29sdXRpb25cbikge1xuICBjb25zdCByZXF1aXJlZERlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcyB8fCBbXCJwdXBwZXRlZXJcIl07XG5cbiAgZm9yIChjb25zdCBkZXBlbmRlbmN5IG9mIHJlcXVpcmVkRGVwZW5kZW5jaWVzKSB7XG4gICAgY29uc29sZS53YXJuKFwiQ2hlY2tpbmcgb24gZGVwZW5kZW5jeSBhdmFpbGFiaWxpdHk6XCIsIGRlcGVuZGVuY3kpO1xuICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgaXNQYWNrYWdlQXZhaWxhYmxlKGRlcGVuZGVuY3kpO1xuXG4gICAgaWYgKCFpc0F2YWlsYWJsZSkge1xuICAgICAgbGV0IHJlc29sdXRpb24gPSBmb3JjZVJlc29sdXRpb247XG5cbiAgICAgIGlmICghcmVzb2x1dGlvbikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBpbnF1aXJlci5wcm9tcHQ8e1xuICAgICAgICAgIHJlc29sdXRpb246IERlcGVuZGVuY3lSZXNvbHV0aW9uO1xuICAgICAgICB9PihbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogXCJhdXRvY29tcGxldGVcIixcbiAgICAgICAgICAgIG5hbWU6IFwicmVzb2x1dGlvblwiLFxuICAgICAgICAgICAgbWVzc2FnZTogYEhvdyBkbyB5b3Ugd2FudCB0byByZXNvbHZlIHRoZSBtaXNzaW5nIHBhY2thZ2UgXCIke2RlcGVuZGVuY3l9XCI6YCxcbiAgICAgICAgICAgIHNvdXJjZTogZnV6enlTb3VyY2UoW1xuICAgICAgICAgICAgICBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsT25jZSxcbiAgICAgICAgICAgICAgRGVwZW5kZW5jeVJlc29sdXRpb24uSW5zdGFsbEFib3ZlLFxuICAgICAgICAgICAgICBEZXBlbmRlbmN5UmVzb2x1dGlvbi5Eb05vdGhpbmcsXG4gICAgICAgICAgICBdKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKTtcblxuICAgICAgICByZXNvbHV0aW9uID0gcmVzdWx0LnJlc29sdXRpb247XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAocmVzb2x1dGlvbikge1xuICAgICAgICBjYXNlIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGw6XG4gICAgICAgICAgYXdhaXQgZXhlY0luc3RhbGwoW2RlcGVuZGVuY3ldLCBcIkVcIik7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsT25jZTpcbiAgICAgICAgICBleGVjSW5zdGFsbChbZGVwZW5kZW5jeV0sIFwiRVwiLCB0cnVlKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGxBYm92ZToge1xuICAgICAgICAgIC8vIFNhdmUgdGhlIGN1cnJlbnQgY3dkXG4gICAgICAgICAgY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKTtcbiAgICAgICAgICAvLyBDaGFuZ2UgZGlyZWN0b3J5IHRvIHRoZSBwYXJlbnQgZGlyZWN0b3J5LlxuICAgICAgICAgIHByb2Nlc3MuY2hkaXIoXCIuLlwiKTtcbiAgICAgICAgICBjb25zdCBwYWNrYWdlTWFuYWdlciA9IGF3YWl0IGdldFBhY2thZ2VNYW5hZ2VyKCk7XG5cbiAgICAgICAgICAvLyBDaGVjayBmb3IgYSBwYWNrYWdlLmpzb25cbiAgICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKSkge1xuICAgICAgICAgICAgLy8gUGVyZm9ybSBhbiBpbml0IHRvIG1ha2UgdGhlIHBhY2thZ2VcbiAgICAgICAgICAgIGV4ZWNTeW5jKHBhY2thZ2VNYW5hZ2VyWzBdLCBbXCJpbml0XCIsIFwiLXlcIl0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEluc3RhbGwgdGhlIGRlcGVuZGVuY3lcbiAgICAgICAgICBhd2FpdCBleGVjSW5zdGFsbChbZGVwZW5kZW5jeV0sIFwiRVwiKTtcbiAgICAgICAgICAvLyBSZXR1cm4gdG8gb3JpZ2luYWwgY3dkXG4gICAgICAgICAgcHJvY2Vzcy5jaGRpcihjd2QpO1xuICAgICAgICAgIC8vIFBlcmZvcm0gYW4gYXdhaXQgdG8gbGV0IGZpbGUgc3lzdGVtIGZsdXNoXG4gICAgICAgICAgYXdhaXQgd2FpdCgxMDApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLAogICJpbXBvcnQgZnV6enkgZnJvbSBcImZ1enp5XCI7XG5cbmV4cG9ydCBjb25zdCBmdXp6eVNvdXJjZSA9XG4gIChvcHRpb25zOiBTZXQ8c3RyaW5nPiB8IHN0cmluZ1tdKSA9PiBhc3luYyAoXzogdW5rbm93biwgaW5wdXQ6IHN0cmluZykgPT4ge1xuICAgIGxldCBvcHRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgaWYgKG9wdGlvbnMgaW5zdGFuY2VvZiBTZXQpIHtcbiAgICAgIG9wdHMgPSBBcnJheS5mcm9tKG9wdGlvbnMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBvcHRzID0gb3B0aW9ucztcbiAgICB9XG5cbiAgICByZXR1cm4gZnV6enkuZmlsdGVyKGlucHV0IHx8IFwiXCIsIG9wdHMpLm1hcCgoZSkgPT4gZS5zdHJpbmcpO1xuICB9O1xuIiwKICAiaW1wb3J0IGZzIGZyb20gXCJmcy1leHRyYVwiO1xuaW1wb3J0IGlucXVpcmVyIGZyb20gXCJpbnF1aXJlclwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB7IGV4ZWNJbnN0YWxsIH0gZnJvbSBcIi4uL2xpYi9leGVjL2V4ZWMtaW5zdGFsbC5qc1wiO1xuaW1wb3J0IHsgZXhlY1N5bmMgfSBmcm9tIFwiLi4vbGliL2V4ZWMvZXhlYy1zeW5jLmpzXCI7XG5pbXBvcnQgeyBmdXp6eVNvdXJjZSB9IGZyb20gXCIuLi9saWIvdXRpbC9mdXp6eS1zb3VyY2UuanNcIjtcbmltcG9ydCB7IGdldFBhY2thZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uL2xpYi9leGVjL2dldC1wYWNrYWdlLW1hbmFnZXIuanNcIjtcbmltcG9ydCB7IGlzUGFja2FnZUF2YWlsYWJsZSB9IGZyb20gXCIuLi9saWIvdXRpbC9pcy1wYWNrYWdlLWF2YWlsYWJsZS5qc1wiO1xuaW1wb3J0IHsgd2FpdCB9IGZyb20gXCIuLi9saWIvdXRpbC93YWl0LmpzXCI7XG5cbmV4cG9ydCBlbnVtIERlcGVuZGVuY3lSZXNvbHV0aW9uIHtcbiAgSW5zdGFsbCA9IFwiSW5zdGFsbCB0byBjdXJyZW50IHByb2plY3RcIixcbiAgSW5zdGFsbE9uY2UgPSBcIkluc3RhbGwgb25jZSB0byBjdXJyZW50IHByb2plY3RcIixcbiAgSW5zdGFsbEFib3ZlID0gXCJJbnN0YWxsIGluIHBhcmVudCBkaXJlY3RvcnkgKE1ha2VzIHBhY2thZ2UgYXZhaWxhYmxlIHRvIGFsbCBwZWVyIHByb2plY3RzKVwiLFxuICBEb05vdGhpbmcgPSBcIkRvIE5vdGhpbmcgKHRoaXMgd2lsbCBlbmQgdGhpcyBjdXJyZW50IHByb2Nlc3MgYXMgdGhlIHBhY2thZ2UgaXMgcmVxdWlyZWQpXCIsXG59XG5cbi8qKlxuICogVGhpcyBjaGVja3MgdGhlIHRhcmdldCBwcm9qZWN0IGZvciB0aGUgcHJlc2VuY2Ugb2YgZGVwZW5kZW5jaWVzIHRoYXQgYXJlXG4gKiByZXF1aXJlZCBidXQgYXJlIGRldHJpbWVudGFsIHRvIGV4cGVyaWVuY2UgYW5kIHBlcmZvcm1hbmNlIHRvIGluY2x1ZGUgYXMgYVxuICogZGVwZW5kZW5jeSBvZiB0aGUgcGFja2FnZSBkaXJlY3RseS5cbiAqXG4gKiBBbiBleGFtcGxlIG9mIHN1Y2ggZGVwZW5kZW5jeSB3b3VsZCBiZSBwdXBwZXRlZXIgYXMgaGF2aW5nIGl0IGNhbiB0cmlnZ2VyXG4gKiBmdWxsIGluc3RhbGxzIGFuZCBjb21waWxhdGlvbiBvZiB0aGUgZGVwZW5kZW5jeSBwZXIgcHJvamVjdCB0aGF0IG5lZWRzIGl0LlxuICpcbiAqIFNvLCB0aGlzIHdpbGwgcmVxdWVzdCB0aGUgZGVwZW5kZW5jeSB0byBiZSBpbnN0YWxsZWQgYXMgYSBvbmUgdGltZSB0byB0aGVcbiAqIGN1cnJlbnQgcHJvamVjdCBvciByZXF1ZXN0IHRvIGJlIGluc3RhbGxlZCBhYm92ZSB0aGUgdGFyZ2V0IHByb2plY3QgdG8gY2F1c2VcbiAqIGl0IHRvIGJlIGF2YWlsYWJsZSB0byBwZWVyIHByb2plY3RzLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5zdXJlRGVwZW5kZW5jaWVzKFxuICBkZXBlbmRlbmNpZXM/OiBzdHJpbmdbXSxcbiAgZm9yY2VSZXNvbHV0aW9uPzogRGVwZW5kZW5jeVJlc29sdXRpb25cbikge1xuICBjb25zdCByZXF1aXJlZERlcGVuZGVuY2llcyA9IGRlcGVuZGVuY2llcyB8fCBbXCJwdXBwZXRlZXJcIl07XG5cbiAgZm9yIChjb25zdCBkZXBlbmRlbmN5IG9mIHJlcXVpcmVkRGVwZW5kZW5jaWVzKSB7XG4gICAgY29uc29sZS53YXJuKFwiQ2hlY2tpbmcgb24gZGVwZW5kZW5jeSBhdmFpbGFiaWxpdHk6XCIsIGRlcGVuZGVuY3kpO1xuICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgaXNQYWNrYWdlQXZhaWxhYmxlKGRlcGVuZGVuY3kpO1xuXG4gICAgaWYgKCFpc0F2YWlsYWJsZSkge1xuICAgICAgbGV0IHJlc29sdXRpb24gPSBmb3JjZVJlc29sdXRpb247XG5cbiAgICAgIGlmICghcmVzb2x1dGlvbikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBpbnF1aXJlci5wcm9tcHQ8e1xuICAgICAgICAgIHJlc29sdXRpb246IERlcGVuZGVuY3lSZXNvbHV0aW9uO1xuICAgICAgICB9PihbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdHlwZTogXCJhdXRvY29tcGxldGVcIixcbiAgICAgICAgICAgIG5hbWU6IFwicmVzb2x1dGlvblwiLFxuICAgICAgICAgICAgbWVzc2FnZTogYEhvdyBkbyB5b3Ugd2FudCB0byByZXNvbHZlIHRoZSBtaXNzaW5nIHBhY2thZ2UgXCIke2RlcGVuZGVuY3l9XCI6YCxcbiAgICAgICAgICAgIHNvdXJjZTogZnV6enlTb3VyY2UoW1xuICAgICAgICAgICAgICBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsT25jZSxcbiAgICAgICAgICAgICAgRGVwZW5kZW5jeVJlc29sdXRpb24uSW5zdGFsbEFib3ZlLFxuICAgICAgICAgICAgICBEZXBlbmRlbmN5UmVzb2x1dGlvbi5Eb05vdGhpbmcsXG4gICAgICAgICAgICBdKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKTtcblxuICAgICAgICByZXNvbHV0aW9uID0gcmVzdWx0LnJlc29sdXRpb247XG4gICAgICB9XG5cbiAgICAgIHN3aXRjaCAocmVzb2x1dGlvbikge1xuICAgICAgICBjYXNlIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGw6XG4gICAgICAgICAgYXdhaXQgZXhlY0luc3RhbGwoW2RlcGVuZGVuY3ldLCBcIkVcIik7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsT25jZTpcbiAgICAgICAgICBleGVjSW5zdGFsbChbZGVwZW5kZW5jeV0sIFwiRVwiLCB0cnVlKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGxBYm92ZToge1xuICAgICAgICAgIC8vIFNhdmUgdGhlIGN1cnJlbnQgY3dkXG4gICAgICAgICAgY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKTtcbiAgICAgICAgICAvLyBDaGFuZ2UgZGlyZWN0b3J5IHRvIHRoZSBwYXJlbnQgZGlyZWN0b3J5LlxuICAgICAgICAgIHByb2Nlc3MuY2hkaXIoXCIuLlwiKTtcbiAgICAgICAgICBjb25zdCBwYWNrYWdlTWFuYWdlciA9IGF3YWl0IGdldFBhY2thZ2VNYW5hZ2VyKCk7XG5cbiAgICAgICAgICAvLyBDaGVjayBmb3IgYSBwYWNrYWdlLmpzb25cbiAgICAgICAgICBpZiAoIWZzLmV4aXN0c1N5bmMocGF0aC5yZXNvbHZlKFwicGFja2FnZS5qc29uXCIpKSkge1xuICAgICAgICAgICAgLy8gUGVyZm9ybSBhbiBpbml0IHRvIG1ha2UgdGhlIHBhY2thZ2VcbiAgICAgICAgICAgIGV4ZWNTeW5jKHBhY2thZ2VNYW5hZ2VyWzBdLCBbXCJpbml0XCIsIFwiLXlcIl0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIEluc3RhbGwgdGhlIGRlcGVuZGVuY3lcbiAgICAgICAgICBhd2FpdCBleGVjSW5zdGFsbChbZGVwZW5kZW5jeV0sIFwiRVwiKTtcbiAgICAgICAgICAvLyBSZXR1cm4gdG8gb3JpZ2luYWwgY3dkXG4gICAgICAgICAgcHJvY2Vzcy5jaGRpcihjd2QpO1xuICAgICAgICAgIC8vIFBlcmZvcm0gYW4gYXdhaXQgdG8gbGV0IGZpbGUgc3lzdGVtIGZsdXNoXG4gICAgICAgICAgYXdhaXQgd2FpdCgxMDApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLAogICIvKipcbiAqIENoZWNrcyBpZiB0aGUgcmVxdWVzdGVkIHBhY2thZ2UgaXMgYXZhaWxhYmxlIHRvIHRoZSB0YXJnZXQgcHJvamVjdC5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGlzUGFja2FnZUF2YWlsYWJsZShwYWNrYWdlTmFtZTogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgaW1wb3J0KHBhY2thZ2VOYW1lKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5lcnJvcihcbiAgICAgIFwiUmVxdWVzdGVkIHBhY2thZ2UgaXMgbm90IGF2YWlsYWJsZSBpbiB0aGlzIGN1cnJlbnQgcHJvamVjdDpcIixcbiAgICAgIHBhY2thZ2VOYW1lXG4gICAgKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsCiAgImltcG9ydCBmcyBmcm9tIFwiZnMtZXh0cmFcIjtcbmltcG9ydCBpbnF1aXJlciBmcm9tIFwiaW5xdWlyZXJcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgeyBleGVjSW5zdGFsbCB9IGZyb20gXCIuLi9saWIvZXhlYy9leGVjLWluc3RhbGwuanNcIjtcbmltcG9ydCB7IGV4ZWNTeW5jIH0gZnJvbSBcIi4uL2xpYi9leGVjL2V4ZWMtc3luYy5qc1wiO1xuaW1wb3J0IHsgZnV6enlTb3VyY2UgfSBmcm9tIFwiLi4vbGliL3V0aWwvZnV6enktc291cmNlLmpzXCI7XG5pbXBvcnQgeyBnZXRQYWNrYWdlTWFuYWdlciB9IGZyb20gXCIuLi9saWIvZXhlYy9nZXQtcGFja2FnZS1tYW5hZ2VyLmpzXCI7XG5pbXBvcnQgeyBpc1BhY2thZ2VBdmFpbGFibGUgfSBmcm9tIFwiLi4vbGliL3V0aWwvaXMtcGFja2FnZS1hdmFpbGFibGUuanNcIjtcbmltcG9ydCB7IHdhaXQgfSBmcm9tIFwiLi4vbGliL3V0aWwvd2FpdC5qc1wiO1xuXG5leHBvcnQgZW51bSBEZXBlbmRlbmN5UmVzb2x1dGlvbiB7XG4gIEluc3RhbGwgPSBcIkluc3RhbGwgdG8gY3VycmVudCBwcm9qZWN0XCIsXG4gIEluc3RhbGxPbmNlID0gXCJJbnN0YWxsIG9uY2UgdG8gY3VycmVudCBwcm9qZWN0XCIsXG4gIEluc3RhbGxBYm92ZSA9IFwiSW5zdGFsbCBpbiBwYXJlbnQgZGlyZWN0b3J5IChNYWtlcyBwYWNrYWdlIGF2YWlsYWJsZSB0byBhbGwgcGVlciBwcm9qZWN0cylcIixcbiAgRG9Ob3RoaW5nID0gXCJEbyBOb3RoaW5nICh0aGlzIHdpbGwgZW5kIHRoaXMgY3VycmVudCBwcm9jZXNzIGFzIHRoZSBwYWNrYWdlIGlzIHJlcXVpcmVkKVwiLFxufVxuXG4vKipcbiAqIFRoaXMgY2hlY2tzIHRoZSB0YXJnZXQgcHJvamVjdCBmb3IgdGhlIHByZXNlbmNlIG9mIGRlcGVuZGVuY2llcyB0aGF0IGFyZVxuICogcmVxdWlyZWQgYnV0IGFyZSBkZXRyaW1lbnRhbCB0byBleHBlcmllbmNlIGFuZCBwZXJmb3JtYW5jZSB0byBpbmNsdWRlIGFzIGFcbiAqIGRlcGVuZGVuY3kgb2YgdGhlIHBhY2thZ2UgZGlyZWN0bHkuXG4gKlxuICogQW4gZXhhbXBsZSBvZiBzdWNoIGRlcGVuZGVuY3kgd291bGQgYmUgcHVwcGV0ZWVyIGFzIGhhdmluZyBpdCBjYW4gdHJpZ2dlclxuICogZnVsbCBpbnN0YWxscyBhbmQgY29tcGlsYXRpb24gb2YgdGhlIGRlcGVuZGVuY3kgcGVyIHByb2plY3QgdGhhdCBuZWVkcyBpdC5cbiAqXG4gKiBTbywgdGhpcyB3aWxsIHJlcXVlc3QgdGhlIGRlcGVuZGVuY3kgdG8gYmUgaW5zdGFsbGVkIGFzIGEgb25lIHRpbWUgdG8gdGhlXG4gKiBjdXJyZW50IHByb2plY3Qgb3IgcmVxdWVzdCB0byBiZSBpbnN0YWxsZWQgYWJvdmUgdGhlIHRhcmdldCBwcm9qZWN0IHRvIGNhdXNlXG4gKiBpdCB0byBiZSBhdmFpbGFibGUgdG8gcGVlciBwcm9qZWN0cy5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZURlcGVuZGVuY2llcyhcbiAgZGVwZW5kZW5jaWVzPzogc3RyaW5nW10sXG4gIGZvcmNlUmVzb2x1dGlvbj86IERlcGVuZGVuY3lSZXNvbHV0aW9uXG4pIHtcbiAgY29uc3QgcmVxdWlyZWREZXBlbmRlbmNpZXMgPSBkZXBlbmRlbmNpZXMgfHwgW1wicHVwcGV0ZWVyXCJdO1xuXG4gIGZvciAoY29uc3QgZGVwZW5kZW5jeSBvZiByZXF1aXJlZERlcGVuZGVuY2llcykge1xuICAgIGNvbnNvbGUud2FybihcIkNoZWNraW5nIG9uIGRlcGVuZGVuY3kgYXZhaWxhYmlsaXR5OlwiLCBkZXBlbmRlbmN5KTtcbiAgICBjb25zdCBpc0F2YWlsYWJsZSA9IGF3YWl0IGlzUGFja2FnZUF2YWlsYWJsZShkZXBlbmRlbmN5KTtcblxuICAgIGlmICghaXNBdmFpbGFibGUpIHtcbiAgICAgIGxldCByZXNvbHV0aW9uID0gZm9yY2VSZXNvbHV0aW9uO1xuXG4gICAgICBpZiAoIXJlc29sdXRpb24pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaW5xdWlyZXIucHJvbXB0PHtcbiAgICAgICAgICByZXNvbHV0aW9uOiBEZXBlbmRlbmN5UmVzb2x1dGlvbjtcbiAgICAgICAgfT4oW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6IFwiYXV0b2NvbXBsZXRlXCIsXG4gICAgICAgICAgICBuYW1lOiBcInJlc29sdXRpb25cIixcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBIb3cgZG8geW91IHdhbnQgdG8gcmVzb2x2ZSB0aGUgbWlzc2luZyBwYWNrYWdlIFwiJHtkZXBlbmRlbmN5fVwiOmAsXG4gICAgICAgICAgICBzb3VyY2U6IGZ1enp5U291cmNlKFtcbiAgICAgICAgICAgICAgRGVwZW5kZW5jeVJlc29sdXRpb24uSW5zdGFsbE9uY2UsXG4gICAgICAgICAgICAgIERlcGVuZGVuY3lSZXNvbHV0aW9uLkluc3RhbGxBYm92ZSxcbiAgICAgICAgICAgICAgRGVwZW5kZW5jeVJlc29sdXRpb24uRG9Ob3RoaW5nLFxuICAgICAgICAgICAgXSksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSk7XG5cbiAgICAgICAgcmVzb2x1dGlvbiA9IHJlc3VsdC5yZXNvbHV0aW9uO1xuICAgICAgfVxuXG4gICAgICBzd2l0Y2ggKHJlc29sdXRpb24pIHtcbiAgICAgICAgY2FzZSBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsOlxuICAgICAgICAgIGF3YWl0IGV4ZWNJbnN0YWxsKFtkZXBlbmRlbmN5XSwgXCJFXCIpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgRGVwZW5kZW5jeVJlc29sdXRpb24uSW5zdGFsbE9uY2U6XG4gICAgICAgICAgZXhlY0luc3RhbGwoW2RlcGVuZGVuY3ldLCBcIkVcIiwgdHJ1ZSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBEZXBlbmRlbmN5UmVzb2x1dGlvbi5JbnN0YWxsQWJvdmU6IHtcbiAgICAgICAgICAvLyBTYXZlIHRoZSBjdXJyZW50IGN3ZFxuICAgICAgICAgIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKCk7XG4gICAgICAgICAgLy8gQ2hhbmdlIGRpcmVjdG9yeSB0byB0aGUgcGFyZW50IGRpcmVjdG9yeS5cbiAgICAgICAgICBwcm9jZXNzLmNoZGlyKFwiLi5cIik7XG4gICAgICAgICAgY29uc3QgcGFja2FnZU1hbmFnZXIgPSBhd2FpdCBnZXRQYWNrYWdlTWFuYWdlcigpO1xuXG4gICAgICAgICAgLy8gQ2hlY2sgZm9yIGEgcGFja2FnZS5qc29uXG4gICAgICAgICAgaWYgKCFmcy5leGlzdHNTeW5jKHBhdGgucmVzb2x2ZShcInBhY2thZ2UuanNvblwiKSkpIHtcbiAgICAgICAgICAgIC8vIFBlcmZvcm0gYW4gaW5pdCB0byBtYWtlIHRoZSBwYWNrYWdlXG4gICAgICAgICAgICBleGVjU3luYyhwYWNrYWdlTWFuYWdlclswXSwgW1wiaW5pdFwiLCBcIi15XCJdKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBJbnN0YWxsIHRoZSBkZXBlbmRlbmN5XG4gICAgICAgICAgYXdhaXQgZXhlY0luc3RhbGwoW2RlcGVuZGVuY3ldLCBcIkVcIik7XG4gICAgICAgICAgLy8gUmV0dXJuIHRvIG9yaWdpbmFsIGN3ZFxuICAgICAgICAgIHByb2Nlc3MuY2hkaXIoY3dkKTtcbiAgICAgICAgICAvLyBQZXJmb3JtIGFuIGF3YWl0IHRvIGxldCBmaWxlIHN5c3RlbSBmbHVzaFxuICAgICAgICAgIGF3YWl0IHdhaXQoMTAwKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwKICAiIyEvdXNyL2Jpbi9lbnYgYnVuXG5pbXBvcnQgKiBhcyBjb21tYW5kZXIgZnJvbSBcImNvbW1hbmRlclwiO1xuaW1wb3J0IEF1dG9Db21wbGV0ZVByb21wdCBmcm9tIFwiaW5xdWlyZXItYXV0b2NvbXBsZXRlLXByb21wdFwiO1xuaW1wb3J0IGlucXVpcmVyIGZyb20gXCJpbnF1aXJlclwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCB5YXJncyBmcm9tIFwieWFyZ3NcIjtcbmltcG9ydCB7IGNoYWxrIH0gZnJvbSBcIi4vbGliL3V0aWwvY2hhbGsuanNcIjtcbmltcG9ydCB7IGNvbmZpZ0VudiB9IGZyb20gXCIuL2xpYi91dGlsL2NvbmZpZy1lbnYuanNcIjtcbmltcG9ydCB7IGRlc2NyaXB0aW9uIH0gZnJvbSBcIi4vbGliL3V0aWwvZGVzY3JpcHRpb24uanNcIjtcbmltcG9ydCB7IGVuc3VyZURlcGVuZGVuY2llcyB9IGZyb20gXCIuL2NvbW1hbmRzL2Vuc3VyZS1kZXBlbmRlbmNpZXMuanNcIjtcbmltcG9ydCB7IGV4ZWNJbnN0YWxsIH0gZnJvbSBcIi4vbGliL2V4ZWMvZXhlYy1pbnN0YWxsLmpzXCI7XG5cbmlucXVpcmVyLnJlZ2lzdGVyUHJvbXB0KFwiYXV0b2NvbXBsZXRlXCIsIEF1dG9Db21wbGV0ZVByb21wdCk7XG5cbmNvbnN0IHsgQ29tbWFuZCB9ID0gY29tbWFuZGVyO1xuY29uc3QgcHJvZ3JhbTogYW55ID0gbmV3IENvbW1hbmQoKTtcbmNvbnN0IG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcblxuZnVuY3Rpb24gZ2V0T3B0aW9ucygpIHtcbiAgb3B0aW9ucy5kZWJ1ZyA9IHByb2dyYW0uZGVidWc7XG4gIG9wdGlvbnMudmVyYm9zZSA9IHByb2dyYW0udmVyYm9zZTtcbiAgb3B0aW9ucy5wYXR0ZXJuID0gcHJvZ3JhbS5wYXR0ZXJuO1xuXG4gIHJldHVybiBvcHRpb25zO1xufVxuXG5wcm9ncmFtLnZlcnNpb24oXCIwLjAuMVwiKTtcbnByb2dyYW0ub3B0aW9uKFxuICBcIi12LCAtLXZlcmJvc2VcIixcbiAgXCJPdXRwdXRzIG1vcmUgZGV0YWlsZWQgaW5mb3JtYXRpb24gZHVyaW5nIGNyYXNoZXMuXCJcbik7XG5wcm9ncmFtLm9wdGlvbihcbiAgXCItLWRlYnVnIFtwYXJhbV1cIixcbiAgZGVzY3JpcHRpb25gXG4gICAgUHJvdmlkZXMgZGVidWdnaW5nIGNvbnRleHR1YWwgaW5mb3JtYXRpb24gdmFyaW91cyBjb21tYW5kcyBtaWdodCB1c2UgdG9cbiAgICBhaWQgaW4gZGV2ZWxvcGluZyBEZXZvcHMuXG4gIGBcbik7XG5cbnByb2dyYW0ub3B0aW9uKFxuICBcIi1wLCAtLXBhdHRlcm4gW3BhcmFtXVwiLFxuICBkZXNjcmlwdGlvbmBcbiAgICBQcm92aWRlcyBhIHBhdHRlcm4gZm9yIGNlcnRhaW4gb3BlcmF0aW9ucyB0byB1dGlsaXplLiBUaGlzIGlzIHByaW1hcmlseVxuICAgIHVzZWQgYnkgdW5pdCB0ZXN0cyB0byBmaWx0ZXIgdGVzdHMgdG8gc3BlY2lmaWVkIHRlc3RzLlxuICBgXG4pO1xuXG5jb25zdCBkZXYgPSBwcm9ncmFtLmNvbW1hbmQoXCJkZXZcIikuZGVzY3JpcHRpb24oXG4gIGRlc2NyaXB0aW9uYFxuICAgIFRoZXNlIGFyZSB0aGUgY29tbWFuZHMgYXNzb2NpYXRlZCB3aXRoIHN0YXJ0aW5nIHVwIGRldmVsb3BlciBlbnZpcm9ubWVudHNcbiAgICBmb3IgdmFyaW91cyBwcm9qZWN0IHR5cGVzIG9yIHBvcnRpb25zIG9mIGEgcHJvamVjdC5cbiAgYFxuKTtcblxuZGV2XG4gIC5jb21tYW5kKFwidml0ZVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBTdGFydHMgdXAgYSBkZXZlbG9wZXIgZW52aXJvbm1lbnQgdGhhdCBwZXJmb3JtcyBpbmNyZW1lbnRhbCBidWlsZHMgd2hpbGVcbiAgICAgIGRldmVsb3Bpbmcgd2l0aGluIHRoZSBsaWIgYW5kIGFwcCBmb2xkZXJzLiBVc2VzIHZpdGUgYW5kIHZpdGVcbiAgICAgIGNvbmZpZy5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvZGV2L2Rldi12aXRlLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcImRldi12aXRlIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxuZGV2XG4gIC5jb21tYW5kKFwic3Rvcnlib29rXCIpXG4gIC5vcHRpb24oXG4gICAgXCItaSwgLS1pbmNsdWRlIDxpbmNsdWRlLi4uPlwiLFxuICAgIFwiQWRkaXRpb25hbCBzdG9yeWJvb2sgbW9kdWxlcyB0byBsb2FkIGludG8gc3Rvcnlib29rLiBUaGVzZSBhcmUgdGhlIG5hbWVzIG9mIHByb3Blcmx5IGZvcm1hdHRlZCBkZXBlbmRlbmNpZXMgaW5zdGFsbGVkIGludG8gbm9kZV9tb2R1bGVzLlwiXG4gIClcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgU3RhcnRzIGEgc3Rvcnlib29rIGluc3RhbmNlIGZvciBkZXZlbG9waW5nIHRoZSBVSSBjb21wb25lbnRzIG9mIHRoZVxuICAgICAgcHJvamVjdC4gVGhpcyBtYWtlcyB0aGUgXCJ1aS9zdG9yaWVzXCIgZm9sZGVyIGluIHRoZSBwcm9qZWN0IHRoZSBleHBlY3RlZFxuICAgICAgZGV2ZWxvcG1lbnQgcG9pbnQuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHsgaW5jbHVkZSB9OiB7IGluY2x1ZGU6IHN0cmluZ1tdIH0pID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9zdG9yeWJvb2suanNcIikpXG4gICAgICAuZGVmYXVsdChcIlwiLCBpbmNsdWRlLCBwYXRoLnJlc29sdmUocHJvY2Vzcy5jd2QoKSksIGdldE9wdGlvbnMoKSlcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJzdG9yeWJvb2sgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCBzdG9yeWJvb2sgPSBwcm9ncmFtLmNvbW1hbmQoXCJzdG9yeWJvb2tcIik7XG5cbnN0b3J5Ym9va1xuICAuY29tbWFuZChcInJ1blwiKVxuICAub3B0aW9uKFxuICAgIFwiLWksIC0taW5jbHVkZSA8aW5jbHVkZS4uLj5cIixcbiAgICBcIkFkZGl0aW9uYWwgc3Rvcnlib29rIG1vZHVsZXMgdG8gbG9hZCBpbnRvIHN0b3J5Ym9vay4gVGhlc2UgYXJlIHRoZSBuYW1lcyBvZiBwcm9wZXJseSBmb3JtYXR0ZWQgZGVwZW5kZW5jaWVzIGluc3RhbGxlZCBpbnRvIG5vZGVfbW9kdWxlcy5cIlxuICApXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFN0YXJ0cyBhIHN0b3J5Ym9vayBpbnN0YW5jZSBmb3IgZGV2ZWxvcGluZyB0aGUgVUkgY29tcG9uZW50cyBvZiB0aGVcbiAgICAgIHByb2plY3QuIFRoaXMgbWFrZXMgdGhlIFwidWkvc3Rvcmllc1wiIGZvbGRlciBpbiB0aGUgcHJvamVjdCB0aGUgZXhwZWN0ZWRcbiAgICAgIGRldmVsb3BtZW50IHBvaW50LlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICh7IGluY2x1ZGUgfTogeyBpbmNsdWRlOiBzdHJpbmdbXSB9KSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvc3Rvcnlib29rLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoXCJcIiwgaW5jbHVkZSwgcGF0aC5yZXNvbHZlKHByb2Nlc3MuY3dkKCkpLCBnZXRPcHRpb25zKCkpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwic3Rvcnlib29rIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxucHJvZ3JhbVxuICAuY29tbWFuZChcInVybCBbdXJpLi4uXVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBTaW1wbGUgY29tbWFuZCB0byBvcGVuIGEgc3BlY2lmaWVkIFVSTCBpbiB0aGUgYnJvd3Nlci5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAodXJpOiBzdHJpbmcpID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy91cmwuanNcIikpLmRlZmF1bHQodXJpKS5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgY29uc29sZS53YXJuKFwidXJsIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH0pO1xuICB9KTtcblxuY29uc3QgcmVsZWFzZSA9IHByb2dyYW0uY29tbWFuZChcInJlbGVhc2VcIikuZGVzY3JpcHRpb24oXG4gIGRlc2NyaXB0aW9uYFxuICAgIFRoZXNlIGNvbW1hbmRzIGFyZSB1c2VkIGZvciBmYWNpbGl0YXRpbmcgZGlzdHJpYnV0aW9uIHJlbGVhc2VzIG9mXG4gICAgYXBwbGljYXRpb25zLiBUaGlzIGluY2x1ZGVzIHRvb2xzIGZvciBidWlsZGluZyB0aCBkaXN0IGZvbGRlciBmcmFnbWVudHMsXG4gICAgdmlld2luZyB0aGUgZXhwZWN0ZWQgcmVsZWFzZSBub3RlcywgYW5kIGFjdHVhbGx5IHBlcmZvcm1pbmcgYSBjb21wbGV0ZVxuICAgIHJlbGVhc2UgY3ljbGUuXG4gIGBcbik7XG5cbnJlbGVhc2VcbiAgLmNvbW1hbmQoXCJkZXBsb3kgW2FkZC1yZW1vdGUuLi5dXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFBlcmZvcm1zIGFjdGlvbnMgbmVjZXNzYXJ5IHRvIHVwZGF0ZSB0aGUgZGlzdHJpYnV0aW9uIG9mIHRoZSBwcm9qZWN0LlxuICAgICAgVGhpcyB3aWxsIGF1dG9tYXRpY2FsbHkgdXBkYXRlIHJlbGVhc2Ugbm90ZXMsIHRhZyB0aGUgcmVsZWFzZSwgYW5kXG4gICAgICBjb21taXQgYW5kIHB1c2ggdG8gYSAncmVsZWFzZScgYnJhbmNoIHdoaWNoIHdpbGwgYmUgcmVhZHkgZm9yIG1lcmdpbmdcbiAgICAgIGludG8gbWFzdGVyIGFuZCBkZXYuXG5cbiAgICAgIFNwZWNpZnkgYWRkaXRpb25hbCByZW1vdGVzIHRvIGRlcGxveSB0byB2aWEgdGhlIGFkZC1yZW1vdGUgb3B0aW9uLlxuICAgICAgVGhpcyB3aWxsIGRlcGxveSB0aGUgcmVsZWFzZSB0byBhZGRpdGlvbmFsIHJlbW90ZXMgKEFGVEVSIGFsbCBvdGhlciBub3JtYWxcbiAgICAgIGRlcGxveSBvcGVyYXRpb25zIGNvbXBsZXRlKS4gVGhpcyB2YWx1ZSBpcyB0aGUgTkFNRSBvZiB0aGUgcmVtb3RlIGFzIGl0XG4gICAgICBhcHBlYXJzIHdoZW4geW91IHBlcmZvcm0gYSBcImdpdCByZW1vdGUgLXZcIiBjb21tYW5kLlxuXG4gICAgICBZb3UgY2FuIHNwZWNpZnkgYSBzcGVjaWZpYyB0YXJnZXQgYnJhbmNoIHZpYSBhIGNvbG9uOiByZW1vdGU6YnJhbmNoXG4gICAgICBPdGhlcndpc2UsIHRoaXMgd2lsbCB1c2UgdGhlIHNhbWUgbWFpbiBicmFuY2ggYXMgY29uZmlndXJlZCBmb3IgdGhpc1xuICAgICAgcHJvamVjdC5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAocmVtb3Rlczogc3RyaW5nW10pID0+IHtcbiAgICAvLyBCZWZvcmUgc3RhcnRpbmcgdGhlIHJlbGVhc2Ugc2NyaXB0IG1ha2Ugc3VyZSBvdXIgcGFja2FnZXMgYXJlIHVwIHRvIGRhdGUgdG8gdGhlIGxhdGVzdFxuICAgIGV4ZWNJbnN0YWxsKFtdKTtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9yZWxlYXNlL3JlbGVhc2UtZGVwbG95LmpzXCIpKVxuICAgICAgLmRlZmF1bHQocmVtb3RlcylcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLWRlcGxveSBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcXG5cIixcbiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5yZWxlYXNlXG4gIC5jb21tYW5kKFwidHlwZXNcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgVXBkYXRlcyBKVVNUIHRoZSB0eXBlcyBpbiB0aGUgZGlzdCBmb2xkZXIuIFRoZXNlIGFyZSB0aGUgc2FtZSB0eXBlc1xuICAgICAgZ2VuZXJhdGVkIHdoZW4gYnVpbGRpbmcgYSByZWxlYXNlLlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICgpID0+IHtcbiAgICAvLyBCZWZvcmUgc3RhcnRpbmcgdGhlIHJlbGVhc2Ugc2NyaXB0IG1ha2Ugc3VyZSBvdXIgcGFja2FnZXMgYXJlIHVwIHRvIGRhdGUgdG8gdGhlIGxhdGVzdFxuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3JlbGVhc2UvcmVsZWFzZS10eXBlcy5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLXR5cGVzIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVxcblwiLFxuICAgICAgICAgIGVyci5zdGFjayB8fCBlcnIubWVzc2FnZVxuICAgICAgICApO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbnJlbGVhc2VcbiAgLmNvbW1hbmQoXCJ2aWV3XCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgcnVucyB0aGUgcmVsZWFzZS12aWV3IHNjcmlwdC4gRm9yIHRoaXMgY2FzZSwgaXQgd2lsbCBvbmx5IGRpc3BsYXlcbiAgICAgIHRoZSByZWxlYXNlIG5vdGVzIGluIHRoZSBjb25zb2xlLiBBY3R1YWwgZ2VuZXJhdGVkIHJlbGVhc2Ugbm90ZXMgYXJlIGFcbiAgICAgIHBhcnQgb2YgdGhlIHJlbGVhc2UgcHJvY2Vzcy5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvdHMuanNcIikpXG4gICAgICAuZGVmYXVsdChcIlwiKVxuICAgICAgLnRoZW4oYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgY2hhbGsuY3lhbkJyaWdodEJvbGQoXCJUUyBjaGVjayBwYXNzZWQsIGdlbmVyYXRpbmcgbm90ZXMuLi5cIilcbiAgICAgICAgKTtcbiAgICAgICAgLy8gQmVmb3JlIHN0YXJ0aW5nIHRoZSByZWxlYXNlIHNjcmlwdCBtYWtlIHN1cmUgb3VyIHBhY2thZ2VzIGFyZSB1cCB0byBkYXRlIHRvIHRoZSBsYXRlc3RcbiAgICAgICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLXZpZXcuanNcIikpXG4gICAgICAgICAgLmRlZmF1bHQoKVxuICAgICAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgICBcInJlbGVhc2Utbm90ZXMgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIsXG4gICAgICAgICAgICAgIGVyci5zdGFjayB8fCBlcnIubWVzc2FnZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgIGNoYWxrLnJlZEJyaWdodEJvbGQoXG4gICAgICAgICAgICBkZXNjcmlwdGlvbmBcbiAgICAgICAgICAgICAgRmFpbGVkIFRTIGNoZWNrLiBSZWxlYXNlIG5vdGVzIHdpbGwgbm90IGJlIHByb2R1Y2VkIHVudGlsIGFsbCBUU1xuICAgICAgICAgICAgICBlcnJvcnMgYXJlIHJlc29sdmVkLlxuICAgICAgICAgICAgYFxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgICAgY29uc29sZS53YXJuKGVyci5zdGFjayB8fCBlcnIubWVzc2FnZSk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0pO1xuICB9KTtcblxucmVsZWFzZVxuICAuY29tbWFuZChcImJ1aWxkXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgcnVucyB0aGUgcmVsZWFzZS1idWlsZCBzY3JpcHQuIFRoaXMgZ2VuZXJhdGVzIGFsbCBvZiB0aGUgcmVsZWFzZVxuICAgICAgZnJhZ21lbnRzLiBUaGlzIHNob3VsZCBPTkxZIGJlIHVzZWQgZm9yIHRlc3RpbmcgYW5kIGV4cGVyaW1lbnRpbmcuIEFjdHVhbFxuICAgICAgcmVsZWFzZSBmcmFnbWVudHMgc2hvdWxkIGJlIHByb3Blcmx5IGNyZWF0ZWQgYW5kIGRlcGxveWVkIHVzaW5nIHRoZVxuICAgICAgcmVsZWFzZSBkZXBsb3kgY29tbWFuZC5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLWJ1aWxkLmpzXCIpKVxuICAgICAgLmRlZmF1bHQoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICBcInJlbGVhc2UtZGVwbG95IHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVxcblwiLFxuICAgICAgICAgIGVyci5zdGFjayB8fCBlcnIubWVzc2FnZVxuICAgICAgICApO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHJlbGVhc2VTdGFydCA9IHJlbGVhc2UuY29tbWFuZChcInN0YXJ0XCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICAgIFRoaXMgc3RhcnRzIHVwIHJlbGVhc2VkIHJlbGF0ZWQgcHJvY2Vzc2VzLiBUaGlzIGluY2x1ZGVzIHRoaW5ncyBsaWtlXG4gICAgICBzdGFydGluZyB1cCB0aGUgZGV2IHNlcnZlciB3aXRob3V0IGFueSBhZGRpdGlvbmFsIGJ1aWxkcyBvciBhdXRvXG4gICAgICBjb25maWd1cmF0aW9uIGZvciBkZXZlbG9wbWVudC5cbiAgICBgXG4pO1xuXG5yZWxlYXNlU3RhcnRcbiAgLmNvbW1hbmQoXCJzZXJ2ZXJcIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgU3RhcnRzIHVwIHRoZSBhcHAgc2VydmVyIHdpdGhvdXQgYW55IGFkZGl0aW9uYWwgYnVpbGRzIGV0Yy4gVXNlIHRoZVxuICAgICAgZW52aXJvbm1lbnRzOlxuXG4gICAgICAgIEJVSUxEX01PREU6IFRhcmdldHMgYW4gZW52IHRvIHJ1biB0aGUgc2VydmVyIGZvci5cbiAgICAgICAgUkVTT1VSQ0VfUEFUSDogVGhlIHBhdGggdG8gdGhlIHN0YXRpYyBmaWxlcyB0byBzZXJ2ZS5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvcmVsZWFzZS9yZWxlYXNlLXN0YXJ0LXNlcnZlci5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJyZWxlYXNlLXN0YXJ0LXNlcnZlciBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcXG5cIixcbiAgICAgICAgICBlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5wcm9ncmFtXG4gIC5jb21tYW5kKFwic3RhcnQgW3RhcmdldF1cIilcbiAgLmRlc2NyaXB0aW9uKFxuICAgIGRlc2NyaXB0aW9uYFxuICAgICAgVGhpcyBmaXJlcyB1cCBhIHNlcnZlciB0byBtYWtlIGFueSBzdGF0aWMgY29udGVudCBhdmFpbGFibGUgZm9yIGJlaW5nXG4gICAgICBzZXJ2ZWQuXG4gICAgICBUaGVyZSBhcmUgYSBmZXcgb3B0aW9ucyBmb3Igd2hhdCBjb250ZW50IHdpbGwgYmUgc2VydmVkIGJ5IHRoaXMgc2NyaXB0OlxuXG4gICAgICAtIFRoZSB3ZWIgYXBwXG4gICAgICAtIERldm9wcyBBUElcblxuICAgICAgVGhlIHN0YXJ0IHNjcmlwdCB3aWxsIGF1dG9tYXRpY2FsbHkgcGljayB0aGUgd2ViIGFwcCBvdmVyIHRoZSBkZXZvcHNcbiAgICAgIGZpbGVzLCBidXQgeW91IGNhbiBzcGVjaWZ5IGEgdGFyZ2V0IGlmIHlvdSBoYXZlIGEgZGV2b3BzIEFQSSBhbmQgYSB3ZWJcbiAgICAgIGFwcDpcblxuICAgICAgLSBhcHBcbiAgICAgIC0gZGV2b3BzXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKHRhcmdldDogc3RyaW5nKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvc3RhcnQuanNcIikpXG4gICAgICAuZGVmYXVsdCh0YXJnZXQsIGdldE9wdGlvbnMoKSlcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJzdGFydCBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHRlc3QgPSBwcm9ncmFtLmNvbW1hbmQoXCJ0ZXN0XCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBUaGVzZSBjb21tYW5kcyBhcmUgdXNlZCBmb3IgcnVubmluZyB0ZXN0cy4gVGhpcyBpbmNsdWRlcyB0b29scyBmb3JcbiAgICBydW5uaW5nIHVuaXQgdGVzdHMgYSBzaW5nbGUgdGltZSBvciBpbiBhIHdhdGNoIG1vZGUuXG5cbiAgICBVc2UgdGhlIGVudmlyb25tZW50IHZhcmlhYmxlcyBmb3IgbW9kaWZ5aW5nIGJlaGF2aW9yOlxuXG4gICAgJHtjaGFsay55ZWxsb3dCcmlnaHRCb2xkKFwiUEFUVEVSTlwiKX0gLSBUaGlzIGNhdXNlcyB0aGUgdGVzdHMgdG8gb25seSBydW4gb25cbiAgICBmaWxlcyB0aGF0IG1hdGNoIHRoZSBwYXR0ZXJuXG5cbiAgICAke2NoYWxrLnllbGxvd0JyaWdodEJvbGQoXCJMRVNTXCIpfSAtIFRoaXMgcmVtb3ZlcyB0aGUgdmVyYm9zZSBvdXRwdXQgbGlzdCBvZlxuICAgIGFsbCB0ZXN0cyByYW5cbiAgYFxuKTtcblxudGVzdFxuICAuY29tbWFuZChcInJ1blwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBSdW5zIGFsbCB1bml0IHRlc3RzIGluIHRoZSB1bml0LXRlc3QgZm9sZGVyIG9uY2UuXG4gICAgYFxuICApXG4gIC5hY3Rpb24oYXN5bmMgKCkgPT4ge1xuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3Rlc3QvdGVzdC1ydW4uanNcIikpXG4gICAgICAuZGVmYXVsdCgpXG4gICAgICAuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgICAgY29uc29sZS53YXJuKFwidGVzdC1ydW4gcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5jb25zdCBjbGVhbiA9IHByb2dyYW0uY29tbWFuZChcImNsZWFuXCIpLmRlc2NyaXB0aW9uKFxuICBkZXNjcmlwdGlvbmBcbiAgICBDb21tb24gY2xlYW5pbmcgdG9vbHMgZm9yIHZhcmlvdXMgZnJhZ21lbnRzIHdpdGhpbiB0aGUgcHJvamVjdC5cbiAgYFxuKTtcblxuY2xlYW5cbiAgLmNvbW1hbmQoXCJjYWNoZVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBDbGVhbnMgb3V0IGJ1aWxkIGFuZCBjYWNoZSBmaWxlcyB0byBoZWxwIGVuc3VyZSBhIGNvbXBsZXRlIHJlYnVpbGQgdGFrZXNcbiAgICAgIHBsYWNlLlxuICAgIGBcbiAgKVxuICAuYWN0aW9uKGFzeW5jICgpID0+IHtcbiAgICAoYXdhaXQgaW1wb3J0KFwiLi9jb21tYW5kcy9jbGVhbi9jbGVhbi1jYWNoZS5qc1wiKSlcbiAgICAgIC5kZWZhdWx0KClcbiAgICAgIC5jYXRjaCgoZXJyOiBFcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLndhcm4oXCJjbGVhbi1jYWNoZSBwcm9jZXNzIGV4aXRlZCB1bmV4cGVjdGVkbHlcIik7XG4gICAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgICB9KTtcbiAgfSk7XG5cbmNvbnN0IHRzID0gcHJvZ3JhbS5jb21tYW5kKFwidHNcIikuZGVzY3JpcHRpb24oXG4gIGRlc2NyaXB0aW9uYFxuICAgIFRoZXNlIGNvbW1hbmRzIGFyZSB1c2VkIGZvciBydW5uaW5nIHR5cGVzY3JpcHQuIFRoaXMgaW5jbHVkZXMgdG9vbHMgZm9yXG4gICAgcnVubmluZyB0eXBlc2NyaXB0IGNvbXBpbGF0aW9uIGEgc2luZ2xlIHRpbWUgb3IgaW4gYSB3YXRjaCBtb2RlLlxuICBgXG4pO1xuXG50cy5jb21tYW5kKFwicnVuXCIpXG4gIC5kZXNjcmlwdGlvbihcbiAgICBkZXNjcmlwdGlvbmBcbiAgICAgIFJ1bnMgdHlwZXNjcmlwdCBjb21waWxhdGlvbiB0byBjaGVjayBmb3IgZXJyb3JzLiBEb2VzIE5PVCBlbWl0IGZpbGVzLCB0aHVzXG4gICAgICBpcyBhIGdvb2QgbWVjaGFuaXNtIGZvciBjaGVja2luZyBhIGJ1aWxkIGJlZm9yZSBydW5uaW5nIGEgcmVsZWFzZS5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgKGF3YWl0IGltcG9ydChcIi4vY29tbWFuZHMvdHMuanNcIikpLmRlZmF1bHQoXCJcIikuY2F0Y2goKGVycjogRXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUud2FybihcInRzIHByb2Nlc3MgZXhpdGVkIHVuZXhwZWN0ZWRseVwiKTtcbiAgICAgIGNvbnNvbGUud2FybihlcnIuc3RhY2sgfHwgZXJyLm1lc3NhZ2UpO1xuICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgIH0pO1xuICB9KTtcblxuY29uc3QgcHIgPSBwcm9ncmFtXG4gIC5jb21tYW5kKFwicHJcIilcbiAgLm9wdGlvbihcbiAgICBcIi0tcmVwb1VybCA8dmFsdWU+XCIsXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBUaGUgaHR0cHMgVVJMIHRvIHRoZSByZXBvIHRvIG1ha2UgdGhlIFBSIGludG9cbiAgICBgXG4gIClcbiAgLm9wdGlvbihcbiAgICBcIi0tcmVwb1R5cGUgPHZhbHVlPlwiLFxuICAgIGRlc2NyaXB0aW9uYFxuICAgIFRoZSByZXBvc2l0b3J5IHR5cGUgdG8gbWFrZSB0aGUgUFIgaW50by4gU3VwcG9ydGVkIHR5cGVzIGFyZTogZ2l0LCBnaXRsYWJcbiAgYFxuICApXG4gIC5vcHRpb24oXG4gICAgXCItLW1hc3RlckJyYW5jaCA8dmFsdWU+XCIsXG4gICAgZGVzY3JpcHRpb25gXG4gICAgVGhpcyBpbmRpY2F0ZXMgd2hpY2ggYnJhbmNoIGlzIHRoZSBtYXN0ZXIvbWFpbiBvZiB0aGUgcmVwb3NpdG9yeS5cbiAgYFxuICApO1xuXG5wci5jb21tYW5kKFwicmVsZWFzZVwiKVxuICAuZGVzY3JpcHRpb24oXG4gICAgZGVzY3JpcHRpb25gXG4gICAgICBUaGlzIGNyZWF0ZXMgdHdvIFBScyB0aGF0IG1lcmdlcyB0aGUgY3VycmVudCByZW1vdGUgcmVsZWFzZSBicmFuY2ggaW50b1xuICAgICAgdGhlIHJlbW90ZSBkZXYgYW5kIG1hc3RlciBicmFuY2hlcy5cbiAgICBgXG4gIClcbiAgLmFjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgeyByZXBvVXJsLCByZXBvVHlwZSwgbWFzdGVyQnJhbmNoIH0gPSB5YXJncyhwcm9jZXNzLmFyZ3YpLmFyZ3YgYXMge1xuICAgICAgcmVwb1R5cGU/OiBzdHJpbmc7XG4gICAgICByZXBvVXJsPzogc3RyaW5nO1xuICAgICAgbWFzdGVyQnJhbmNoPzogc3RyaW5nO1xuICAgIH07XG5cbiAgICBpZiAoIXJlcG9VcmwgfHwgIXJlcG9UeXBlIHx8ICFtYXN0ZXJCcmFuY2gpIHtcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgXCJZb3UgbXVzdCBzcGVjaWZ5IGJvdGggLS1yZXBvVXJsIGFuZCAtLXJlcG9UeXBlIHRvIHVzZSB0aGlzIGNvbW1hbmRcIlxuICAgICAgKTtcbiAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9XG5cbiAgICAvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhbnkgcmVxdWlyZWQgcGVlciBkZXBlbmRlbmNpZXMgZm9yIHRoaXNcbiAgICBhd2FpdCBlbnN1cmVEZXBlbmRlbmNpZXMoKS5jYXRjaCgoKSA9PiBwcm9jZXNzLmV4aXQoMSkpO1xuICAgIGNvbnNvbGUud2FybihcIkRlcGVuZGVuY3kgY2hlY2tzIHBhc3NlZCwgY29udGludWluZy4uLlwiKTtcblxuICAgIChhd2FpdCBpbXBvcnQoXCIuL2NvbW1hbmRzL3ByL3ByLXJlbGVhc2UuanNcIikpXG4gICAgICAuZGVmYXVsdChyZXBvVXJsLCByZXBvVHlwZSwgbWFzdGVyQnJhbmNoKVxuICAgICAgLmNhdGNoKChlcnI6IEVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcInByLXJlbGVhc2UgcHJvY2VzcyBleGl0ZWQgdW5leHBlY3RlZGx5XCIpO1xuICAgICAgICBjb25zb2xlLndhcm4oZXJyLnN0YWNrIHx8IGVyci5tZXNzYWdlKTtcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpO1xuICAgICAgfSk7XG4gIH0pO1xuXG5hc3luYyBmdW5jdGlvbiBydW4oKSB7XG4gIC8vIExvYWQgaW4gZW52aXJvbm1lbnQgZnJvbSBlbnYgZmlsZSBhbmQgYWxzbyBlbnN1cmUgY29uZmlndXJhdGlvbiBtYXRjaGVzIHRoZVxuICAvLyBlbnZpcm9ubWVudCBjb25maWd1cmF0aW9uIHNwZWNpZmllZCBpbiBlbnYuY29uZmlnLnRzXG4gIGF3YWl0IGNvbmZpZ0Vudihwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpO1xuICBwcm9ncmFtLnBhcnNlKHByb2Nlc3MuYXJndik7XG59XG5cbnJ1bigpO1xuIgogIF0sCiAgIm1hcHBpbmdzIjogIjs7SUFBYSxlQUFOLEFBQU0sRUFBUSxDQUNuQixLQUFNLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUNyRCxJQUFLLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUNwRCxPQUFRLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUN2RCxNQUFPLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUN0RCxLQUFNLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUNyRCxRQUFTLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUN4RCxXQUFZLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUMzRCxVQUFXLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FBRyxXQUMxRCxhQUFjLElBQUksSUFBbUIsV0FBVyxFQUFLLEtBQUssR0FB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QU0sRUFBa0IsRUFDbEMsRUFBWSxFQUFTLE9BQU8sQ0FBUyxFQUUzQyxPQUFPLE1BQU0sRUFBUyxFQUFRLEdBQUksQ0FDaEMsSUFDQSxFQUFTLFlBQWMsS0FDdkIsRUFBTyxJQUFJLElBQVMsS0FDcEIsR0FBRyxDQUNMLENBQUNBQ3RCSCxzQkFFTyxJQUFNLEdBQ1gsQ0FBQyxJQUFvQyxNQUFPLEVBQVksSUFBa0IsQ0FDeEUsSUFBSSxFQUFpQixDQUFDLEVBRXRCLEdBQUksYUFBbUIsSUFDckIsRUFBTyxNQUFNLEtBQUssQ0FBTyxNQUV6QixHQUFPLEVBR1QsT0FBTyxHQUFNLE9BQU8sR0FBUyxHQUFJLENBQUksRUFBRSxJQUFJLENBQUMsSUFBTSxFQUFFLE1BQU1BQ1Q5RCxlQUFzQixFQUFrQixDQUFDLEVBQXFCLENBQzVELEdBQUksQ0FFRixPQURBLE1BQWEsVUFDTixTQUNBLEVBQVAsQ0FLQSxPQUpBLFFBQVEsTUFDTiw4REFDQSxDQUNGLEVBQ08iLAogICJkZWJ1Z0lkIjogIjc5ODA1MEYwQzVERDA4RUQ2NDc1NmUyMTY0NzU2ZTIxIiwKICAibmFtZXMiOiBbXQp9
